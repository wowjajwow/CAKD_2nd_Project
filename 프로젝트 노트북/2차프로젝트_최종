{"cells":[{"cell_type":"markdown","metadata":{"id":"IkEXacCQIKKX"},"source":["# 경로설정 및 import"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1671781589085,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"},"user_tz":-540},"id":"VbEDM-CDXJi4","outputId":"9386b7f6-b489-4689-f6bc-56be8dff9b53"},"outputs":[{"name":"stdout","output_type":"stream","text":["/content/drive/MyDrive/lmemdata\n"]}],"source":["cd/content/drive/MyDrive/lmemdata"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2226,"status":"ok","timestamp":1672597384774,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"},"user_tz":-540},"id":"9YzbwfPOfAoR","outputId":"c341a07f-a087-40c1-fffc-56867a73c4a9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0ppfHBOvII7Z"},"outputs":[],"source":["# 한글 깨짐 해결방법 : 실행 후 Restart runtime \n","!sudo apt-get install -y fonts-nanum\n","!sudo fc-cache -fv\n","!rm ~/.cache/matplotlib -rf"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6140,"status":"ok","timestamp":1672291665512,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"u7RdKaq2WYL-","outputId":"ddc4c12c-ea8a-411c-e6ee-8810edd10432"},"outputs":[{"name":"stdout","output_type":"stream","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting konlpy\n","  Downloading konlpy-0.6.0-py2.py3-none-any.whl (19.4 MB)\n","\u001b[K     |████████████████████████████████| 19.4 MB 13.2 MB/s \n","\u001b[?25hRequirement already satisfied: lxml>=4.1.0 in /usr/local/lib/python3.8/dist-packages (from konlpy) (4.9.2)\n","Collecting JPype1>=0.7.0\n","  Downloading JPype1-1.4.1-cp38-cp38-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (465 kB)\n","\u001b[K     |████████████████████████████████| 465 kB 83.3 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.6 in /usr/local/lib/python3.8/dist-packages (from konlpy) (1.21.6)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.8/dist-packages (from JPype1>=0.7.0->konlpy) (21.3)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.8/dist-packages (from packaging->JPype1>=0.7.0->konlpy) (3.0.9)\n","Installing collected packages: JPype1, konlpy\n","Successfully installed JPype1-1.4.1 konlpy-0.6.0\n"]}],"source":["pip install konlpy"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wL8r7HbFIcIf"},"outputs":[],"source":["import matplotlib.pyplot as plt\n","import pandas as pd\n","import numpy as np\n","from konlpy.tag import Kkma\n","from konlpy.utils import pprint\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","plt.rc('font', family='NanumBarunGothic')"]},{"cell_type":"markdown","metadata":{"id":"JDr-oYNPLHej"},"source":["# #1. 데이터 로드\n","\n","1. 분석 대상 : L사 4개 제휴사의 2014년~2015년 유통 데이터\n","\n","2. L사 데이터\n","    * 멤버십여부(data_1) : 고객번호/ 멤버쉽명 / 가입년월\n","    * 채널이용(data_2) : 고객번호 / 제휴사 / 이용횟수\n","    * 경쟁사이용(data_3) : 고객번호 / 제휴사 / 경쟁사/ 이용년월\n","    * 고객DEMO(data_4) : 고객번호/ 성별 / 연령대 / 거주지역\n","    * 상품분류(data_5) : 제휴사 / 대중소분류코드 / 중.소분류명\n","    * 구매상품TR(data_6) : 고객번호 / 영수증번호/ 대,중,소분류코드 / 구매일자 / 구매시간 / 구매금액\n","\n","3. 외부 데이터\n","    * 유통상품 표준DB : 대한상공회의소 유통물류진흥원\n","    출처 : http://www.allproductkorea.or.kr/products/database\n"]},{"cell_type":"markdown","metadata":{"id":"BVYSE_lkQ0TN"},"source":["## 1) L사 데이터 "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":1536,"status":"ok","timestamp":1672035460639,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"dDtfVzryYGS-","outputId":"027db2d5-3eaa-4445-d4aa-2e49fc28147a"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-d7a07fe3-cc3d-4bbc-97a0-b7e41fba60fd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십명</th>\n","      <th>가입년월</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>11</td>\n","      <td>하이마트</td>\n","      <td>201512</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>21</td>\n","      <td>하이마트</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>37</td>\n","      <td>하이마트</td>\n","      <td>201306</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>43</td>\n","      <td>하이마트</td>\n","      <td>201403</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>44</td>\n","      <td>하이마트</td>\n","      <td>201411</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>7451</th>\n","      <td>19377</td>\n","      <td>롭스</td>\n","      <td>201411</td>\n","    </tr>\n","    <tr>\n","      <th>7452</th>\n","      <td>19379</td>\n","      <td>롭스</td>\n","      <td>201412</td>\n","    </tr>\n","    <tr>\n","      <th>7453</th>\n","      <td>19380</td>\n","      <td>롭스</td>\n","      <td>201412</td>\n","    </tr>\n","    <tr>\n","      <th>7454</th>\n","      <td>19381</td>\n","      <td>다둥이</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>7455</th>\n","      <td>19383</td>\n","      <td>롭스</td>\n","      <td>201507</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>7456 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d7a07fe3-cc3d-4bbc-97a0-b7e41fba60fd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d7a07fe3-cc3d-4bbc-97a0-b7e41fba60fd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d7a07fe3-cc3d-4bbc-97a0-b7e41fba60fd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       고객번호  멤버십명    가입년월\n","0        11  하이마트  201512\n","1        21  하이마트  201506\n","2        37  하이마트  201306\n","3        43  하이마트  201403\n","4        44  하이마트  201411\n","...     ...   ...     ...\n","7451  19377    롭스  201411\n","7452  19379    롭스  201412\n","7453  19380    롭스  201412\n","7454  19381   다둥이  201506\n","7455  19383    롭스  201507\n","\n","[7456 rows x 3 columns]"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["data_1 = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/lmemdata/멤버십여부.txt',sep = \",\",  engine='python', encoding = \"cp949\")\n","data_1"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1672035402777,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"c4-o0yNvXtYL","outputId":"6dd7e34d-9e20-42cd-a623-823751b8032a"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-4651efc0-5298-46dd-94a5-94528c249f36\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>제휴사</th>\n","      <th>이용횟수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>7</td>\n","      <td>A_MOBILE/APP</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>14</td>\n","      <td>A_MOBILE/APP</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>42</td>\n","      <td>B_MOBILE/APP</td>\n","      <td>23</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>74</td>\n","      <td>A_MOBILE/APP</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>74</td>\n","      <td>B_MOBILE/APP</td>\n","      <td>30</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>8819</th>\n","      <td>19168</td>\n","      <td>C_ONLINEMALL</td>\n","      <td>18</td>\n","    </tr>\n","    <tr>\n","      <th>8820</th>\n","      <td>19291</td>\n","      <td>C_ONLINEMALL</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8821</th>\n","      <td>19312</td>\n","      <td>B_ONLINEMALL</td>\n","      <td>137</td>\n","    </tr>\n","    <tr>\n","      <th>8822</th>\n","      <td>19351</td>\n","      <td>C_ONLINEMALL</td>\n","      <td>19</td>\n","    </tr>\n","    <tr>\n","      <th>8823</th>\n","      <td>19356</td>\n","      <td>C_ONLINEMALL</td>\n","      <td>16</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>8824 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4651efc0-5298-46dd-94a5-94528c249f36')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4651efc0-5298-46dd-94a5-94528c249f36 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4651efc0-5298-46dd-94a5-94528c249f36');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       고객번호           제휴사  이용횟수\n","0         7  A_MOBILE/APP     4\n","1        14  A_MOBILE/APP     1\n","2        42  B_MOBILE/APP    23\n","3        74  A_MOBILE/APP     1\n","4        74  B_MOBILE/APP    30\n","...     ...           ...   ...\n","8819  19168  C_ONLINEMALL    18\n","8820  19291  C_ONLINEMALL     1\n","8821  19312  B_ONLINEMALL   137\n","8822  19351  C_ONLINEMALL    19\n","8823  19356  C_ONLINEMALL    16\n","\n","[8824 rows x 3 columns]"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["data_2=pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/lmemdata/채널이용.txt',sep = \",\",  engine='python', encoding = \"cp949\")\n","data_2"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":3582,"status":"ok","timestamp":1672035402777,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"Vfq824dfXUWC","outputId":"e6d68b84-db64-41b8-cd6e-b3f233e7c42c"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-b36a0cca-873f-449e-88b1-92aab9bdf62e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>제휴사</th>\n","      <th>경쟁사</th>\n","      <th>이용년월</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201507</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>51</td>\n","      <td>D</td>\n","      <td>D01</td>\n","      <td>201504</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>77</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201503</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>77</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>77</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201507</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28154</th>\n","      <td>19375</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201501</td>\n","    </tr>\n","    <tr>\n","      <th>28155</th>\n","      <td>19375</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201507</td>\n","    </tr>\n","    <tr>\n","      <th>28156</th>\n","      <td>19375</td>\n","      <td>C</td>\n","      <td>C03</td>\n","      <td>201511</td>\n","    </tr>\n","    <tr>\n","      <th>28157</th>\n","      <td>19376</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>28158</th>\n","      <td>19377</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201504</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28159 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b36a0cca-873f-449e-88b1-92aab9bdf62e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b36a0cca-873f-449e-88b1-92aab9bdf62e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b36a0cca-873f-449e-88b1-92aab9bdf62e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["        고객번호 제휴사  경쟁사    이용년월\n","0          2   D  D02  201507\n","1         51   D  D01  201504\n","2         77   D  D02  201503\n","3         77   D  D02  201506\n","4         77   D  D02  201507\n","...      ...  ..  ...     ...\n","28154  19375   B  B01  201501\n","28155  19375   B  B01  201507\n","28156  19375   C  C03  201511\n","28157  19376   B  B01  201506\n","28158  19377   B  B01  201504\n","\n","[28159 rows x 4 columns]"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["data_3=pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/lmemdata/경쟁사이용.txt',sep = \",\",  engine='python', encoding = \"cp949\")\n","data_3"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":851,"status":"ok","timestamp":1672293995654,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"QduSecPMYXHP","outputId":"46557bb0-a6ef-45eb-f8e3-bc76814c3851"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-9e9fcb4d-246e-49aa-9e3b-50e77036ffe2\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>M</td>\n","      <td>60세이상</td>\n","      <td>60.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>M</td>\n","      <td>60세이상</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>M</td>\n","      <td>60세이상</td>\n","      <td>33.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>F</td>\n","      <td>60세이상</td>\n","      <td>16.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>M</td>\n","      <td>60세이상</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>F</td>\n","      <td>20세~24세</td>\n","      <td>69.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>F</td>\n","      <td>20세~24세</td>\n","      <td>39.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>F</td>\n","      <td>40세~44세</td>\n","      <td>460.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>F</td>\n","      <td>45세~49세</td>\n","      <td>460.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>F</td>\n","      <td>25세~29세</td>\n","      <td>500.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9e9fcb4d-246e-49aa-9e3b-50e77036ffe2')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9e9fcb4d-246e-49aa-9e3b-50e77036ffe2 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9e9fcb4d-246e-49aa-9e3b-50e77036ffe2');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["        고객번호 성별      연령대   거주지역\n","0          1  M    60세이상   60.0\n","1          2  M    60세이상  100.0\n","2          3  M    60세이상   33.0\n","3          4  F    60세이상   16.0\n","4          5  M    60세이상  100.0\n","...      ... ..      ...    ...\n","19378  19379  F  20세~24세   69.0\n","19379  19380  F  20세~24세   39.0\n","19380  19381  F  40세~44세  460.0\n","19381  19382  F  45세~49세  460.0\n","19382  19383  F  25세~29세  500.0\n","\n","[19383 rows x 4 columns]"]},"execution_count":20,"metadata":{},"output_type":"execute_result"}],"source":["data_4 = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/lmemdata/고객DEMO.txt',sep = \",\",  engine='python', encoding = \"cp949\")\n","data_4"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":1489,"status":"ok","timestamp":1672291674934,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"sR04A2ONYwjJ","outputId":"9f592764-71b4-4c1c-9ab0-3c882ccb1716"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-54c3e89d-9e14-41bb-8ba3-7dcec8e7119d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010102</td>\n","      <td>일용잡화</td>\n","      <td>휴지류</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010104</td>\n","      <td>일용잡화</td>\n","      <td>일용잡화</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010105</td>\n","      <td>일용잡화</td>\n","      <td>세트상품</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4381</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>D080204</td>\n","      <td>아이메이크업</td>\n","      <td>아이섀도우</td>\n","    </tr>\n","    <tr>\n","      <th>4382</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>D080205</td>\n","      <td>아이메이크업</td>\n","      <td>메이크업세트</td>\n","    </tr>\n","    <tr>\n","      <th>4383</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080301</td>\n","      <td>립메이크업</td>\n","      <td>립스틱/립라이너</td>\n","    </tr>\n","    <tr>\n","      <th>4384</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","    </tr>\n","    <tr>\n","      <th>4385</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>804</td>\n","      <td>D080401</td>\n","      <td>네일메이크업</td>\n","      <td>일반네일/케어류</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4386 rows × 6 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-54c3e89d-9e14-41bb-8ba3-7dcec8e7119d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-54c3e89d-9e14-41bb-8ba3-7dcec8e7119d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-54c3e89d-9e14-41bb-8ba3-7dcec8e7119d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     제휴사  대분류코드  중분류코드    소분류코드    중분류명      소분류명\n","0      A      1    101  A010101    일용잡화      위생세제\n","1      A      1    101  A010102    일용잡화       휴지류\n","2      A      1    101  A010103    일용잡화      뷰티상품\n","3      A      1    101  A010104    일용잡화      일용잡화\n","4      A      1    101  A010105    일용잡화      세트상품\n","...   ..    ...    ...      ...     ...       ...\n","4381   D      8    802  D080204  아이메이크업     아이섀도우\n","4382   D      8    802  D080205  아이메이크업    메이크업세트\n","4383   D      8    803  D080301   립메이크업  립스틱/립라이너\n","4384   D      8    803  D080302   립메이크업   립글로즈/틴트\n","4385   D      8    804  D080401  네일메이크업  일반네일/케어류\n","\n","[4386 rows x 6 columns]"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["data_5 = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/lmemdata/상품분류.txt',sep=\",\", engine='python', encoding = \"cp949\")\n","data_5"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tYxFAk-QYj75"},"outputs":[],"source":["data_6 = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/lmemdata/구매상품TR.txt',sep = \",\",  engine='python', encoding = \"cp949\",chunksize=2000000)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"YIQGV3gqcIph"},"outputs":[],"source":["data_6 = list(data_6)\n","data_6=pd.concat(data_6)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"eobuCX3ufJ90","outputId":"da600f33-12a0-45ea-ea8b-d94ce5f19ae8"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-e65f2376-ca1b-48d6-b3ed-0b9037bd8694\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>영수증번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>2420</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>16</td>\n","      <td>1601</td>\n","      <td>B160101</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>1070</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>16</td>\n","      <td>1602</td>\n","      <td>B160201</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>8060</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>18</td>\n","      <td>1803</td>\n","      <td>B180301</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>6000</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>B</td>\n","      <td>8664001</td>\n","      <td>5</td>\n","      <td>509</td>\n","      <td>B050901</td>\n","      <td>17674</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>22</td>\n","      <td>1120</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>B</td>\n","      <td>8116737</td>\n","      <td>37</td>\n","      <td>3709</td>\n","      <td>B370904</td>\n","      <td>7439</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>19</td>\n","      <td>14000</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>B</td>\n","      <td>8116738</td>\n","      <td>37</td>\n","      <td>3709</td>\n","      <td>B370904</td>\n","      <td>16421</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>20</td>\n","      <td>6500</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>B</td>\n","      <td>8116739</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>B080203</td>\n","      <td>8266</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>13</td>\n","      <td>16000</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>B</td>\n","      <td>8116764</td>\n","      <td>90</td>\n","      <td>9001</td>\n","      <td>B900103</td>\n","      <td>14316</td>\n","      <td>29</td>\n","      <td>20150526</td>\n","      <td>19</td>\n","      <td>1000</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>B</td>\n","      <td>8116741</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>B080203</td>\n","      <td>16587</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>17</td>\n","      <td>16000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 10 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e65f2376-ca1b-48d6-b3ed-0b9037bd8694')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e65f2376-ca1b-48d6-b3ed-0b9037bd8694 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e65f2376-ca1b-48d6-b3ed-0b9037bd8694');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["         제휴사    영수증번호  대분류코드  중분류코드    소분류코드   고객번호  점포코드      구매일자  구매시간  \\\n","0          B  8664000     15   1504  B150401  17218    44  20140222    20   \n","1          B  8664000     16   1601  B160101  17218    44  20140222    20   \n","2          B  8664000     16   1602  B160201  17218    44  20140222    20   \n","3          B  8664000     18   1803  B180301  17218    44  20140222    20   \n","4          B  8664001      5    509  B050901  17674    44  20140222    22   \n","...       ..      ...    ...    ...      ...    ...   ...       ...   ...   \n","28593025   B  8116737     37   3709  B370904   7439    29  20150525    19   \n","28593026   B  8116738     37   3709  B370904  16421    29  20150525    20   \n","28593027   B  8116739      8    802  B080203   8266    29  20150525    13   \n","28593028   B  8116764     90   9001  B900103  14316    29  20150526    19   \n","28593029   B  8116741      8    802  B080203  16587    29  20150525    17   \n","\n","           구매금액  \n","0          2420  \n","1          1070  \n","2          8060  \n","3          6000  \n","4          1120  \n","...         ...  \n","28593025  14000  \n","28593026   6500  \n","28593027  16000  \n","28593028   1000  \n","28593029  16000  \n","\n","[28593030 rows x 10 columns]"]},"execution_count":42,"metadata":{},"output_type":"execute_result"}],"source":["data_6"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":26926,"status":"ok","timestamp":1672294085658,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"wTTTaeiiDO1m","outputId":"3282dda5-7ac7-4038-8f18-1c886f06c7d8"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-915544fc-8a1a-41a2-8ae5-19945692de83\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>영수증번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>2420</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>F</td>\n","      <td>50세~54세</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>B</td>\n","      <td>8747265</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150627</td>\n","      <td>10</td>\n","      <td>970</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>F</td>\n","      <td>50세~54세</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>B</td>\n","      <td>8720725</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150129</td>\n","      <td>17</td>\n","      <td>1280</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>F</td>\n","      <td>50세~54세</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>B</td>\n","      <td>8725005</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150224</td>\n","      <td>18</td>\n","      <td>1380</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>F</td>\n","      <td>50세~54세</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>B</td>\n","      <td>8748478</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150704</td>\n","      <td>15</td>\n","      <td>980</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>F</td>\n","      <td>50세~54세</td>\n","      <td>100.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>D</td>\n","      <td>229558</td>\n","      <td>2</td>\n","      <td>204</td>\n","      <td>D020406</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150508</td>\n","      <td>13</td>\n","      <td>3000</td>\n","      <td>구강케어</td>\n","      <td>치약/칫솔세트</td>\n","      <td>F</td>\n","      <td>20세~24세</td>\n","      <td>33.0</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>C</td>\n","      <td>11082648</td>\n","      <td>13</td>\n","      <td>1305</td>\n","      <td>C130502</td>\n","      <td>18799</td>\n","      <td>358</td>\n","      <td>20151030</td>\n","      <td>19</td>\n","      <td>7800</td>\n","      <td>차류</td>\n","      <td>녹차/홍차</td>\n","      <td>F</td>\n","      <td>20세~24세</td>\n","      <td>33.0</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>D</td>\n","      <td>227041</td>\n","      <td>4</td>\n","      <td>402</td>\n","      <td>D040218</td>\n","      <td>18799</td>\n","      <td>22</td>\n","      <td>20150915</td>\n","      <td>15</td>\n","      <td>3900</td>\n","      <td>음료</td>\n","      <td>식수용차</td>\n","      <td>F</td>\n","      <td>20세~24세</td>\n","      <td>33.0</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>C</td>\n","      <td>11082648</td>\n","      <td>13</td>\n","      <td>1306</td>\n","      <td>C130603</td>\n","      <td>18799</td>\n","      <td>358</td>\n","      <td>20151030</td>\n","      <td>19</td>\n","      <td>3300</td>\n","      <td>건강식품</td>\n","      <td>건강보조식품세트</td>\n","      <td>F</td>\n","      <td>20세~24세</td>\n","      <td>33.0</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>A</td>\n","      <td>4578334</td>\n","      <td>4</td>\n","      <td>402</td>\n","      <td>A040205</td>\n","      <td>12077</td>\n","      <td>1</td>\n","      <td>20150625</td>\n","      <td>11</td>\n","      <td>50000</td>\n","      <td>캐주얼</td>\n","      <td>영플라자(스트리트)</td>\n","      <td>M</td>\n","      <td>50세~54세</td>\n","      <td>310.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 15 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-915544fc-8a1a-41a2-8ae5-19945692de83')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-915544fc-8a1a-41a2-8ae5-19945692de83 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-915544fc-8a1a-41a2-8ae5-19945692de83');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["         제휴사     영수증번호  대분류코드  중분류코드    소분류코드   고객번호  점포코드      구매일자  구매시간  \\\n","0          B   8664000     15   1504  B150401  17218    44  20140222    20   \n","1          B   8747265     15   1504  B150401  17218    44  20150627    10   \n","2          B   8720725     15   1504  B150401  17218    44  20150129    17   \n","3          B   8725005     15   1504  B150401  17218    44  20150224    18   \n","4          B   8748478     15   1504  B150401  17218    44  20150704    15   \n","...       ..       ...    ...    ...      ...    ...   ...       ...   ...   \n","28593025   D    229558      2    204  D020406  18799    24  20150508    13   \n","28593026   C  11082648     13   1305  C130502  18799   358  20151030    19   \n","28593027   D    227041      4    402  D040218  18799    22  20150915    15   \n","28593028   C  11082648     13   1306  C130603  18799   358  20151030    19   \n","28593029   A   4578334      4    402  A040205  12077     1  20150625    11   \n","\n","           구매금액  중분류명        소분류명 성별      연령대   거주지역  \n","0          2420  탄산음료         사이다  F  50세~54세  100.0  \n","1           970  탄산음료         사이다  F  50세~54세  100.0  \n","2          1280  탄산음료         사이다  F  50세~54세  100.0  \n","3          1380  탄산음료         사이다  F  50세~54세  100.0  \n","4           980  탄산음료         사이다  F  50세~54세  100.0  \n","...         ...   ...         ... ..      ...    ...  \n","28593025   3000  구강케어     치약/칫솔세트  F  20세~24세   33.0  \n","28593026   7800    차류       녹차/홍차  F  20세~24세   33.0  \n","28593027   3900    음료        식수용차  F  20세~24세   33.0  \n","28593028   3300  건강식품    건강보조식품세트  F  20세~24세   33.0  \n","28593029  50000   캐주얼  영플라자(스트리트)  M  50세~54세  310.0  \n","\n","[28593030 rows x 15 columns]"]},"execution_count":25,"metadata":{},"output_type":"execute_result"}],"source":["# 구매상품TR과 상품분류 결합\n","total = pd.merge(pd.merge(data_6, data_5), data_4)\n","total"]},{"cell_type":"markdown","metadata":{"id":"T_qy3aEzRBxx"},"source":["## 2) 외부 데이터"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":607},"executionInfo":{"elapsed":367,"status":"ok","timestamp":1672293920762,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"Hn9w9CvHIkJe","outputId":"7396549b-eb12-45c0-d477-a8e628b97782"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-0aa1c2e4-ea3e-422b-a4e9-0ae327c8bbfa\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>KAN_CODE</th>\n","      <th>전체 분류</th>\n","      <th>현재 분류명</th>\n","      <th>상품예시</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1010101.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;천연/발효조미료</td>\n","      <td>천연/발효조미료</td>\n","      <td>다시다, 미원, 멸치가루, 버섯가루</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1010102.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;식초</td>\n","      <td>식초</td>\n","      <td>과일초, 발효초, 감식초, 사과식초, 현미식초, 홍초</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1010103.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;천일염</td>\n","      <td>천일염</td>\n","      <td>구운천일염, 꽃소금, 굵은소금, 가는소금, 볶은소금</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1010104.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;가공염</td>\n","      <td>가공염</td>\n","      <td>정제염, 맛소금, 허브솔트, 깨소금</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1010105.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;설탕</td>\n","      <td>설탕</td>\n","      <td>슈가파우더, 과당, 각설탕, 황설탕, 백설탕, 흑설탕</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3107</th>\n","      <td>11150301.0</td>\n","      <td>패션잡화&gt;양말&gt;유아동주니어양말/기타양말&gt;유아동주니어양말</td>\n","      <td>유아동주니어양말</td>\n","      <td>유아동양말, 주니어양말, 유아동캐릭터양말</td>\n","    </tr>\n","    <tr>\n","      <th>3108</th>\n","      <td>11150399.0</td>\n","      <td>패션잡화&gt;양말&gt;유아동주니어양말/기타양말&gt;기타양말</td>\n","      <td>기타양말</td>\n","      <td>방수양말, 리본양말, 배색양말</td>\n","    </tr>\n","    <tr>\n","      <th>3109</th>\n","      <td>11160101.0</td>\n","      <td>패션잡화&gt;유니섹스신발&gt;유니섹스신발류&gt;실내화</td>\n","      <td>실내화</td>\n","      <td>유니섹스실내화, 유니섹스패브릭실내화, 남녀실내화</td>\n","    </tr>\n","    <tr>\n","      <th>3110</th>\n","      <td>11160199.0</td>\n","      <td>패션잡화&gt;유니섹스신발&gt;유니섹스신발류&gt;기타 유니섹스신발류</td>\n","      <td>기타 유니섹스신발류</td>\n","      <td>유니섹스샌들, 유니섹스운동화, 유니섹스구두</td>\n","    </tr>\n","    <tr>\n","      <th>3111</th>\n","      <td>99999999.0</td>\n","      <td>기타상품&gt;기타&gt;기타&gt;기타</td>\n","      <td>기타</td>\n","      <td>오르골, 전자오르골, 탁상용오르골</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3112 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0aa1c2e4-ea3e-422b-a4e9-0ae327c8bbfa')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0aa1c2e4-ea3e-422b-a4e9-0ae327c8bbfa button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0aa1c2e4-ea3e-422b-a4e9-0ae327c8bbfa');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       KAN_CODE                            전체 분류       현재 분류명   \\\n","0      1010101.0         가공식품>조미료>종합조미료>천연/발효조미료     천연/발효조미료    \n","1      1010102.0               가공식품>조미료>종합조미료>식초           식초    \n","2      1010103.0              가공식품>조미료>종합조미료>천일염          천일염    \n","3      1010104.0              가공식품>조미료>종합조미료>가공염          가공염    \n","4      1010105.0               가공식품>조미료>종합조미료>설탕           설탕    \n","...          ...                              ...          ...   \n","3107  11150301.0  패션잡화>양말>유아동주니어양말/기타양말>유아동주니어양말     유아동주니어양말    \n","3108  11150399.0      패션잡화>양말>유아동주니어양말/기타양말>기타양말         기타양말    \n","3109  11160101.0         패션잡화>유니섹스신발>유니섹스신발류>실내화          실내화    \n","3110  11160199.0  패션잡화>유니섹스신발>유니섹스신발류>기타 유니섹스신발류   기타 유니섹스신발류    \n","3111  99999999.0                   기타상품>기타>기타>기타           기타    \n","\n","                               상품예시  \n","0               다시다, 미원, 멸치가루, 버섯가루  \n","1     과일초, 발효초, 감식초, 사과식초, 현미식초, 홍초  \n","2      구운천일염, 꽃소금, 굵은소금, 가는소금, 볶은소금  \n","3               정제염, 맛소금, 허브솔트, 깨소금  \n","4     슈가파우더, 과당, 각설탕, 황설탕, 백설탕, 흑설탕  \n","...                             ...  \n","3107         유아동양말, 주니어양말, 유아동캐릭터양말  \n","3108               방수양말, 리본양말, 배색양말  \n","3109     유니섹스실내화, 유니섹스패브릭실내화, 남녀실내화  \n","3110        유니섹스샌들, 유니섹스운동화, 유니섹스구두  \n","3111             오르골, 전자오르골, 탁상용오르골  \n","\n","[3112 rows x 4 columns]"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["# 유통상품 표준DB\n","kan = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/KAN.csv', encoding='cp949')\n","kan"]},{"cell_type":"code","source":["locations = pd.read_csv('/content/drive/MyDrive/학원/2차프로젝트 공유폴더/프로젝트데이터셋/places.csv', index_col=0)\n","locations['앞번호'] = locations['앞번호'].astype(str).str.zfill(3)\n","locations.rename(columns={'앞번호': '거주지역'}, inplace=True)\n","locations.reset_index(drop=True, inplace=True)\n","locations"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"LLdLmZymUIcw","executionInfo":{"status":"ok","timestamp":1672390222957,"user_tz":-540,"elapsed":286,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"e1b4b66a-8b21-4951-e677-42d5bf0962be"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          시도 거주지역\n","0      서울특별시  010\n","1      부산광역시  460\n","2      대구광역시  410\n","3      인천광역시  210\n","4      광주광역시  610\n","..       ...  ...\n","262     경상남도  500\n","263     경상남도  501\n","264     경상남도  502\n","265  제주특별자치도  630\n","266  제주특별자치도  635\n","\n","[267 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-e3419d2a-6f99-4d86-b071-a177555e42aa\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>시도</th>\n","      <th>거주지역</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>서울특별시</td>\n","      <td>010</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>부산광역시</td>\n","      <td>460</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>대구광역시</td>\n","      <td>410</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>인천광역시</td>\n","      <td>210</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>광주광역시</td>\n","      <td>610</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>262</th>\n","      <td>경상남도</td>\n","      <td>500</td>\n","    </tr>\n","    <tr>\n","      <th>263</th>\n","      <td>경상남도</td>\n","      <td>501</td>\n","    </tr>\n","    <tr>\n","      <th>264</th>\n","      <td>경상남도</td>\n","      <td>502</td>\n","    </tr>\n","    <tr>\n","      <th>265</th>\n","      <td>제주특별자치도</td>\n","      <td>630</td>\n","    </tr>\n","    <tr>\n","      <th>266</th>\n","      <td>제주특별자치도</td>\n","      <td>635</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>267 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e3419d2a-6f99-4d86-b071-a177555e42aa')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e3419d2a-6f99-4d86-b071-a177555e42aa button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e3419d2a-6f99-4d86-b071-a177555e42aa');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":33}]},{"cell_type":"markdown","source":["# #2. 데이터 살펴보기"],"metadata":{"id":"Sa-O900IHK1o"}},{"cell_type":"code","source":[],"metadata":{"id":"PjOXGXwrHOLC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"YEeZEQNtHONg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"K401y7rFHOQg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"xMmfVlxTHOTP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"Df0f_JhKHOV3"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"FLG5JxtaHOYo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"HL6sxAxlHObP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"F_4gy0SpHOdw"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ekfh_pGYOh3C"},"source":["# #3. 데이터 전처리"]},{"cell_type":"markdown","metadata":{"id":"K6zC9XKpUqyg"},"source":["## 1) 데이터 라벨링\n","* 성별 : 남자 0, 여자 1\n","* 분기 : 구매일자를 기준으로 분기 설정\n","* 연령대 : 10대 1, 20대 2, 30대 3, 40대 4, 50대 5, 60대이상 6\n","* 거주지역 : 우편번호 앞자리 세 자리 str으로 변경\n"]},{"cell_type":"markdown","metadata":{"id":"Dt-GokZiWy86"},"source":["### (1) 성별"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JYr5MoNsUdUm"},"outputs":[],"source":["total1 = total.copy()\n","total1['성별']=np.where(total1['성별']=='M', 0, 1)"]},{"cell_type":"markdown","metadata":{"id":"dbVinMIEXF3t"},"source":["### (2) 분기"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F0SoP2qbXyX5"},"outputs":[],"source":["bins = [20140101, 20140401, 20140701, 20141001, 20150101, 20150401, 20150701, 20151001, 20151232]\n","labels = [1,2,3,4,5,6,7,8]\n","total1['분기'] = pd.cut(total1['구매일자'], bins=bins, include_lowest=True, right=False, labels=labels) "]},{"cell_type":"markdown","metadata":{"id":"GI0HWgRiXJ0B"},"source":["### (3) 연령대"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q33A4SxwUdUm"},"outputs":[],"source":["total1['연령대']=total1['연령대'].str[0:1]"]},{"cell_type":"markdown","metadata":{"id":"yL2XJkbWXXj2"},"source":["### (4) 거주지역"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7v79LopJUdUo"},"outputs":[],"source":["total1['거주지역'] = total1['거주지역'].astype(str).str[:-2]\n","total1['거주지역'] = total1['거주지역'].str.zfill(3)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":387,"status":"ok","timestamp":1672294218334,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"hQO0KIbqf3Ka","outputId":"5878ed76-b5cd-4d89-9ad1-b5cee2911e50"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-9bfb49b6-18d6-48a7-a9fc-01c4599710ce\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>영수증번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>분기</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>2420</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>B</td>\n","      <td>8747265</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150627</td>\n","      <td>10</td>\n","      <td>970</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>B</td>\n","      <td>8720725</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150129</td>\n","      <td>17</td>\n","      <td>1280</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>B</td>\n","      <td>8725005</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150224</td>\n","      <td>18</td>\n","      <td>1380</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>B</td>\n","      <td>8748478</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20150704</td>\n","      <td>15</td>\n","      <td>980</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>D</td>\n","      <td>229558</td>\n","      <td>2</td>\n","      <td>204</td>\n","      <td>D020406</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150508</td>\n","      <td>13</td>\n","      <td>3000</td>\n","      <td>구강케어</td>\n","      <td>치약/칫솔세트</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>033</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>C</td>\n","      <td>11082648</td>\n","      <td>13</td>\n","      <td>1305</td>\n","      <td>C130502</td>\n","      <td>18799</td>\n","      <td>358</td>\n","      <td>20151030</td>\n","      <td>19</td>\n","      <td>7800</td>\n","      <td>차류</td>\n","      <td>녹차/홍차</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>033</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>D</td>\n","      <td>227041</td>\n","      <td>4</td>\n","      <td>402</td>\n","      <td>D040218</td>\n","      <td>18799</td>\n","      <td>22</td>\n","      <td>20150915</td>\n","      <td>15</td>\n","      <td>3900</td>\n","      <td>음료</td>\n","      <td>식수용차</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>033</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>C</td>\n","      <td>11082648</td>\n","      <td>13</td>\n","      <td>1306</td>\n","      <td>C130603</td>\n","      <td>18799</td>\n","      <td>358</td>\n","      <td>20151030</td>\n","      <td>19</td>\n","      <td>3300</td>\n","      <td>건강식품</td>\n","      <td>건강보조식품세트</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>033</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>A</td>\n","      <td>4578334</td>\n","      <td>4</td>\n","      <td>402</td>\n","      <td>A040205</td>\n","      <td>12077</td>\n","      <td>1</td>\n","      <td>20150625</td>\n","      <td>11</td>\n","      <td>50000</td>\n","      <td>캐주얼</td>\n","      <td>영플라자(스트리트)</td>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>310</td>\n","      <td>6</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 16 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9bfb49b6-18d6-48a7-a9fc-01c4599710ce')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9bfb49b6-18d6-48a7-a9fc-01c4599710ce button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9bfb49b6-18d6-48a7-a9fc-01c4599710ce');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["         제휴사     영수증번호  대분류코드  중분류코드    소분류코드   고객번호  점포코드      구매일자  구매시간  \\\n","0          B   8664000     15   1504  B150401  17218    44  20140222    20   \n","1          B   8747265     15   1504  B150401  17218    44  20150627    10   \n","2          B   8720725     15   1504  B150401  17218    44  20150129    17   \n","3          B   8725005     15   1504  B150401  17218    44  20150224    18   \n","4          B   8748478     15   1504  B150401  17218    44  20150704    15   \n","...       ..       ...    ...    ...      ...    ...   ...       ...   ...   \n","28593025   D    229558      2    204  D020406  18799    24  20150508    13   \n","28593026   C  11082648     13   1305  C130502  18799   358  20151030    19   \n","28593027   D    227041      4    402  D040218  18799    22  20150915    15   \n","28593028   C  11082648     13   1306  C130603  18799   358  20151030    19   \n","28593029   A   4578334      4    402  A040205  12077     1  20150625    11   \n","\n","           구매금액  중분류명        소분류명  성별 연령대 거주지역 분기  \n","0          2420  탄산음료         사이다   1   5  100  1  \n","1           970  탄산음료         사이다   1   5  100  6  \n","2          1280  탄산음료         사이다   1   5  100  5  \n","3          1380  탄산음료         사이다   1   5  100  5  \n","4           980  탄산음료         사이다   1   5  100  7  \n","...         ...   ...         ...  ..  ..  ... ..  \n","28593025   3000  구강케어     치약/칫솔세트   1   2  033  6  \n","28593026   7800    차류       녹차/홍차   1   2  033  8  \n","28593027   3900    음료        식수용차   1   2  033  7  \n","28593028   3300  건강식품    건강보조식품세트   1   2  033  8  \n","28593029  50000   캐주얼  영플라자(스트리트)   0   5  310  6  \n","\n","[28593030 rows x 16 columns]"]},"execution_count":31,"metadata":{},"output_type":"execute_result"}],"source":["total1"]},{"cell_type":"code","source":["loc_dict = locations.set_index('거주지역').to_dict()\n","locs = loc_dict['시도']\n","df['지역'] = df['거주지역'].map(locs)\n","\n","codes = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]\n","plcs = ['서울특별시', '경기도', '인천광역시', '강원도', '충청북도', '세종특별자치시',\n","        '충청남도', '대전광역시', '경상북도', '대구광역시', '울산광역시', '부산광역시',\n","        '경상남도', '전라북도', '전라남도', '광주광역시', '제주특별자치도']\n","\n","places = list(zip(plcs, codes))\n","y = dict(places)\n","\n","df['거주지역'] = df['지역'].map(y)\n","df['거주지역'] = df['거주지역'].astype('Int64')\n","df.drop(columns=['지역'], inplace=True)\n","df"],"metadata":{"id":"aH5mMxWv24vY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import numpy as np\n","locations = pd.read_csv('/content/drive/MyDrive/학원/2차 프로젝트/places.csv', index_col=0)\n","locations['앞번호'] = locations['앞번호'].astype(str).str.zfill(3)\n","locations.rename(columns={'앞번호': '거주지역'}, inplace=True)\n","locations.reset_index(drop=True, inplace=True)\n","locations\n","\n","loc_dict = locations.set_index('거주지역').to_dict()\n","locs = loc_dict['시도']\n","df['지역'] = df['거주지역'].map(locs)\n","\n","codes = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]\n","plcs = ['서울특별시', '경기도', '인천광역시', '강원도', '충청북도', '세종특별자치시',\n","        '충청남도', '대전광역시', '경상북도', '대구광역시', '울산광역시', '부산광역시',\n","        '경상남도', '전라북도', '전라남도', '광주광역시', '제주특별자치도']\n","\n","places = list(zip(plcs, codes))\n","y = dict(places)\n","\n","df['거주지역'] = df['지역'].map(y)\n","df['거주지역'] = df['거주지역'].astype('Int64')\n","df.drop(columns=['지역'], inplace=True)\n","df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"5DvyOG-GxvPP","executionInfo":{"status":"ok","timestamp":1672377030434,"user_tz":-540,"elapsed":30987,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"5a1c4d0e-312b-4255-9d87-c96f9c939341"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          대분류코드  중분류코드    소분류코드    중분류명      소분류명   대분류    영수증번호   고객번호  점포코드  \\\n","0             1    101  A010101    일용잡화      위생세제  일상용품  2757986  15148    10   \n","1             1    101  A010101    일용잡화      위생세제  일상용품  1878938  15148    10   \n","2             1    101  A010101    일용잡화      위생세제  일상용품  3436437  15148    10   \n","3             1    101  A010103    일용잡화      뷰티상품  일상용품  1385676  15148    10   \n","4             1    101  A010103    일용잡화      뷰티상품  일상용품  1547466  15148    10   \n","...         ...    ...      ...     ...       ...   ...      ...    ...   ...   \n","28593025      8    802  D080204  아이메이크업     아이섀도우  일상용품   229784  18799    24   \n","28593026      8    803  D080301   립메이크업  립스틱/립라이너  일상용품   230365  18799    24   \n","28593027      8    803  D080302   립메이크업   립글로즈/틴트  일상용품   229653  18799    24   \n","28593028      8    803  D080302   립메이크업   립글로즈/틴트  일상용품   229670  18799    24   \n","28593029      8    803  D080302   립메이크업   립글로즈/틴트  일상용품   229914  18799    24   \n","\n","              구매일자  구매시간   구매금액  성별  연령대  거주지역    년도  분류  분기 제휴사  \n","0         20140920    20   1000   1    5     2  2014  저가   3   A  \n","1         20140505    19  15000   1    5     2  2014  저가   2   A  \n","2         20150102    16   9900   1    5     2  2015  저가   5   A  \n","3         20140215    17   7000   1    5     2  2014  저가   1   A  \n","4         20140315    19  21000   1    5     2  2014  중가   1   A  \n","...            ...   ...    ...  ..  ...   ...   ...  ..  ..  ..  \n","28593025  20150805    15   9900   1    2     1  2015  저가   7   D  \n","28593026  20151203    16  11200   1    2     1  2015  저가   8   D  \n","28593027  20150618    16   7200   1    2     1  2015  저가   6   D  \n","28593028  20150625    14   9000   1    2     1  2015  저가   6   D  \n","28593029  20151007    16   9800   1    2     1  2015  저가   8   D  \n","\n","[28593030 rows x 19 columns]"],"text/html":["\n","  <div id=\"df-c04c5943-eeaa-46d0-9693-c7b076c532c1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","      <th>영수증번호</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>년도</th>\n","      <th>분류</th>\n","      <th>분기</th>\n","      <th>제휴사</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>2757986</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140920</td>\n","      <td>20</td>\n","      <td>1000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>3</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>1878938</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140505</td>\n","      <td>19</td>\n","      <td>15000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>2</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>3436437</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20150102</td>\n","      <td>16</td>\n","      <td>9900</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>5</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","      <td>1385676</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140215</td>\n","      <td>17</td>\n","      <td>7000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>1</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","      <td>1547466</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140315</td>\n","      <td>19</td>\n","      <td>21000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>1</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>D080204</td>\n","      <td>아이메이크업</td>\n","      <td>아이섀도우</td>\n","      <td>일상용품</td>\n","      <td>229784</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150805</td>\n","      <td>15</td>\n","      <td>9900</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>7</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080301</td>\n","      <td>립메이크업</td>\n","      <td>립스틱/립라이너</td>\n","      <td>일상용품</td>\n","      <td>230365</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20151203</td>\n","      <td>16</td>\n","      <td>11200</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>8</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229653</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150618</td>\n","      <td>16</td>\n","      <td>7200</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229670</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150625</td>\n","      <td>14</td>\n","      <td>9000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229914</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20151007</td>\n","      <td>16</td>\n","      <td>9800</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>8</td>\n","      <td>D</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 19 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c04c5943-eeaa-46d0-9693-c7b076c532c1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c04c5943-eeaa-46d0-9693-c7b076c532c1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c04c5943-eeaa-46d0-9693-c7b076c532c1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":3}]},{"cell_type":"markdown","metadata":{"id":"0b7mZ7g1OvnF"},"source":["## 2) 대분류 나누기\n","* 유통DB 참고하여 대분류 카테고리 추가\n","* 상품별 평균 가격보다 2배 이상인 경우 '고가', 0.5배 이하인 경우 '저가', 그 이외 가격은 '중가'로 설정\n","* 총 33개 대분류로 분리"]},{"cell_type":"markdown","metadata":{"id":"PqArmgYQvG6O"},"source":["### (1) 유통DB 대분류 추출\n","'전체 분류' 칼럼 안에 '대분류>중분류>소분류>세분류' 형태로 입력되어 있음\n","\n","대분류만 추출하여 칼럼 추가\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f8-bG9sTJmo8"},"outputs":[],"source":["slice_1 = kan['전체 분류 '].str.split('>')\n","kan['분류1'] = slice_1.str.get(0)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":641},"executionInfo":{"elapsed":391,"status":"ok","timestamp":1672294238584,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"WJel8QHtJxKv","outputId":"0cff919a-5dee-4e7f-9d8b-934c140626b1"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-8ce18c75-a623-45d1-8f9b-41d9ac5cbbdd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>KAN_CODE</th>\n","      <th>전체 분류</th>\n","      <th>현재 분류명</th>\n","      <th>상품예시</th>\n","      <th>분류1</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1010101.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;천연/발효조미료</td>\n","      <td>천연/발효조미료</td>\n","      <td>다시다, 미원, 멸치가루, 버섯가루</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1010102.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;식초</td>\n","      <td>식초</td>\n","      <td>과일초, 발효초, 감식초, 사과식초, 현미식초, 홍초</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1010103.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;천일염</td>\n","      <td>천일염</td>\n","      <td>구운천일염, 꽃소금, 굵은소금, 가는소금, 볶은소금</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1010104.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;가공염</td>\n","      <td>가공염</td>\n","      <td>정제염, 맛소금, 허브솔트, 깨소금</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1010105.0</td>\n","      <td>가공식품&gt;조미료&gt;종합조미료&gt;설탕</td>\n","      <td>설탕</td>\n","      <td>슈가파우더, 과당, 각설탕, 황설탕, 백설탕, 흑설탕</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>3107</th>\n","      <td>11150301.0</td>\n","      <td>패션잡화&gt;양말&gt;유아동주니어양말/기타양말&gt;유아동주니어양말</td>\n","      <td>유아동주니어양말</td>\n","      <td>유아동양말, 주니어양말, 유아동캐릭터양말</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>3108</th>\n","      <td>11150399.0</td>\n","      <td>패션잡화&gt;양말&gt;유아동주니어양말/기타양말&gt;기타양말</td>\n","      <td>기타양말</td>\n","      <td>방수양말, 리본양말, 배색양말</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>3109</th>\n","      <td>11160101.0</td>\n","      <td>패션잡화&gt;유니섹스신발&gt;유니섹스신발류&gt;실내화</td>\n","      <td>실내화</td>\n","      <td>유니섹스실내화, 유니섹스패브릭실내화, 남녀실내화</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>3110</th>\n","      <td>11160199.0</td>\n","      <td>패션잡화&gt;유니섹스신발&gt;유니섹스신발류&gt;기타 유니섹스신발류</td>\n","      <td>기타 유니섹스신발류</td>\n","      <td>유니섹스샌들, 유니섹스운동화, 유니섹스구두</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>3111</th>\n","      <td>99999999.0</td>\n","      <td>기타상품&gt;기타&gt;기타&gt;기타</td>\n","      <td>기타</td>\n","      <td>오르골, 전자오르골, 탁상용오르골</td>\n","      <td>기타상품</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3112 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8ce18c75-a623-45d1-8f9b-41d9ac5cbbdd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8ce18c75-a623-45d1-8f9b-41d9ac5cbbdd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8ce18c75-a623-45d1-8f9b-41d9ac5cbbdd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       KAN_CODE                            전체 분류       현재 분류명   \\\n","0      1010101.0         가공식품>조미료>종합조미료>천연/발효조미료     천연/발효조미료    \n","1      1010102.0               가공식품>조미료>종합조미료>식초           식초    \n","2      1010103.0              가공식품>조미료>종합조미료>천일염          천일염    \n","3      1010104.0              가공식품>조미료>종합조미료>가공염          가공염    \n","4      1010105.0               가공식품>조미료>종합조미료>설탕           설탕    \n","...          ...                              ...          ...   \n","3107  11150301.0  패션잡화>양말>유아동주니어양말/기타양말>유아동주니어양말     유아동주니어양말    \n","3108  11150399.0      패션잡화>양말>유아동주니어양말/기타양말>기타양말         기타양말    \n","3109  11160101.0         패션잡화>유니섹스신발>유니섹스신발류>실내화          실내화    \n","3110  11160199.0  패션잡화>유니섹스신발>유니섹스신발류>기타 유니섹스신발류   기타 유니섹스신발류    \n","3111  99999999.0                   기타상품>기타>기타>기타           기타    \n","\n","                               상품예시   분류1  \n","0               다시다, 미원, 멸치가루, 버섯가루  가공식품  \n","1     과일초, 발효초, 감식초, 사과식초, 현미식초, 홍초  가공식품  \n","2      구운천일염, 꽃소금, 굵은소금, 가는소금, 볶은소금  가공식품  \n","3               정제염, 맛소금, 허브솔트, 깨소금  가공식품  \n","4     슈가파우더, 과당, 각설탕, 황설탕, 백설탕, 흑설탕  가공식품  \n","...                             ...   ...  \n","3107         유아동양말, 주니어양말, 유아동캐릭터양말  패션잡화  \n","3108               방수양말, 리본양말, 배색양말  패션잡화  \n","3109     유니섹스실내화, 유니섹스패브릭실내화, 남녀실내화  패션잡화  \n","3110        유니섹스샌들, 유니섹스운동화, 유니섹스구두  패션잡화  \n","3111             오르골, 전자오르골, 탁상용오르골  기타상품  \n","\n","[3112 rows x 5 columns]"]},"execution_count":33,"metadata":{},"output_type":"execute_result"}],"source":["kan"]},{"cell_type":"markdown","metadata":{"id":"SzYWILWovQhd"},"source":["### (2) 상품명 분리 후 대분류 지정"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"executionInfo":{"elapsed":392,"status":"ok","timestamp":1672294243820,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"89KxynePbbBb","outputId":"c4c05c73-873f-4703-f5e6-ea5a9212c679"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-7b59df06-a7c8-4429-8c13-6896987c5989\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>중분류명</th>\n","      <th>대분류명</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7b59df06-a7c8-4429-8c13-6896987c5989')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7b59df06-a7c8-4429-8c13-6896987c5989 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7b59df06-a7c8-4429-8c13-6896987c5989');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["Empty DataFrame\n","Columns: [중분류명, 대분류명]\n","Index: []"]},"execution_count":34,"metadata":{},"output_type":"execute_result"}],"source":["# 빈 데이터 생성\n","kan_df = pd.DataFrame(columns=['중분류명', '대분류명'])\n","kan_df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6dLMKso4cJ3z"},"outputs":[],"source":["# '전체 분류' 칼럼의 형태소 분리 후 중분류 명에 추가\n","from konlpy.tag import Kkma\n","from konlpy.utils import pprint\n","kkma = Kkma()\n","\n","classifi_list = ['가공식품', '신선식품', '일상용품', '의약품/의료기기', '교육/문화용품', '디지털/가전',\n","       '가구/인테리어', '의류', '전문스포츠/레저', '패션잡화', '기타상품']\n","for li in classifi_list:\n","    df = kan[kan['분류1'] == li]\n","\n","    # 태그 단어로 분리 후 추가\n","    for text in df['전체 분류 ']:\n","        nouns = kkma.nouns(text)\n","        for word in nouns:\n","            if len(word) > 1:\n","                kan_df.loc[len(kan_df)] = [word, li]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":9,"status":"ok","timestamp":1671598974015,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"FjCX3QnhMGlW","outputId":"4949906a-6f21-4c44-eedc-7e79a85e41ff"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-750efba0-b277-4b47-acef-7e129b78a237\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>중분류명</th>\n","      <th>대분류명</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>가공</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>가공식품</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>식품</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>조미료</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>미료</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>26395</th>\n","      <td>신발</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>26396</th>\n","      <td>기타</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>26397</th>\n","      <td>기타</td>\n","      <td>기타상품</td>\n","    </tr>\n","    <tr>\n","      <th>26398</th>\n","      <td>기타상품</td>\n","      <td>기타상품</td>\n","    </tr>\n","    <tr>\n","      <th>26399</th>\n","      <td>상품</td>\n","      <td>기타상품</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>26400 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-750efba0-b277-4b47-acef-7e129b78a237')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-750efba0-b277-4b47-acef-7e129b78a237 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-750efba0-b277-4b47-acef-7e129b78a237');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       중분류명  대분류명\n","0        가공  가공식품\n","1      가공식품  가공식품\n","2        식품  가공식품\n","3       조미료  가공식품\n","4        미료  가공식품\n","...     ...   ...\n","26395    신발  패션잡화\n","26396    기타  패션잡화\n","26397    기타  기타상품\n","26398  기타상품  기타상품\n","26399    상품  기타상품\n","\n","[26400 rows x 2 columns]"]},"execution_count":20,"metadata":{},"output_type":"execute_result"}],"source":["kan_df"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":475,"status":"ok","timestamp":1672294418795,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"jqkyrY5ncNDD","outputId":"ab241e1a-fd33-4a7c-e369-4bbc8fd01ce6"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-469f22af-1d2a-49eb-b914-37ae62e9f332\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>중분류명</th>\n","      <th>대분류명</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>가공</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>가공식품</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>식품</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>조미료</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>미료</td>\n","      <td>가공식품</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>26384</th>\n","      <td>유니</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>26385</th>\n","      <td>유니섹스신발</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>26386</th>\n","      <td>섹스</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>26388</th>\n","      <td>실내화</td>\n","      <td>패션잡화</td>\n","    </tr>\n","    <tr>\n","      <th>26398</th>\n","      <td>기타상품</td>\n","      <td>기타상품</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4214 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-469f22af-1d2a-49eb-b914-37ae62e9f332')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-469f22af-1d2a-49eb-b914-37ae62e9f332 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-469f22af-1d2a-49eb-b914-37ae62e9f332');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["         중분류명  대분류명\n","0          가공  가공식품\n","1        가공식품  가공식품\n","2          식품  가공식품\n","3         조미료  가공식품\n","4          미료  가공식품\n","...       ...   ...\n","26384      유니  패션잡화\n","26385  유니섹스신발  패션잡화\n","26386      섹스  패션잡화\n","26388     실내화  패션잡화\n","26398    기타상품  기타상품\n","\n","[4214 rows x 2 columns]"]},"execution_count":36,"metadata":{},"output_type":"execute_result"}],"source":["# 중복 제거\n","kan_df_drop = kan_df.drop_duplicates(['중분류명'])\n","kan_df_drop"]},{"cell_type":"markdown","metadata":{"id":"QTlhoSsca1Wu"},"source":["### (3) 상품분류 데이터와 결합"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":485},"executionInfo":{"elapsed":351,"status":"ok","timestamp":1672294422737,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"twc0uEN7D2Af","outputId":"491b462c-a70c-495a-8a1f-24a47e9f0fbf"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-aca93c12-cb9b-4325-b2a7-c62923750d09\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>영수증번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>대분류</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>2420</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>16</td>\n","      <td>1601</td>\n","      <td>B160101</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>1070</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>16</td>\n","      <td>1602</td>\n","      <td>B160201</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>8060</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>18</td>\n","      <td>1803</td>\n","      <td>B180301</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>6000</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>B</td>\n","      <td>8664001</td>\n","      <td>5</td>\n","      <td>509</td>\n","      <td>B050901</td>\n","      <td>17674</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>22</td>\n","      <td>1120</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>B</td>\n","      <td>8116737</td>\n","      <td>37</td>\n","      <td>3709</td>\n","      <td>B370904</td>\n","      <td>7439</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>19</td>\n","      <td>14000</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>B</td>\n","      <td>8116738</td>\n","      <td>37</td>\n","      <td>3709</td>\n","      <td>B370904</td>\n","      <td>16421</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>20</td>\n","      <td>6500</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>B</td>\n","      <td>8116739</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>B080203</td>\n","      <td>8266</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>13</td>\n","      <td>16000</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>B</td>\n","      <td>8116764</td>\n","      <td>90</td>\n","      <td>9001</td>\n","      <td>B900103</td>\n","      <td>14316</td>\n","      <td>29</td>\n","      <td>20150526</td>\n","      <td>19</td>\n","      <td>1000</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>B</td>\n","      <td>8116741</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>B080203</td>\n","      <td>16587</td>\n","      <td>29</td>\n","      <td>20150525</td>\n","      <td>17</td>\n","      <td>16000</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aca93c12-cb9b-4325-b2a7-c62923750d09')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-aca93c12-cb9b-4325-b2a7-c62923750d09 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-aca93c12-cb9b-4325-b2a7-c62923750d09');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["         제휴사    영수증번호  대분류코드  중분류코드    소분류코드   고객번호  점포코드      구매일자  구매시간  \\\n","0          B  8664000     15   1504  B150401  17218    44  20140222    20   \n","1          B  8664000     16   1601  B160101  17218    44  20140222    20   \n","2          B  8664000     16   1602  B160201  17218    44  20140222    20   \n","3          B  8664000     18   1803  B180301  17218    44  20140222    20   \n","4          B  8664001      5    509  B050901  17674    44  20140222    22   \n","...       ..      ...    ...    ...      ...    ...   ...       ...   ...   \n","28593025   B  8116737     37   3709  B370904   7439    29  20150525    19   \n","28593026   B  8116738     37   3709  B370904  16421    29  20150525    20   \n","28593027   B  8116739      8    802  B080203   8266    29  20150525    13   \n","28593028   B  8116764     90   9001  B900103  14316    29  20150526    19   \n","28593029   B  8116741      8    802  B080203  16587    29  20150525    17   \n","\n","           구매금액  대분류  \n","0          2420  NaN  \n","1          1070  NaN  \n","2          8060  NaN  \n","3          6000  NaN  \n","4          1120  NaN  \n","...         ...  ...  \n","28593025  14000  NaN  \n","28593026   6500  NaN  \n","28593027  16000  NaN  \n","28593028   1000  NaN  \n","28593029  16000  NaN  \n","\n","[28593030 rows x 11 columns]"]},"execution_count":37,"metadata":{},"output_type":"execute_result"}],"source":["# 대분류 열을 만들어서 결측치 추가\n","data_6['대분류'] = np.nan\n","data_6"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yU_AOGe1D-_w"},"outputs":[],"source":["# 태그 단어로 분리 후 추가\n","for i, text in enumerate(data_6['중분류명']):\n","    nouns = kkma.nouns(text) \n","    for word in nouns:\n","        if len(word) > 1 and (word in kan_df_drop['중분류명'].values):\n","            data_6.loc[i, '대분류'] = kan_df_drop[kan_df_drop['중분류명'] == word]['대분류명'].values\n","        else:\n","            continue"]},{"cell_type":"markdown","metadata":{"id":"O_OngNWJFn4e"},"source":["### (4) 확인되지 않는 대분류 정리"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":544,"status":"ok","timestamp":1671609818443,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"zgJRH9MFitoX","outputId":"4c313f01-72e0-4dc7-a687-dad507d4938d"},"outputs":[{"data":{"text/plain":["array(['일상용품', '가공식품', nan, '교육/문화용품', '패션잡화', '디지털/가전', '의류', '가구/인테리어',\n","       '신선식품', '의약품/의료기기', '전문스포츠/레저'], dtype=object)"]},"execution_count":200,"metadata":{},"output_type":"execute_result"}],"source":["data_6['대분류'].unique()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":238},"executionInfo":{"elapsed":475,"status":"ok","timestamp":1671610751341,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"jjYp8PyVuDPD","outputId":"d3dd663c-4d00-4e01-fcdf-0e68885bdd03"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-eb82e5c9-d3e9-407f-8145-f0cb420f0259\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3034</th>\n","      <td>B</td>\n","      <td>79</td>\n","      <td>7904</td>\n","      <td>B790401</td>\n","      <td>연체</td>\n","      <td>갑오징어</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3035</th>\n","      <td>B</td>\n","      <td>79</td>\n","      <td>7904</td>\n","      <td>B790402</td>\n","      <td>연체</td>\n","      <td>기타연체류</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3036</th>\n","      <td>B</td>\n","      <td>79</td>\n","      <td>7904</td>\n","      <td>B790403</td>\n","      <td>연체</td>\n","      <td>낙지</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3037</th>\n","      <td>B</td>\n","      <td>79</td>\n","      <td>7904</td>\n","      <td>B790404</td>\n","      <td>연체</td>\n","      <td>문어</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3038</th>\n","      <td>B</td>\n","      <td>79</td>\n","      <td>7904</td>\n","      <td>B790405</td>\n","      <td>연체</td>\n","      <td>주꾸미</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3039</th>\n","      <td>B</td>\n","      <td>79</td>\n","      <td>7904</td>\n","      <td>B790406</td>\n","      <td>연체</td>\n","      <td>해파리</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-eb82e5c9-d3e9-407f-8145-f0cb420f0259')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-eb82e5c9-d3e9-407f-8145-f0cb420f0259 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-eb82e5c9-d3e9-407f-8145-f0cb420f0259');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     제휴사  대분류코드  중분류코드    소분류코드 중분류명   소분류명  대분류\n","3034   B     79   7904  B790401   연체   갑오징어  NaN\n","3035   B     79   7904  B790402   연체  기타연체류  NaN\n","3036   B     79   7904  B790403   연체     낙지  NaN\n","3037   B     79   7904  B790404   연체     문어  NaN\n","3038   B     79   7904  B790405   연체    주꾸미  NaN\n","3039   B     79   7904  B790406   연체    해파리  NaN"]},"execution_count":219,"metadata":{},"output_type":"execute_result"}],"source":["data_6[data_6['중분류명']=='연체']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1671604087936,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"y0nGBOIyNhUc","outputId":"6758f12b-e7a1-4820-afad-a706dda9bc4f"},"outputs":[{"data":{"text/plain":["array(['보석', '커리어', '트래디셔널', '디자이너', '교복', '명품', '양곡', '잎채소', '약초', '식자재',\n","       'LOCAL잎채소', '대중선어', '대구', '도미/민어', '꽁치/가자미', '마른안주', '특산물', '쥐치포',\n","       'Fast Food', '레스토랑', '판매시설', '주유소', '베이커리', '구이', '밥류', '데일리처분',\n","       '브랜드빵', '디저트', '유가공', '잼', '차', '꿀', '비스켓', '캔디', '껌', '안주',\n","       '프리미엄과자', '양주', '균일가', '상', '아웃도어퍼니처', 'BABY/INFANT', 'GIRLS',\n","       'VIDEOGAME', '남아', 'SPORTS/OUTDOOR', 'EDUCATION 1', 'EDUCATION 2',\n","       'BOYS 1', 'BOYS 2', '행사', '란제리', '란제리브랜드', '분식', '양식', '일식', '중식',\n","       '한식', '패스트푸드', '컨세션', '해초류', '묵', 'TV', 'DVD', 'PC', 'MP3/PMP',\n","       '냉장면류', '햄', '아동화브랜드', '운동화', '준보석', '미입점행사', '핸드백', '우육', '오리고기',\n","       '마담/어덜트', '브랜드', '감', '메론', '자몽', '한방식재류', '한방차', '선식', '떡', '젓갈류',\n","       '브랜드푸드몰', '빵', '먹거리', '먹거리행사', '맛집행사', '특산물행사', '아로마', 'TRAVEL',\n","       '냉장간편식HMR', '밥죽류', '홍인삼', '규격RTC', '연체', '새우', '마른김', '가공란', '배',\n","       '구색과일', '밤', '국산과일', '선식류', '엽채류', '과채류', '근채류', '두채류', '양채류',\n","       '선어류', '선어가공', '건어류', '건어가공', '발효유', '차류', '감미료', '건면', '캔디껌류',\n","       '초콜렛', '씨리얼', '피트니스', '계절팩'], dtype=object)"]},"execution_count":110,"metadata":{},"output_type":"execute_result"}],"source":["data_6[data_6['대분류'].isnull()]['중분류명'].unique()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mT_Xuf-Qra8K"},"outputs":[],"source":["for i, text in enumerate(data_6['중분류명']):\n","    if text in ['균일가', '상']:\n","       data_6.loc[i, '대분류'] = '일상용품'\n","    elif text in [ '마른안주', '특산물', '쥐치포',  '잼', '차', '꿀', '비스켓', '캔디', '껌', '안주', '양주',\n","       '프리미엄과자', '냉장면류', '햄',  '한방식재류', '한방차', '선식', '냉장간편식HMR', '밥죽류',  '홍인삼',\n","       '규격RTC', '마른김', '선어가공', '건어류', '건어가공', '발효유', '차류', '감미료', '건면', '캔디껌류',\n","       '초콜렛', '씨리얼']:\n","       data_6.loc[i, '대분류'] = '가공식품'\n","    elif text in [ '양곡', '잎채소', '약초', '식자재', 'LOCAL잎채소', '대중선어', '대구', '도미/민어', \n","                  '꽁치/가자미', '구이', '밥류', '데일리처분', '브랜드빵', '디저트', '유가공','해초류', '묵', '우육',\n","                  '오리고기', '연체', '새우',  '가공란', '배', '구색과일', '밤', '국산과일', '선식류', '엽채류', \n","                  '과채류', '근채류', '두채류', '양채류', '선어류',  '감', '메론', '자몽', '떡', '젓갈류']:\n","       data_6.loc[i, '대분류'] = '신선식품'\n","    elif text in [ '란제리', '란제리브랜드', '아동화브랜드', '운동화',  '핸드백']:\n","       data_6.loc[i, '대분류'] =  '패션잡화',\n","    elif text in ['VIDEOGAME',  'TV', 'DVD', 'PC', 'MP3/PMP']:\n","       data_6.loc[i, '대분류'] = '디지털/가전'\n","    elif text in [ '트래디셔널', '디자이너', '교복',  '명품',  'SPORTS/OUTDOOR',]:\n","       data_6.loc[i, '대분류'] =  '의류'\n","    elif text in [ '아웃도어퍼니처']:\n","       data_6.loc[i, '대분류'] = '가구/인테리어'\n","    elif text in [ 'Fast Food', '레스토랑', '베이커리', '분식', '양식', '일식', '중식', '한식', '패스트푸드','컨세션']:\n","       data_6.loc[i, '대분류'] = '음식점'\n","    elif text in ['보석', '커리어','판매시설', '주유소', 'BABY/INFANT', 'GIRLS',  '남아',\n","                   'EDUCATION 1', 'EDUCATION 2',  'BOYS 1', 'BOYS 2', '행사', '준보석',\n","                   '미입점행사', '마담/어덜트', '브랜드', '브랜드푸드몰', '빵', '먹거리', '먹거리행사', \n","                  '맛집행사', '특산물행사', '아로마', 'TRAVEL','피트니스', '계절팩']:\n","       data_6.loc[i, '대분류'] = '기타'\n","    else:\n","        continue"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":485,"status":"ok","timestamp":1671670766485,"user":{"displayName":"lily","userId":"08025258415486728638"},"user_tz":-540},"id":"2LnK3tHWpN50","outputId":"f7ef163d-b988-4689-b7c7-64ce2116af02"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-d96da5bf-27f9-4914-8158-75513fc05d99\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010102</td>\n","      <td>일용잡화</td>\n","      <td>휴지류</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010104</td>\n","      <td>일용잡화</td>\n","      <td>일용잡화</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>A</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010105</td>\n","      <td>일용잡화</td>\n","      <td>세트상품</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4381</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>D080204</td>\n","      <td>아이메이크업</td>\n","      <td>아이섀도우</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>4382</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>D080205</td>\n","      <td>아이메이크업</td>\n","      <td>메이크업세트</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>4383</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080301</td>\n","      <td>립메이크업</td>\n","      <td>립스틱/립라이너</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>4384</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","    </tr>\n","    <tr>\n","      <th>4385</th>\n","      <td>D</td>\n","      <td>8</td>\n","      <td>804</td>\n","      <td>D080401</td>\n","      <td>네일메이크업</td>\n","      <td>일반네일/케어류</td>\n","      <td>일상용품</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4386 rows × 7 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d96da5bf-27f9-4914-8158-75513fc05d99')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d96da5bf-27f9-4914-8158-75513fc05d99 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d96da5bf-27f9-4914-8158-75513fc05d99');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["     제휴사  대분류코드  중분류코드    소분류코드    중분류명      소분류명   대분류\n","0      A      1    101  A010101    일용잡화      위생세제  일상용품\n","1      A      1    101  A010102    일용잡화       휴지류  일상용품\n","2      A      1    101  A010103    일용잡화      뷰티상품  일상용품\n","3      A      1    101  A010104    일용잡화      일용잡화  일상용품\n","4      A      1    101  A010105    일용잡화      세트상품  일상용품\n","...   ..    ...    ...      ...     ...       ...   ...\n","4381   D      8    802  D080204  아이메이크업     아이섀도우  일상용품\n","4382   D      8    802  D080205  아이메이크업    메이크업세트  일상용품\n","4383   D      8    803  D080301   립메이크업  립스틱/립라이너  일상용품\n","4384   D      8    803  D080302   립메이크업   립글로즈/틴트  일상용품\n","4385   D      8    804  D080401  네일메이크업  일반네일/케어류  일상용품\n","\n","[4386 rows x 7 columns]"]},"execution_count":22,"metadata":{},"output_type":"execute_result"}],"source":["data_6"]},{"cell_type":"markdown","metadata":{"id":"Pb6EfavMXD0U"},"source":["### (5) 가격대별 분류"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eVH7vOtA_ZGa"},"outputs":[],"source":["# 고가 저가 중가 구분\n","def asdf(df):\n","  x1 = df[['대분류', '구매금액']]  \n","  d = df.groupby('대분류')[['구매금액']].mean().to_dict()['구매금액']\n","  df['기준'] =df['대분류'].map(d)  \n","  df['분류'] = df[['구매금액', '기준']].agg(lambda x : '고가' if x['구매금액'] > (2*x['기준']) \n","  else ('저가' if x['구매금액'] < (0.5*x['기준']) else '중가'), axis=1)   \n","  df.drop(columns='기준', inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"g2ifggmWggGs"},"outputs":[],"source":["asdf(total1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yqY_vXR5MBkQ"},"outputs":[],"source":["# 엑셀로 저장\n","total1.to_excel('/content/drive/MyDrive/KDT/2차프로젝트/total_final.csv')"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"elapsed":489,"status":"ok","timestamp":1671653721697,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"},"user_tz":-540},"id":"ZzkzK8fC7Sv9","outputId":"4590f2b6-d269-4b3d-90bd-0d82136cd9f5"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-645e65e6-d717-46fa-a7d4-08068e6c3d44\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>제휴사</th>\n","      <th>영수증번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>연도</th>\n","      <th>월</th>\n","      <th>연도_월</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>B</td>\n","      <td>8664000</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>17218</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>20</td>\n","      <td>2420</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>2014</td>\n","      <td>2</td>\n","      <td>201402</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>B</td>\n","      <td>8664007</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>11303</td>\n","      <td>44</td>\n","      <td>20140222</td>\n","      <td>13</td>\n","      <td>2400</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>2014</td>\n","      <td>2</td>\n","      <td>201402</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>B</td>\n","      <td>8919520</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>13210</td>\n","      <td>48</td>\n","      <td>20150921</td>\n","      <td>19</td>\n","      <td>5250</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>2015</td>\n","      <td>9</td>\n","      <td>201509</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>B</td>\n","      <td>6956422</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>13823</td>\n","      <td>12</td>\n","      <td>20140813</td>\n","      <td>18</td>\n","      <td>2250</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>2014</td>\n","      <td>8</td>\n","      <td>201408</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>B</td>\n","      <td>6957156</td>\n","      <td>15</td>\n","      <td>1504</td>\n","      <td>B150401</td>\n","      <td>18970</td>\n","      <td>12</td>\n","      <td>20140831</td>\n","      <td>22</td>\n","      <td>4900</td>\n","      <td>탄산음료</td>\n","      <td>사이다</td>\n","      <td>2014</td>\n","      <td>8</td>\n","      <td>201408</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>B</td>\n","      <td>7269975</td>\n","      <td>14</td>\n","      <td>1415</td>\n","      <td>B141503</td>\n","      <td>134</td>\n","      <td>16</td>\n","      <td>20141130</td>\n","      <td>15</td>\n","      <td>8900</td>\n","      <td>전통과자</td>\n","      <td>온라인팥빙수재료</td>\n","      <td>2014</td>\n","      <td>11</td>\n","      <td>201411</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>B</td>\n","      <td>7946814</td>\n","      <td>68</td>\n","      <td>6802</td>\n","      <td>B680209</td>\n","      <td>18484</td>\n","      <td>26</td>\n","      <td>20141227</td>\n","      <td>14</td>\n","      <td>1000</td>\n","      <td>여성양말</td>\n","      <td>여성발가락</td>\n","      <td>2014</td>\n","      <td>12</td>\n","      <td>201412</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>B</td>\n","      <td>7777110</td>\n","      <td>7</td>\n","      <td>702</td>\n","      <td>B070203</td>\n","      <td>5043</td>\n","      <td>21</td>\n","      <td>20151012</td>\n","      <td>22</td>\n","      <td>4510</td>\n","      <td>즉석구이안주</td>\n","      <td>즉석쥐포</td>\n","      <td>2015</td>\n","      <td>10</td>\n","      <td>201510</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>B</td>\n","      <td>7579178</td>\n","      <td>7</td>\n","      <td>703</td>\n","      <td>B070305</td>\n","      <td>4073</td>\n","      <td>18</td>\n","      <td>20140125</td>\n","      <td>20</td>\n","      <td>8900</td>\n","      <td>마른안주</td>\n","      <td>온라인 안주</td>\n","      <td>2014</td>\n","      <td>1</td>\n","      <td>201401</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>B</td>\n","      <td>8123279</td>\n","      <td>36</td>\n","      <td>3607</td>\n","      <td>B360704</td>\n","      <td>11509</td>\n","      <td>29</td>\n","      <td>20150821</td>\n","      <td>13</td>\n","      <td>2800</td>\n","      <td>시니어건강용품</td>\n","      <td>침실용품</td>\n","      <td>2015</td>\n","      <td>8</td>\n","      <td>201508</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 15 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-645e65e6-d717-46fa-a7d4-08068e6c3d44')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-645e65e6-d717-46fa-a7d4-08068e6c3d44 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-645e65e6-d717-46fa-a7d4-08068e6c3d44');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["         제휴사    영수증번호  대분류코드  중분류코드    소분류코드   고객번호  점포코드      구매일자  구매시간  \\\n","0          B  8664000     15   1504  B150401  17218    44  20140222    20   \n","1          B  8664007     15   1504  B150401  11303    44  20140222    13   \n","2          B  8919520     15   1504  B150401  13210    48  20150921    19   \n","3          B  6956422     15   1504  B150401  13823    12  20140813    18   \n","4          B  6957156     15   1504  B150401  18970    12  20140831    22   \n","...       ..      ...    ...    ...      ...    ...   ...       ...   ...   \n","28593025   B  7269975     14   1415  B141503    134    16  20141130    15   \n","28593026   B  7946814     68   6802  B680209  18484    26  20141227    14   \n","28593027   B  7777110      7    702  B070203   5043    21  20151012    22   \n","28593028   B  7579178      7    703  B070305   4073    18  20140125    20   \n","28593029   B  8123279     36   3607  B360704  11509    29  20150821    13   \n","\n","          구매금액     중분류명      소분류명    연도   월    연도_월  \n","0         2420     탄산음료       사이다  2014   2  201402  \n","1         2400     탄산음료       사이다  2014   2  201402  \n","2         5250     탄산음료       사이다  2015   9  201509  \n","3         2250     탄산음료       사이다  2014   8  201408  \n","4         4900     탄산음료       사이다  2014   8  201408  \n","...        ...      ...       ...   ...  ..     ...  \n","28593025  8900     전통과자  온라인팥빙수재료  2014  11  201411  \n","28593026  1000     여성양말     여성발가락  2014  12  201412  \n","28593027  4510   즉석구이안주      즉석쥐포  2015  10  201510  \n","28593028  8900     마른안주    온라인 안주  2014   1  201401  \n","28593029  2800  시니어건강용품      침실용품  2015   8  201508  \n","\n","[28593030 rows x 15 columns]"]},"execution_count":161,"metadata":{},"output_type":"execute_result"}],"source":["total1"]},{"cell_type":"markdown","metadata":{"id":"z1CH2Qf3Xc2S"},"source":["# #4. features 설정\n","\n","### 1.변동지수 \n","1) 카테고리별 구매빈도\n","\n","2) 카테고리별 구매금액\n","\n","3) 제휴사별 구매빈도\n","\n","4) 제휴사별 구매금액\n","\n","5) 금액별 구매 빈도\n","\n","6) 분기별 총 구매금액\n","\n","###2. 속성변수 (정적변수)\n","#### total 데이터\n","1) 성별 \n","\n","2) 거주지 \n","\n","3) 연령대 \n","\n","#### rfm_df 데이터\n","1) 최근 방문 일자\n","\n","2) 총 구매횟수\n","\n","3) 총 구매금액\n","\n","#### total_att_train/test 데이터\n","\n","1) 멤버십 가입유무 \n","\n","2) 온라인 이용 유무 \n","\n","3) 경쟁사 이용 횟수 \n","\n","4) 주말 방문 구매액 비중 \n","\n","5) 카테고리가 총 구매에서 차지하는 비중\n","\n","* 식품 : 가공식품, 신선식품\n","* 패션 : 의류, 패션잡화\n","* 취미 : 교육/문화용품, 전문스포츠/레저\n","* 주거 : 가구/인테리어, 디지털/가전"]},{"cell_type":"markdown","metadata":{"id":"VmsOf3AKee_t"},"source":["## 1) 변동지수"]},{"cell_type":"markdown","source":["### (1) 카테고리별 구매금액"],"metadata":{"id":"g23rqnwN5Ahb"}},{"cell_type":"code","source":["total_rank1 = total.pivot_table('구매금액', '고객번호', ['대분류', '분기'], aggfunc='sum').fillna(0).rank(ascending=False, method='first').astype('int') \n","total_rank1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"id":"tFfZYEi2qzhp","executionInfo":{"status":"ok","timestamp":1672377071294,"user_tz":-540,"elapsed":4615,"user":{"displayName":"김희진","userId":"08208273043312286751"}},"outputId":"5a6df972-5c9a-470b-c3a8-ba8f97b322e7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류     가공식품                                                  가구/인테리어         \\\n","분기         1      2      3      4      5      6      7      8       1      2   \n","고객번호                                                                           \n","1       1763    414   4742   2586   1609   4612  11528  13559    2205   1933   \n","2        618    531   1875   1879   1689   6426   3547   1859    2206   1934   \n","3      17627  16877  17144  17865  18758  18516  18310  18381    2207   1935   \n","4       9229   5171  11060  15433   7203   8189   9546   9549    2208   1936   \n","5       1756   2538   5259  15718   4513   8242  19260   1941    2209   1937   \n","...      ...    ...    ...    ...    ...    ...    ...    ...     ...    ...   \n","19379  19379  19379  19075  18862  18855  18734  18916  17900   19379  19379   \n","19380  19380  19380  19380  19178  18836  19100  18933  15846   19380  19380   \n","19381  19381  19381  19381  19381  17931  14175   6444  10826   19381  19381   \n","19382  19382  19382  19382  19382  16981  13200  11510   9496   19382  19382   \n","19383  19383  19383  19383  19383  19383  19255  18371  17815   19383  19383   \n","\n","대분류    ... 전문스포츠/레저          패션잡화                                            \\\n","분기     ...        7      8      1      2      3      4      5      6      7   \n","고객번호   ...                                                                    \n","1      ...     2834   3042   1348    908   1177   1687    962    714   1462   \n","2      ...     2835   3043  11726  14112   5296   7642  13964   8419   2468   \n","3      ...     2836   3044  13211  14113  13920  14728  13965  14820  14458   \n","4      ...      980   3045   9464   6058   3975   7329   7465   9947   7753   \n","5      ...     2837   3046   8292  11354  13921  14729  13966  14821  14459   \n","...    ...      ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  ...    19380   1139  19379  19379  19379  19379   6835  12286  12024   \n","19380  ...    19381  19382  19380  19380  19380  19380  19382  19381  19383   \n","19381  ...     1616   1140  19381  19381  19381  19381  11877  13759  12666   \n","19382  ...    19382    819  19382  19382  19382  19382  10339  19382  11639   \n","19383  ...    19383  19383  19383  19383  19383  19383  19383  19383   7991   \n","\n","대분류           \n","분기         8  \n","고객번호          \n","1       1225  \n","2       5770  \n","3      14572  \n","4       6079  \n","5      10118  \n","...      ...  \n","19379   7710  \n","19380  19383  \n","19381  14507  \n","19382  12702  \n","19383   6698  \n","\n","[19383 rows x 96 columns]"],"text/html":["\n","  <div id=\"df-8bb3788b-6e2b-4eac-8322-18e49b6c3caf\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>대분류</th>\n","      <th colspan=\"8\" halign=\"left\">가공식품</th>\n","      <th colspan=\"2\" halign=\"left\">가구/인테리어</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">전문스포츠/레저</th>\n","      <th colspan=\"8\" halign=\"left\">패션잡화</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>1763</td>\n","      <td>414</td>\n","      <td>4742</td>\n","      <td>2586</td>\n","      <td>1609</td>\n","      <td>4612</td>\n","      <td>11528</td>\n","      <td>13559</td>\n","      <td>2205</td>\n","      <td>1933</td>\n","      <td>...</td>\n","      <td>2834</td>\n","      <td>3042</td>\n","      <td>1348</td>\n","      <td>908</td>\n","      <td>1177</td>\n","      <td>1687</td>\n","      <td>962</td>\n","      <td>714</td>\n","      <td>1462</td>\n","      <td>1225</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>618</td>\n","      <td>531</td>\n","      <td>1875</td>\n","      <td>1879</td>\n","      <td>1689</td>\n","      <td>6426</td>\n","      <td>3547</td>\n","      <td>1859</td>\n","      <td>2206</td>\n","      <td>1934</td>\n","      <td>...</td>\n","      <td>2835</td>\n","      <td>3043</td>\n","      <td>11726</td>\n","      <td>14112</td>\n","      <td>5296</td>\n","      <td>7642</td>\n","      <td>13964</td>\n","      <td>8419</td>\n","      <td>2468</td>\n","      <td>5770</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>17627</td>\n","      <td>16877</td>\n","      <td>17144</td>\n","      <td>17865</td>\n","      <td>18758</td>\n","      <td>18516</td>\n","      <td>18310</td>\n","      <td>18381</td>\n","      <td>2207</td>\n","      <td>1935</td>\n","      <td>...</td>\n","      <td>2836</td>\n","      <td>3044</td>\n","      <td>13211</td>\n","      <td>14113</td>\n","      <td>13920</td>\n","      <td>14728</td>\n","      <td>13965</td>\n","      <td>14820</td>\n","      <td>14458</td>\n","      <td>14572</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>9229</td>\n","      <td>5171</td>\n","      <td>11060</td>\n","      <td>15433</td>\n","      <td>7203</td>\n","      <td>8189</td>\n","      <td>9546</td>\n","      <td>9549</td>\n","      <td>2208</td>\n","      <td>1936</td>\n","      <td>...</td>\n","      <td>980</td>\n","      <td>3045</td>\n","      <td>9464</td>\n","      <td>6058</td>\n","      <td>3975</td>\n","      <td>7329</td>\n","      <td>7465</td>\n","      <td>9947</td>\n","      <td>7753</td>\n","      <td>6079</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>1756</td>\n","      <td>2538</td>\n","      <td>5259</td>\n","      <td>15718</td>\n","      <td>4513</td>\n","      <td>8242</td>\n","      <td>19260</td>\n","      <td>1941</td>\n","      <td>2209</td>\n","      <td>1937</td>\n","      <td>...</td>\n","      <td>2837</td>\n","      <td>3046</td>\n","      <td>8292</td>\n","      <td>11354</td>\n","      <td>13921</td>\n","      <td>14729</td>\n","      <td>13966</td>\n","      <td>14821</td>\n","      <td>14459</td>\n","      <td>10118</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>19075</td>\n","      <td>18862</td>\n","      <td>18855</td>\n","      <td>18734</td>\n","      <td>18916</td>\n","      <td>17900</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>...</td>\n","      <td>19380</td>\n","      <td>1139</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>6835</td>\n","      <td>12286</td>\n","      <td>12024</td>\n","      <td>7710</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19178</td>\n","      <td>18836</td>\n","      <td>19100</td>\n","      <td>18933</td>\n","      <td>15846</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>...</td>\n","      <td>19381</td>\n","      <td>19382</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19382</td>\n","      <td>19381</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>17931</td>\n","      <td>14175</td>\n","      <td>6444</td>\n","      <td>10826</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>...</td>\n","      <td>1616</td>\n","      <td>1140</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>11877</td>\n","      <td>13759</td>\n","      <td>12666</td>\n","      <td>14507</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>16981</td>\n","      <td>13200</td>\n","      <td>11510</td>\n","      <td>9496</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>...</td>\n","      <td>19382</td>\n","      <td>819</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>10339</td>\n","      <td>19382</td>\n","      <td>11639</td>\n","      <td>12702</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19255</td>\n","      <td>18371</td>\n","      <td>17815</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>7991</td>\n","      <td>6698</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 96 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8bb3788b-6e2b-4eac-8322-18e49b6c3caf')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8bb3788b-6e2b-4eac-8322-18e49b6c3caf button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8bb3788b-6e2b-4eac-8322-18e49b6c3caf');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["total_rank1.to_excel(\"/content/drive/MyDrive/2차 프로젝트/카테고리별 구매금액.xlsx\")"],"metadata":{"id":"NqpaTGcodPPR"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### (2) 카테고리별 구매빈도"],"metadata":{"id":"Ff0NuT7m5GYH"}},{"cell_type":"code","source":["total_rank2 = total.pivot_table('영수증번호', '고객번호', ['대분류', '분기'], aggfunc='count').fillna(0).rank(ascending=False, method='max').astype('int') \n","total_rank2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"id":"pidCXDzutwN0","executionInfo":{"status":"ok","timestamp":1672382632420,"user_tz":-540,"elapsed":4178,"user":{"displayName":"김희진","userId":"08208273043312286751"}},"outputId":"3647a5cd-17a8-41ad-f609-025a3e27fb5c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류     가공식품                                                  가구/인테리어         \\\n","분기         1      2      3      4      5      6      7      8       1      2   \n","고객번호                                                                           \n","1      10817  12958  11497   6079   7977  10146  17589  16084   19383  19383   \n","2       4186   7278   9825   7880  10486  14368  12827  10083   19383  19383   \n","3       7799   5045   3754   7242  14176   9619  10663  13041   19383  19383   \n","4      10817   6821  15268  15510   8370   9122  10927  11277   19383  19383   \n","5       2338   2684   8830  18483   9454  17853  19383  10223   19383  19383   \n","...      ...    ...    ...    ...    ...    ...    ...    ...     ...    ...   \n","19379  19383  19383  19006  17934  15659  15476  14099  14165   19383  19383   \n","19380  19383  19383  19383  19114  15945  18334  18396   2212   19383  19383   \n","19381  19383  19383  19383  19383  13682   8869   8326   8252   19383  19383   \n","19382  19383  19383  19383  19383  10894   9344   6625   3863   19383  19383   \n","19383  19383  19383  19383  19383  19383  19193  13109  13223   19383  19383   \n","\n","대분류    ... 전문스포츠/레저          패션잡화                                            \\\n","분기     ...        7      8      1      2      3      4      5      6      7   \n","고객번호   ...                                                                    \n","1      ...    19383  19383   4646   3432   2319   5279   1992   1733   2057   \n","2      ...    19383  19383  13210  19383   9361  14727  19383  10700   5770   \n","3      ...    19383  19383  19383  19383  19383  19383  19383  19383  19383   \n","4      ...     2833  19383   8315   5307   2731   8682  11169   9109   8221   \n","5      ...    19383  19383  10402  11727  19383  19383  19383  19383  19383   \n","...    ...      ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  ...    19383   1298  19383  19383  19383  19383   9034  14819   9925   \n","19380  ...    19383  19383  19383  19383  19383  19383  19383  19383  19383   \n","19381  ...     2833   1298  19383  19383  19383  19383   7403  12574   9925   \n","19382  ...    19383    534  19383  19383  19383  19383   7403  19383   6898   \n","19383  ...    19383  19383  19383  19383  19383  19383  19383  19383   8221   \n","\n","대분류           \n","분기         8  \n","고객번호          \n","1       1935  \n","2       7198  \n","3      19383  \n","4       4292  \n","5      14571  \n","...      ...  \n","19379  10121  \n","19380  19383  \n","19381  14571  \n","19382   8547  \n","19383  10121  \n","\n","[19383 rows x 96 columns]"],"text/html":["\n","  <div id=\"df-50ee3d32-b984-48eb-9914-22e00de10acb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>대분류</th>\n","      <th colspan=\"8\" halign=\"left\">가공식품</th>\n","      <th colspan=\"2\" halign=\"left\">가구/인테리어</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">전문스포츠/레저</th>\n","      <th colspan=\"8\" halign=\"left\">패션잡화</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>10817</td>\n","      <td>12958</td>\n","      <td>11497</td>\n","      <td>6079</td>\n","      <td>7977</td>\n","      <td>10146</td>\n","      <td>17589</td>\n","      <td>16084</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>4646</td>\n","      <td>3432</td>\n","      <td>2319</td>\n","      <td>5279</td>\n","      <td>1992</td>\n","      <td>1733</td>\n","      <td>2057</td>\n","      <td>1935</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>4186</td>\n","      <td>7278</td>\n","      <td>9825</td>\n","      <td>7880</td>\n","      <td>10486</td>\n","      <td>14368</td>\n","      <td>12827</td>\n","      <td>10083</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>13210</td>\n","      <td>19383</td>\n","      <td>9361</td>\n","      <td>14727</td>\n","      <td>19383</td>\n","      <td>10700</td>\n","      <td>5770</td>\n","      <td>7198</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>7799</td>\n","      <td>5045</td>\n","      <td>3754</td>\n","      <td>7242</td>\n","      <td>14176</td>\n","      <td>9619</td>\n","      <td>10663</td>\n","      <td>13041</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>10817</td>\n","      <td>6821</td>\n","      <td>15268</td>\n","      <td>15510</td>\n","      <td>8370</td>\n","      <td>9122</td>\n","      <td>10927</td>\n","      <td>11277</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>2833</td>\n","      <td>19383</td>\n","      <td>8315</td>\n","      <td>5307</td>\n","      <td>2731</td>\n","      <td>8682</td>\n","      <td>11169</td>\n","      <td>9109</td>\n","      <td>8221</td>\n","      <td>4292</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>2338</td>\n","      <td>2684</td>\n","      <td>8830</td>\n","      <td>18483</td>\n","      <td>9454</td>\n","      <td>17853</td>\n","      <td>19383</td>\n","      <td>10223</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>10402</td>\n","      <td>11727</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>14571</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19006</td>\n","      <td>17934</td>\n","      <td>15659</td>\n","      <td>15476</td>\n","      <td>14099</td>\n","      <td>14165</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>1298</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>9034</td>\n","      <td>14819</td>\n","      <td>9925</td>\n","      <td>10121</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19114</td>\n","      <td>15945</td>\n","      <td>18334</td>\n","      <td>18396</td>\n","      <td>2212</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>13682</td>\n","      <td>8869</td>\n","      <td>8326</td>\n","      <td>8252</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>2833</td>\n","      <td>1298</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>7403</td>\n","      <td>12574</td>\n","      <td>9925</td>\n","      <td>14571</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>10894</td>\n","      <td>9344</td>\n","      <td>6625</td>\n","      <td>3863</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>534</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>7403</td>\n","      <td>19383</td>\n","      <td>6898</td>\n","      <td>8547</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19193</td>\n","      <td>13109</td>\n","      <td>13223</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>8221</td>\n","      <td>10121</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 96 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-50ee3d32-b984-48eb-9914-22e00de10acb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-50ee3d32-b984-48eb-9914-22e00de10acb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-50ee3d32-b984-48eb-9914-22e00de10acb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["total_rank2.to_excel(\"/content/drive/MyDrive/2차 프로젝트/카테고리별 구매빈도.xlsx\")"],"metadata":{"id":"-f1MEBbexb8h"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### (3) 제휴사별 구매금액"],"metadata":{"id":"6q13LpEQ5Nqp"}},{"cell_type":"code","source":["total_rank3 = total.pivot_table('구매금액', '고객번호', ['제휴사', '분기'], aggfunc='sum').fillna(0).rank(ascending=False, method='first').astype('int') \n","total_rank3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"id":"2pwBpcTbvzPA","executionInfo":{"status":"ok","timestamp":1672377471616,"user_tz":-540,"elapsed":3983,"user":{"displayName":"김희진","userId":"08208273043312286751"}},"outputId":"a1f132d4-345d-4fc9-e009-6f57593003b4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["제휴사        A                                                       B         \\\n","분기         1      2      3      4      5      6      7      8      1      2   \n","고객번호                                                                          \n","1       1737   1480   1166    506   1955   2242   2107   4307  13061  13636   \n","2        853   1563    604   3309    587   1993    836   1804  12779  13637   \n","3      13857  12451  13999  14743  14571  14570  14403  14882  13756  13638   \n","4       7667   5150   6200   8008   7377   7626   7202   8334  13757  11483   \n","5       5088   6390   6751  10789   6587   9095  14404   6378  13268  13639   \n","...      ...    ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  19379  19379  19379  10479  10399  10834  13435   9278  19379  19379   \n","19380  19380  19380  19380  19380  19382  19381  19382  13650  19380  19380   \n","19381  19381  19381  19381  19381  10774  19382  13603  13740  19381  19381   \n","19382  19382  19382  19382  19382  13307  12244  19383  19383  19382  19382   \n","19383  19383  19383  19383  19383  19383  19383   9362  10271  19383  19383   \n","\n","제휴사    ...      C             D                                            \\\n","분기     ...      7      8      1      2      3      4      5      6      7   \n","고객번호   ...                                                                  \n","1      ...  10086   5466    448    619    699    869   1168   1334   1653   \n","2      ...  10272   9966    449    620    700    870   1169    223    594   \n","3      ...   4140   4497    450    621    701    871   1170   1335   1654   \n","4      ...   5737   5538    451    622    702    872   1171   1336   1655   \n","5      ...  10273   9967    452    623    703    873    894   1055   1656   \n","...    ...    ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  ...  19382  19382  19379  19379    163     49     42     24     32   \n","19380  ...   7084   5592  19380  19380  19380     64     74    124    137   \n","19381  ...   9198   8335  19381  19381  19381  19381  19381  19382  19382   \n","19382  ...  19383   9066  19382  19382  19382  19382  19382  19383  19383   \n","19383  ...   9194  19383  19383  19383  19383  19383  19383    711     79   \n","\n","제휴사           \n","분기         8  \n","고객번호          \n","1       1745  \n","2       1746  \n","3       1747  \n","4       1748  \n","5        786  \n","...      ...  \n","19379     60  \n","19380      1  \n","19381  19382  \n","19382  19383  \n","19383     35  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-aa856c5e-360f-4725-9827-beb409222d32\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>제휴사</th>\n","      <th colspan=\"8\" halign=\"left\">A</th>\n","      <th colspan=\"2\" halign=\"left\">B</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">C</th>\n","      <th colspan=\"8\" halign=\"left\">D</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>1737</td>\n","      <td>1480</td>\n","      <td>1166</td>\n","      <td>506</td>\n","      <td>1955</td>\n","      <td>2242</td>\n","      <td>2107</td>\n","      <td>4307</td>\n","      <td>13061</td>\n","      <td>13636</td>\n","      <td>...</td>\n","      <td>10086</td>\n","      <td>5466</td>\n","      <td>448</td>\n","      <td>619</td>\n","      <td>699</td>\n","      <td>869</td>\n","      <td>1168</td>\n","      <td>1334</td>\n","      <td>1653</td>\n","      <td>1745</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>853</td>\n","      <td>1563</td>\n","      <td>604</td>\n","      <td>3309</td>\n","      <td>587</td>\n","      <td>1993</td>\n","      <td>836</td>\n","      <td>1804</td>\n","      <td>12779</td>\n","      <td>13637</td>\n","      <td>...</td>\n","      <td>10272</td>\n","      <td>9966</td>\n","      <td>449</td>\n","      <td>620</td>\n","      <td>700</td>\n","      <td>870</td>\n","      <td>1169</td>\n","      <td>223</td>\n","      <td>594</td>\n","      <td>1746</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>13857</td>\n","      <td>12451</td>\n","      <td>13999</td>\n","      <td>14743</td>\n","      <td>14571</td>\n","      <td>14570</td>\n","      <td>14403</td>\n","      <td>14882</td>\n","      <td>13756</td>\n","      <td>13638</td>\n","      <td>...</td>\n","      <td>4140</td>\n","      <td>4497</td>\n","      <td>450</td>\n","      <td>621</td>\n","      <td>701</td>\n","      <td>871</td>\n","      <td>1170</td>\n","      <td>1335</td>\n","      <td>1654</td>\n","      <td>1747</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>7667</td>\n","      <td>5150</td>\n","      <td>6200</td>\n","      <td>8008</td>\n","      <td>7377</td>\n","      <td>7626</td>\n","      <td>7202</td>\n","      <td>8334</td>\n","      <td>13757</td>\n","      <td>11483</td>\n","      <td>...</td>\n","      <td>5737</td>\n","      <td>5538</td>\n","      <td>451</td>\n","      <td>622</td>\n","      <td>702</td>\n","      <td>872</td>\n","      <td>1171</td>\n","      <td>1336</td>\n","      <td>1655</td>\n","      <td>1748</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>5088</td>\n","      <td>6390</td>\n","      <td>6751</td>\n","      <td>10789</td>\n","      <td>6587</td>\n","      <td>9095</td>\n","      <td>14404</td>\n","      <td>6378</td>\n","      <td>13268</td>\n","      <td>13639</td>\n","      <td>...</td>\n","      <td>10273</td>\n","      <td>9967</td>\n","      <td>452</td>\n","      <td>623</td>\n","      <td>703</td>\n","      <td>873</td>\n","      <td>894</td>\n","      <td>1055</td>\n","      <td>1656</td>\n","      <td>786</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>10479</td>\n","      <td>10399</td>\n","      <td>10834</td>\n","      <td>13435</td>\n","      <td>9278</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>...</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>163</td>\n","      <td>49</td>\n","      <td>42</td>\n","      <td>24</td>\n","      <td>32</td>\n","      <td>60</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19382</td>\n","      <td>19381</td>\n","      <td>19382</td>\n","      <td>13650</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>...</td>\n","      <td>7084</td>\n","      <td>5592</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>64</td>\n","      <td>74</td>\n","      <td>124</td>\n","      <td>137</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>10774</td>\n","      <td>19382</td>\n","      <td>13603</td>\n","      <td>13740</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>...</td>\n","      <td>9198</td>\n","      <td>8335</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>13307</td>\n","      <td>12244</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>9066</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>9362</td>\n","      <td>10271</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>9194</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>711</td>\n","      <td>79</td>\n","      <td>35</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aa856c5e-360f-4725-9827-beb409222d32')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-aa856c5e-360f-4725-9827-beb409222d32 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-aa856c5e-360f-4725-9827-beb409222d32');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["total_rank3.to_excel(\"/content/drive/MyDrive/2차 프로젝트/제휴사별 구매금액.xlsx\")"],"metadata":{"id":"0Xn-QvLHqD34"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### (4) 제휴사별 구매빈도"],"metadata":{"id":"RO1OsZh95Q_C"}},{"cell_type":"code","source":["total_rank4 = total.pivot_table('영수증번호', '고객번호', ['제휴사', '분기'], aggfunc='count').fillna(0).rank(ascending=False, method='first').astype('int') \n","total_rank4"],"metadata":{"id":"IHxm6Exr6UiX","colab":{"base_uri":"https://localhost:8080/","height":486},"executionInfo":{"status":"ok","timestamp":1672381640993,"user_tz":-540,"elapsed":3560,"user":{"displayName":"김희진","userId":"08208273043312286751"}},"outputId":"882b51d7-ffad-4c90-d62e-962d446f13af"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["제휴사        A                                                       B         \\\n","분기         1      2      3      4      5      6      7      8      1      2   \n","고객번호                                                                          \n","1        845   1792    739    508    462   2093   5133   5748  13286  13636   \n","2        104    432    533   1024    429   2579    908   1123  13287  13637   \n","3      13857  12922  13999  14743  14571  14570  14403  14882  13756  13638   \n","4       2826   1323   5888   7525   1839   3486   3722   4065  13757  10396   \n","5        105    113   1404   8744   2380   8377  14404   3173  13288  13639   \n","...      ...    ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  19379  19379  19379  10943  10136  11783  13220   9329  19379  19379   \n","19380  19380  19380  19380  19380  19382  19381  19382  12655  19380  19380   \n","19381  19381  19381  19381  19381  13228  19382  13221  14881  19381  19381   \n","19382  19382  19382  19382  19382  14570  12442  19383  19383  19382  19382   \n","19383  19383  19383  19383  19383  19383  19383   9603  10627  19383  19383   \n","\n","제휴사    ...      C             D                                            \\\n","분기     ...      7      8      1      2      3      4      5      6      7   \n","고객번호   ...                                                                  \n","1      ...   9688   6396    448    619    699    869   1168   1334   1653   \n","2      ...  10272   9966    449    620    700    870   1169    254    510   \n","3      ...   3713   3985    450    621    701    871   1170   1335   1654   \n","4      ...   6336   5708    451    622    702    872   1171   1336   1655   \n","5      ...  10273   9967    452    623    703    873    645    756   1656   \n","...    ...    ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  ...  19382  19382  19379  19379    184     47     13     23     30   \n","19380  ...   7518   5158  19380  19380  19380    208     68    142    138   \n","19381  ...   9109   7834  19381  19381  19381  19381  19381  19382  19382   \n","19382  ...  19383   8858  19382  19382  19382  19382  19382  19383  19383   \n","19383  ...   9110  19383  19383  19383  19383  19383  19383    547     40   \n","\n","제휴사           \n","분기         8  \n","고객번호          \n","1       1745  \n","2       1746  \n","3       1747  \n","4       1748  \n","5        733  \n","...      ...  \n","19379     46  \n","19380      1  \n","19381  19382  \n","19382  19383  \n","19383     23  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-74e0ba07-79b7-4c22-8d53-dbbb7673979b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>제휴사</th>\n","      <th colspan=\"8\" halign=\"left\">A</th>\n","      <th colspan=\"2\" halign=\"left\">B</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">C</th>\n","      <th colspan=\"8\" halign=\"left\">D</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>845</td>\n","      <td>1792</td>\n","      <td>739</td>\n","      <td>508</td>\n","      <td>462</td>\n","      <td>2093</td>\n","      <td>5133</td>\n","      <td>5748</td>\n","      <td>13286</td>\n","      <td>13636</td>\n","      <td>...</td>\n","      <td>9688</td>\n","      <td>6396</td>\n","      <td>448</td>\n","      <td>619</td>\n","      <td>699</td>\n","      <td>869</td>\n","      <td>1168</td>\n","      <td>1334</td>\n","      <td>1653</td>\n","      <td>1745</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>104</td>\n","      <td>432</td>\n","      <td>533</td>\n","      <td>1024</td>\n","      <td>429</td>\n","      <td>2579</td>\n","      <td>908</td>\n","      <td>1123</td>\n","      <td>13287</td>\n","      <td>13637</td>\n","      <td>...</td>\n","      <td>10272</td>\n","      <td>9966</td>\n","      <td>449</td>\n","      <td>620</td>\n","      <td>700</td>\n","      <td>870</td>\n","      <td>1169</td>\n","      <td>254</td>\n","      <td>510</td>\n","      <td>1746</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>13857</td>\n","      <td>12922</td>\n","      <td>13999</td>\n","      <td>14743</td>\n","      <td>14571</td>\n","      <td>14570</td>\n","      <td>14403</td>\n","      <td>14882</td>\n","      <td>13756</td>\n","      <td>13638</td>\n","      <td>...</td>\n","      <td>3713</td>\n","      <td>3985</td>\n","      <td>450</td>\n","      <td>621</td>\n","      <td>701</td>\n","      <td>871</td>\n","      <td>1170</td>\n","      <td>1335</td>\n","      <td>1654</td>\n","      <td>1747</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2826</td>\n","      <td>1323</td>\n","      <td>5888</td>\n","      <td>7525</td>\n","      <td>1839</td>\n","      <td>3486</td>\n","      <td>3722</td>\n","      <td>4065</td>\n","      <td>13757</td>\n","      <td>10396</td>\n","      <td>...</td>\n","      <td>6336</td>\n","      <td>5708</td>\n","      <td>451</td>\n","      <td>622</td>\n","      <td>702</td>\n","      <td>872</td>\n","      <td>1171</td>\n","      <td>1336</td>\n","      <td>1655</td>\n","      <td>1748</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>105</td>\n","      <td>113</td>\n","      <td>1404</td>\n","      <td>8744</td>\n","      <td>2380</td>\n","      <td>8377</td>\n","      <td>14404</td>\n","      <td>3173</td>\n","      <td>13288</td>\n","      <td>13639</td>\n","      <td>...</td>\n","      <td>10273</td>\n","      <td>9967</td>\n","      <td>452</td>\n","      <td>623</td>\n","      <td>703</td>\n","      <td>873</td>\n","      <td>645</td>\n","      <td>756</td>\n","      <td>1656</td>\n","      <td>733</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>10943</td>\n","      <td>10136</td>\n","      <td>11783</td>\n","      <td>13220</td>\n","      <td>9329</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>...</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19379</td>\n","      <td>19379</td>\n","      <td>184</td>\n","      <td>47</td>\n","      <td>13</td>\n","      <td>23</td>\n","      <td>30</td>\n","      <td>46</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19382</td>\n","      <td>19381</td>\n","      <td>19382</td>\n","      <td>12655</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>...</td>\n","      <td>7518</td>\n","      <td>5158</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>19380</td>\n","      <td>208</td>\n","      <td>68</td>\n","      <td>142</td>\n","      <td>138</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>13228</td>\n","      <td>19382</td>\n","      <td>13221</td>\n","      <td>14881</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>...</td>\n","      <td>9109</td>\n","      <td>7834</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19381</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>14570</td>\n","      <td>12442</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>8858</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19382</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>9603</td>\n","      <td>10627</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>9110</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>547</td>\n","      <td>40</td>\n","      <td>23</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-74e0ba07-79b7-4c22-8d53-dbbb7673979b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-74e0ba07-79b7-4c22-8d53-dbbb7673979b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-74e0ba07-79b7-4c22-8d53-dbbb7673979b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["total_rank4.to_excel(\"/content/drive/MyDrive/2차 프로젝트/제휴사별 구매빈도.xlsx\")"],"metadata":{"id":"coRa9GhJtqDS"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### (5) 금액별 구매빈도"],"metadata":{"id":"sppNHqo-5I4K"}},{"cell_type":"code","source":["total_rank5 = total.pivot_table('영수증번호', '고객번호', ['분류', '분기'], aggfunc='count').fillna(0).rank(ascending=False, method='max').astype('int') \n","total_rank5"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"id":"ATo5P2P54THF","executionInfo":{"status":"ok","timestamp":1672377093441,"user_tz":-540,"elapsed":4033,"user":{"displayName":"김희진","userId":"08208273043312286751"}},"outputId":"9009c03f-a209-42d1-c8c9-a8350a1be794"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["분류        고가                                                      저가         \\\n","분기         1      2      3      4      5      6      7      8      1      2   \n","고객번호                                                                          \n","1        671    711   3403    251   1670   2706   4434   9166  13798  16196   \n","2        127    248    109   1495    154   2487    590    587  14961  14648   \n","3      16608  17728  16374  18133  18200  18779  17578  19383   6870   3449   \n","4      15629   5753  10905  14761  11533  11657   9031  10528  13952  10297   \n","5       3706   7667   7360  15654   9983  12471  19383   4384  12690   9978   \n","...      ...    ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  19383  19383  18686  17368  18804  18779  19383  17147  19383  19383   \n","19380  19383  19383  19383  18133  19383  19383  18808  16337  19383  19383   \n","19381  19383  19383  19383  19383  14091   4674   6633   7433  19383  19383   \n","19382  19383  19383  19383  19383  14976  16642  13633  12019  19383  19383   \n","19383  19383  19383  19383  19383  19383  19383  16896  18711  19383  19383   \n","\n","분류     ...                   중가                                            \\\n","분기     ...      7      8      1      2      3      4      5      6      7   \n","고객번호   ...                                                                  \n","1      ...  17322  15498  11257  11094   4541   2975   3334   8238  16401   \n","2      ...  16350  16694   1933   7326  10182   7683  10551  12209  10625   \n","3      ...   8698  10632  17473  17939  14899  18224  18743  18394  17357   \n","4      ...  13319  13472   8417   4214  13144  13712   7506   7778  11404   \n","5      ...  19383  15498    865   2322   9931  18620   9537  18672  19383   \n","...    ...    ...    ...    ...    ...    ...    ...    ...    ...    ...   \n","19379  ...   9000   9223  19383  19383  19131  18322  18561  18394  18626   \n","19380  ...  14781   2203  19383  19383  19383  18961  18561  18951  18830   \n","19381  ...   8009   7140  19383  19383  19383  19383  11660   3377   3223   \n","19382  ...   5968   2831  19383  19383  19383  19383  12797   6488   6485   \n","19383  ...   8856   8011  19383  19383  19383  19383  19383  19383  18699   \n","\n","분류            \n","분기         8  \n","고객번호          \n","1      14572  \n","2      10614  \n","3      17934  \n","4      10327  \n","5      14311  \n","...      ...  \n","19379  17807  \n","19380  10327  \n","19381   5771  \n","19382   5202  \n","19383  17537  \n","\n","[19383 rows x 24 columns]"],"text/html":["\n","  <div id=\"df-a10cdafd-7367-468b-bc6d-e72a2c214737\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>분류</th>\n","      <th colspan=\"8\" halign=\"left\">고가</th>\n","      <th colspan=\"5\" halign=\"left\">저가</th>\n","      <th colspan=\"8\" halign=\"left\">중가</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>671</td>\n","      <td>711</td>\n","      <td>3403</td>\n","      <td>251</td>\n","      <td>1670</td>\n","      <td>2706</td>\n","      <td>4434</td>\n","      <td>9166</td>\n","      <td>13798</td>\n","      <td>16196</td>\n","      <td>...</td>\n","      <td>17322</td>\n","      <td>15498</td>\n","      <td>11257</td>\n","      <td>11094</td>\n","      <td>4541</td>\n","      <td>2975</td>\n","      <td>3334</td>\n","      <td>8238</td>\n","      <td>16401</td>\n","      <td>14572</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>127</td>\n","      <td>248</td>\n","      <td>109</td>\n","      <td>1495</td>\n","      <td>154</td>\n","      <td>2487</td>\n","      <td>590</td>\n","      <td>587</td>\n","      <td>14961</td>\n","      <td>14648</td>\n","      <td>...</td>\n","      <td>16350</td>\n","      <td>16694</td>\n","      <td>1933</td>\n","      <td>7326</td>\n","      <td>10182</td>\n","      <td>7683</td>\n","      <td>10551</td>\n","      <td>12209</td>\n","      <td>10625</td>\n","      <td>10614</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>16608</td>\n","      <td>17728</td>\n","      <td>16374</td>\n","      <td>18133</td>\n","      <td>18200</td>\n","      <td>18779</td>\n","      <td>17578</td>\n","      <td>19383</td>\n","      <td>6870</td>\n","      <td>3449</td>\n","      <td>...</td>\n","      <td>8698</td>\n","      <td>10632</td>\n","      <td>17473</td>\n","      <td>17939</td>\n","      <td>14899</td>\n","      <td>18224</td>\n","      <td>18743</td>\n","      <td>18394</td>\n","      <td>17357</td>\n","      <td>17934</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>15629</td>\n","      <td>5753</td>\n","      <td>10905</td>\n","      <td>14761</td>\n","      <td>11533</td>\n","      <td>11657</td>\n","      <td>9031</td>\n","      <td>10528</td>\n","      <td>13952</td>\n","      <td>10297</td>\n","      <td>...</td>\n","      <td>13319</td>\n","      <td>13472</td>\n","      <td>8417</td>\n","      <td>4214</td>\n","      <td>13144</td>\n","      <td>13712</td>\n","      <td>7506</td>\n","      <td>7778</td>\n","      <td>11404</td>\n","      <td>10327</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>3706</td>\n","      <td>7667</td>\n","      <td>7360</td>\n","      <td>15654</td>\n","      <td>9983</td>\n","      <td>12471</td>\n","      <td>19383</td>\n","      <td>4384</td>\n","      <td>12690</td>\n","      <td>9978</td>\n","      <td>...</td>\n","      <td>19383</td>\n","      <td>15498</td>\n","      <td>865</td>\n","      <td>2322</td>\n","      <td>9931</td>\n","      <td>18620</td>\n","      <td>9537</td>\n","      <td>18672</td>\n","      <td>19383</td>\n","      <td>14311</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>18686</td>\n","      <td>17368</td>\n","      <td>18804</td>\n","      <td>18779</td>\n","      <td>19383</td>\n","      <td>17147</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>9000</td>\n","      <td>9223</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19131</td>\n","      <td>18322</td>\n","      <td>18561</td>\n","      <td>18394</td>\n","      <td>18626</td>\n","      <td>17807</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>18133</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>18808</td>\n","      <td>16337</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>14781</td>\n","      <td>2203</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>18961</td>\n","      <td>18561</td>\n","      <td>18951</td>\n","      <td>18830</td>\n","      <td>10327</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>14091</td>\n","      <td>4674</td>\n","      <td>6633</td>\n","      <td>7433</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>8009</td>\n","      <td>7140</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>11660</td>\n","      <td>3377</td>\n","      <td>3223</td>\n","      <td>5771</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>14976</td>\n","      <td>16642</td>\n","      <td>13633</td>\n","      <td>12019</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>5968</td>\n","      <td>2831</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>12797</td>\n","      <td>6488</td>\n","      <td>6485</td>\n","      <td>5202</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>16896</td>\n","      <td>18711</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>...</td>\n","      <td>8856</td>\n","      <td>8011</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>19383</td>\n","      <td>18699</td>\n","      <td>17537</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 24 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a10cdafd-7367-468b-bc6d-e72a2c214737')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a10cdafd-7367-468b-bc6d-e72a2c214737 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a10cdafd-7367-468b-bc6d-e72a2c214737');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["total_rank5.to_excel(\"/content/drive/MyDrive/2차 프로젝트/금액별 구매빈도.xlsx\")"],"metadata":{"id":"W_gA1_uZVoyq"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"9nwi2LABekYR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"p_VzvvQZekWB"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"sqTsoIo7XzHZ"},"source":["## 2) RFM\n","- 1-6분기 RFM 등급(train) : RFM_TRAIN ->RFN_TRAIN_FINAL.csv\n","- 1-7분기 RFM 등급(test) : RFM_TEST ->RFN_TEST_FINAL.csv"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GUsqxktZX5px","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672593272208,"user_tz":-540,"elapsed":158663,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"6d13e104-e857-46f7-b0f0-1789bfe774eb"},"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-15-0fd6711af594>:15: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매일자'] = df['구매일자'].astype('str')\n","<ipython-input-15-0fd6711af594>:16: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매시간'] = df['구매시간'].astype('str')\n","<ipython-input-15-0fd6711af594>:17: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매시간'] = df['구매시간'].str.zfill(2)\n","<ipython-input-15-0fd6711af594>:18: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매일자']=df.구매일자 + df.구매시간\n"]}],"source":["# 1-6분기 RFM 기초데이터셋 만들기 \n","import pandas as pd\n","\n","## 데이터셋불러오기\n","total=pd.read_csv('/content/drive/MyDrive/2차프로젝트 공유폴더/프로젝트데이터셋/total_final.csv')\n","\n","abc=[1,2,3,4,5,6] ## 1-6분기 데이터 뽑기\n","df=total[total['분기'].isin(abc)] ## 1-6분기 데이터 뽑기\n","customer_id = list(df['고객번호'].unique()) ## 고객아이디\n","\n","## 구매금액총합\n","monetary_df=df.groupby('고객번호')[['구매금액']].sum().reset_index()\n","\n","## 각 고객별 최근방문일\n","df['구매일자'] = df['구매일자'].astype('str')\n","df['구매시간'] = df['구매시간'].astype('str')\n","df['구매시간'] = df['구매시간'].str.zfill(2)\n","df['구매일자']=df.구매일자 + df.구매시간\n","recency_df = df[['고객번호','구매일자']].drop_duplicates() ## 고객 아이디와 구매일자만 추출한뒤 중복 제거\n","\n","recency_df = recency_df.groupby('고객번호')['구매일자'].max().reset_index() ## 아이디로 그룹화 한다음 최근방문일을 구해야 하므로 구매일자에 max를 적용한다.\n","recency_df = recency_df.rename(columns={'구매일자':'최근구매일'})\n","\n","## 각 고객별 방문횟수\n","frequency_df = df[['고객번호','영수증번호']].drop_duplicates() ## 고객 아이디와 영수증번호만 추출한뒤 중복 제거\n","frequency_df = frequency_df.groupby('고객번호')['영수증번호'].count().reset_index() ## 아이디로 그룹화 한다음 방문횟수를 구해야 한다. 여기서는 방문횟수를 영수증 개수로 생각했으므로 영수증에 count를 적용한다.\n","frequency_df = frequency_df.rename(columns={'영수증번호':'구매횟수'})\n","\n","## 데이터를 고객아이디를 기준으로 합침\n","rfm_df = pd.merge(recency_df,frequency_df,how='left',on='고객번호')\n","rfm_df = pd.merge(rfm_df,monetary_df,how='left',on='고객번호')"]},{"cell_type":"code","source":["rfm_df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"qZXu5VoGUd9J","executionInfo":{"status":"ok","timestamp":1672593295322,"user_tz":-540,"elapsed":553,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"e8b5f1d1-5443-4f7f-e63a-6a35d909b890"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호       최근구매일  구매횟수      구매금액\n","0          1  2015062712   563  71940032\n","1          2  2015062416   521  74036940\n","2          3  2015062911   390   2486049\n","3          4  2015063016   376  12956553\n","4          5  2015052118   376  10620810\n","...      ...         ...   ...       ...\n","19367  19379  2015063023   214   3586540\n","19368  19380  2015063018    68   1360650\n","19369  19381  2015062921   155   2797171\n","19370  19382  2015063020   146   1826739\n","19371  19383  2015062609     3     27000\n","\n","[19372 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-7591348d-9f80-42b2-8d50-c9612681e9c5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>최근구매일</th>\n","      <th>구매횟수</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2015062712</td>\n","      <td>563</td>\n","      <td>71940032</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2015062416</td>\n","      <td>521</td>\n","      <td>74036940</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2015062911</td>\n","      <td>390</td>\n","      <td>2486049</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2015063016</td>\n","      <td>376</td>\n","      <td>12956553</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2015052118</td>\n","      <td>376</td>\n","      <td>10620810</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>2015063023</td>\n","      <td>214</td>\n","      <td>3586540</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>2015063018</td>\n","      <td>68</td>\n","      <td>1360650</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>2015062921</td>\n","      <td>155</td>\n","      <td>2797171</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>2015063020</td>\n","      <td>146</td>\n","      <td>1826739</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>2015062609</td>\n","      <td>3</td>\n","      <td>27000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7591348d-9f80-42b2-8d50-c9612681e9c5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7591348d-9f80-42b2-8d50-c9612681e9c5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7591348d-9f80-42b2-8d50-c9612681e9c5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["# 최근구매일(Recency) 칼럼 만들기 \n","from datetime import datetime\n","rfm_df['최근구매일']=rfm_df['최근구매일'].astype('str')\n","rfm_df['최근구매일']=rfm_df['최근구매일'].apply(lambda x : datetime.strptime(x,'%Y%m%d%H'))\n","current_day = pd.to_datetime('20140101') ## 기준 날짜 2014년 1월 1일\n","time_diff = rfm_df['최근구매일']-current_day ## 최근방문일과 기준 날짜의 시간 차이\n","rfm_df['Recency'] = time_diff "],"metadata":{"id":"9fXJwegBS63X"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["rfm_df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"_TX8C7ndVGbe","executionInfo":{"status":"ok","timestamp":1672595736937,"user_tz":-540,"elapsed":535,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"5807f5c7-f690-4a90-a6d0-671bd8e1e0ec"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호               최근구매일  구매횟수      구매금액           Recency\n","0          1 2015-06-27 12:00:00   563  71940032 542 days 12:00:00\n","1          2 2015-06-24 16:00:00   521  74036940 539 days 16:00:00\n","2          3 2015-06-29 11:00:00   390   2486049 544 days 11:00:00\n","3          4 2015-06-30 16:00:00   376  12956553 545 days 16:00:00\n","4          5 2015-05-21 18:00:00   376  10620810 505 days 18:00:00\n","...      ...                 ...   ...       ...               ...\n","19367  19379 2015-06-30 23:00:00   214   3586540 545 days 23:00:00\n","19368  19380 2015-06-30 18:00:00    68   1360650 545 days 18:00:00\n","19369  19381 2015-06-29 21:00:00   155   2797171 544 days 21:00:00\n","19370  19382 2015-06-30 20:00:00   146   1826739 545 days 20:00:00\n","19371  19383 2015-06-26 09:00:00     3     27000 541 days 09:00:00\n","\n","[19372 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-3b5a3a45-ba68-4676-9cec-bae93e339ab3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>최근구매일</th>\n","      <th>구매횟수</th>\n","      <th>구매금액</th>\n","      <th>Recency</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2015-06-27 12:00:00</td>\n","      <td>563</td>\n","      <td>71940032</td>\n","      <td>542 days 12:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2015-06-24 16:00:00</td>\n","      <td>521</td>\n","      <td>74036940</td>\n","      <td>539 days 16:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2015-06-29 11:00:00</td>\n","      <td>390</td>\n","      <td>2486049</td>\n","      <td>544 days 11:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2015-06-30 16:00:00</td>\n","      <td>376</td>\n","      <td>12956553</td>\n","      <td>545 days 16:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2015-05-21 18:00:00</td>\n","      <td>376</td>\n","      <td>10620810</td>\n","      <td>505 days 18:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>2015-06-30 23:00:00</td>\n","      <td>214</td>\n","      <td>3586540</td>\n","      <td>545 days 23:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>2015-06-30 18:00:00</td>\n","      <td>68</td>\n","      <td>1360650</td>\n","      <td>545 days 18:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>2015-06-29 21:00:00</td>\n","      <td>155</td>\n","      <td>2797171</td>\n","      <td>544 days 21:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>2015-06-30 20:00:00</td>\n","      <td>146</td>\n","      <td>1826739</td>\n","      <td>545 days 20:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>2015-06-26 09:00:00</td>\n","      <td>3</td>\n","      <td>27000</td>\n","      <td>541 days 09:00:00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3b5a3a45-ba68-4676-9cec-bae93e339ab3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3b5a3a45-ba68-4676-9cec-bae93e339ab3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3b5a3a45-ba68-4676-9cec-bae93e339ab3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":41}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HvCsY61cX5vB"},"outputs":[],"source":["## 등급구해주는 함수\n","\n","import pandas as pd\n","import numpy as np\n","from sklearn.preprocessing import StandardScaler\n","\n","def get_score(level, data):\n","    '''\n","    Description :\n","    level안에 있는 원소를 기준으로\n","    1 ~ len(level)+ 1 까지 점수를 부여하는 함수\n","    '''\n","    score = [] \n","    for j in range(len(data)): \n","        for i in range(len(level)): \n","            if data[j] <= level[i]: \n","                score.append(i+1) \n","                break \n","            elif data[j] > max(level): \n","                score.append(len(level)+1) \n","                break \n","            else: \n","                continue \n","    return score\n","    \n","def get_rfm_grade(df, num_class, rfm_tick_point, rfm_col_map, suffix=None):\n","    '''\n","    Description :\n","    개별 고객에 대한 최근방문일/방문횟수/구매금액 데이터가 주어졌을때\n","    최근방문일/방문횟수/구매금액 점수를  quantile, minmax, 직접지정 3개중 원하는 방법으로 계산하여 주어진 데이터 오른쪽에 붙힘\n","\n","    '''\n","    \n","        \n","    ##### 최근방문일/방문횟수/구매금액 점수 부여\n","    for k, v in rfm_tick_point.items():\n","        if isinstance(v,str):\n","            if v == 'quantile':\n","                ## 데이터 변환\n","                scale = StandardScaler()  \n","                temp_data = np.array(df[rfm_col_map[k]]) \n","                temp_data = temp_data.reshape((-1,1)) ## 스케일링전 2차원변환\n","                temp_data = scale.fit_transform(temp_data) \n","                temp_data = temp_data.squeeze() ## 1차원으로 변환\n"," \n","                ## 분위수 벡터\n","                quantiles_level = np.linspace(0,1,num_class+1)[1:-1] ## 분위수를 구할 기준값을 지정 0과 1은 제외\n","                quantiles = [] ## 분위수를 담을 리스트\n","                for ql in quantiles_level:\n","                    quantiles.append(np.quantile(temp_data,ql)) ## 분위수를 계산하고 리스트에 삽입\n","            else: ## min_max인 경우\n","                ## 데이터 변환\n","                temp_data = np.array(df[rfm_col_map[k]])\n"," \n","                ## 등분점 계산\n","                quantiles = np.linspace(np.min(temp_data),np.max(temp_data),num_class+1)[1:-1] ## 최소값과 최대값을 점수 개수만큼 등간격으로 분할하는 점\n","        else: ## 직접 구분값을 넣어주는 경우\n","            temp_data = np.array(df[rfm_col_map[k]])\n","            quantiles = v ## 직접 구분값을 넣어줌\n","        score = get_score(quantiles, temp_data) ## 구분값을 기준으로 점수를 부여하고 리스트로 저장\n","        new_col_name = rfm_col_map[k]+'_'+k ## 점수값을 담는 변수의 이름\n","        if suffix:\n","            new_col_name = rfm_col_map[k]+'_'+suffix\n","        df[new_col_name] = score ## 기존데이터 옆에 점수 데이터를 추가\n","    return df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sLxYMWcqX5y1"},"outputs":[],"source":["# 1-6 RFM 등급매기기\n","rfm_tick_point={'R':'quantile','F':'quantile','M':'quantile'} \n","rfm_col_map={'R':'Recency','F':'구매횟수','M':'구매금액'}\n","result = get_rfm_grade(df=rfm_df, num_class=5, rfm_tick_point=rfm_tick_point, rfm_col_map=rfm_col_map)"]},{"cell_type":"code","source":["result"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"hFoH4QeEiBa4","executionInfo":{"status":"ok","timestamp":1672596694526,"user_tz":-540,"elapsed":549,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"b175639b-eb4c-468b-9319-bc88f0f044e3"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호               최근구매일  구매횟수      구매금액           Recency  Recency_R  \\\n","0          1 2015-06-27 12:00:00   563  71940032 542 days 12:00:00          1   \n","1          2 2015-06-24 16:00:00   521  74036940 539 days 16:00:00          1   \n","2          3 2015-06-29 11:00:00   390   2486049 544 days 11:00:00          2   \n","3          4 2015-06-30 16:00:00   376  12956553 545 days 16:00:00          4   \n","4          5 2015-05-21 18:00:00   376  10620810 505 days 18:00:00          1   \n","...      ...                 ...   ...       ...               ...        ...   \n","19367  19379 2015-06-30 23:00:00   214   3586540 545 days 23:00:00          5   \n","19368  19380 2015-06-30 18:00:00    68   1360650 545 days 18:00:00          4   \n","19369  19381 2015-06-29 21:00:00   155   2797171 544 days 21:00:00          3   \n","19370  19382 2015-06-30 20:00:00   146   1826739 545 days 20:00:00          5   \n","19371  19383 2015-06-26 09:00:00     3     27000 541 days 09:00:00          1   \n","\n","       구매횟수_F  구매금액_M  \n","0           5       5  \n","1           5       5  \n","2           3       1  \n","3           2       3  \n","4           2       3  \n","...       ...     ...  \n","19367       1       1  \n","19368       1       1  \n","19369       1       1  \n","19370       1       1  \n","19371       1       1  \n","\n","[19372 rows x 8 columns]"],"text/html":["\n","  <div id=\"df-2596afcd-7925-46d3-bfbd-59020368068b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>최근구매일</th>\n","      <th>구매횟수</th>\n","      <th>구매금액</th>\n","      <th>Recency</th>\n","      <th>Recency_R</th>\n","      <th>구매횟수_F</th>\n","      <th>구매금액_M</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2015-06-27 12:00:00</td>\n","      <td>563</td>\n","      <td>71940032</td>\n","      <td>542 days 12:00:00</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2015-06-24 16:00:00</td>\n","      <td>521</td>\n","      <td>74036940</td>\n","      <td>539 days 16:00:00</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2015-06-29 11:00:00</td>\n","      <td>390</td>\n","      <td>2486049</td>\n","      <td>544 days 11:00:00</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2015-06-30 16:00:00</td>\n","      <td>376</td>\n","      <td>12956553</td>\n","      <td>545 days 16:00:00</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2015-05-21 18:00:00</td>\n","      <td>376</td>\n","      <td>10620810</td>\n","      <td>505 days 18:00:00</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>2015-06-30 23:00:00</td>\n","      <td>214</td>\n","      <td>3586540</td>\n","      <td>545 days 23:00:00</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>2015-06-30 18:00:00</td>\n","      <td>68</td>\n","      <td>1360650</td>\n","      <td>545 days 18:00:00</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>2015-06-29 21:00:00</td>\n","      <td>155</td>\n","      <td>2797171</td>\n","      <td>544 days 21:00:00</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>2015-06-30 20:00:00</td>\n","      <td>146</td>\n","      <td>1826739</td>\n","      <td>545 days 20:00:00</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>2015-06-26 09:00:00</td>\n","      <td>3</td>\n","      <td>27000</td>\n","      <td>541 days 09:00:00</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 8 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2596afcd-7925-46d3-bfbd-59020368068b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2596afcd-7925-46d3-bfbd-59020368068b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2596afcd-7925-46d3-bfbd-59020368068b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":44}]},{"cell_type":"code","source":["RFM_TRAIN=result[['고객번호','Recency_R','구매횟수_F','구매금액_M']]\n","RFM_TRAIN"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"iiSRSvLoixqs","executionInfo":{"status":"ok","timestamp":1672596972631,"user_tz":-540,"elapsed":601,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"8383d453-1a24-485a-a8b6-b41c0fb8502a"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  Recency_R  구매횟수_F  구매금액_M\n","0          1          1       5       5\n","1          2          1       5       5\n","2          3          2       3       1\n","3          4          4       2       3\n","4          5          1       2       3\n","...      ...        ...     ...     ...\n","19367  19379          5       1       1\n","19368  19380          4       1       1\n","19369  19381          3       1       1\n","19370  19382          5       1       1\n","19371  19383          1       1       1\n","\n","[19372 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-7770e8d8-88e9-42c3-a445-f50a3255c443\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>Recency_R</th>\n","      <th>구매횟수_F</th>\n","      <th>구매금액_M</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7770e8d8-88e9-42c3-a445-f50a3255c443')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7770e8d8-88e9-42c3-a445-f50a3255c443 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7770e8d8-88e9-42c3-a445-f50a3255c443');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":45}]},{"cell_type":"code","source":["# 1-7분기 RFM 기초데이터셋 만들기 \n","import pandas as pd\n","\n","## 데이터셋불러오기\n","total=pd.read_csv('/content/drive/MyDrive/2차프로젝트 공유폴더/프로젝트데이터셋/total_final.csv')\n","\n","abc=[1,2,3,4,5,6,7] ## 1-7분기 데이터 뽑기\n","df=total[total['분기'].isin(abc)] ## 1-7분기 데이터 뽑기\n","customer_id = list(df['고객번호'].unique()) ## 고객아이디\n","\n","## 구매금액총합\n","monetary_df=df.groupby('고객번호')[['구매금액']].sum().reset_index()\n","\n","## 각 고객별 최근방문일\n","df['구매일자'] = df['구매일자'].astype('str')\n","df['구매시간'] = df['구매시간'].astype('str')\n","df['구매시간'] = df['구매시간'].str.zfill(2)\n","df['구매일자']=df.구매일자 + df.구매시간\n","recency_df = df[['고객번호','구매일자']].drop_duplicates() ## 고객 아이디와 구매일자만 추출한뒤 중복 제거\n","\n","recency_df = recency_df.groupby('고객번호')['구매일자'].max().reset_index() ## 아이디로 그룹화 한다음 최근방문일을 구해야 하므로 구매일자에 max를 적용한다.\n","recency_df = recency_df.rename(columns={'구매일자':'최근구매일'})\n","\n","## 각 고객별 방문횟수\n","frequency_df = df[['고객번호','영수증번호']].drop_duplicates() ## 고객 아이디와 영수증번호만 추출한뒤 중복 제거\n","frequency_df = frequency_df.groupby('고객번호')['영수증번호'].count().reset_index() ## 아이디로 그룹화 한다음 방문횟수를 구해야 한다. 여기서는 방문횟수를 영수증 개수로 생각했으므로 영수증에 count를 적용한다.\n","frequency_df = frequency_df.rename(columns={'영수증번호':'구매횟수'})\n","\n","## 데이터를 고객아이디를 기준으로 합치기\n","rfm_df = pd.merge(recency_df,frequency_df,how='left',on='고객번호')\n","rfm_df = pd.merge(rfm_df,monetary_df,how='left',on='고객번호')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W6cgpFDUkJs4","executionInfo":{"status":"ok","timestamp":1672597588489,"user_tz":-540,"elapsed":168987,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"8c13ead6-662a-4a2e-905b-9631720d94dc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-3-e10777e343b5>:15: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매일자'] = df['구매일자'].astype('str')\n","<ipython-input-3-e10777e343b5>:16: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매시간'] = df['구매시간'].astype('str')\n","<ipython-input-3-e10777e343b5>:17: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매시간'] = df['구매시간'].str.zfill(2)\n","<ipython-input-3-e10777e343b5>:18: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  df['구매일자']=df.구매일자 + df.구매시간\n"]}]},{"cell_type":"code","source":["rfm_df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"E6pj4B1DkUQs","executionInfo":{"status":"ok","timestamp":1672597592887,"user_tz":-540,"elapsed":378,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"6e03af9d-298f-49e8-ef91-cffa07c9fd5b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호       최근구매일  구매횟수      구매금액\n","0          1  2015092213   631  79746612\n","1          2  2015092912   602  87879540\n","2          3  2015092212   443   2907066\n","3          4  2015093018   455  15083665\n","4          5  2015052118   376  10620810\n","...      ...         ...   ...       ...\n","19375  19379  2015092921   298   4392090\n","19376  19380  2015092910    94   1729557\n","19377  19381  2015092921   283   4664672\n","19378  19382  2015092820   280   3092926\n","19379  19383  2015092809    76   1119360\n","\n","[19380 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-c7d61093-34c3-46c9-8a7c-4c2953793524\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>최근구매일</th>\n","      <th>구매횟수</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2015092213</td>\n","      <td>631</td>\n","      <td>79746612</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2015092912</td>\n","      <td>602</td>\n","      <td>87879540</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2015092212</td>\n","      <td>443</td>\n","      <td>2907066</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2015093018</td>\n","      <td>455</td>\n","      <td>15083665</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2015052118</td>\n","      <td>376</td>\n","      <td>10620810</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19375</th>\n","      <td>19379</td>\n","      <td>2015092921</td>\n","      <td>298</td>\n","      <td>4392090</td>\n","    </tr>\n","    <tr>\n","      <th>19376</th>\n","      <td>19380</td>\n","      <td>2015092910</td>\n","      <td>94</td>\n","      <td>1729557</td>\n","    </tr>\n","    <tr>\n","      <th>19377</th>\n","      <td>19381</td>\n","      <td>2015092921</td>\n","      <td>283</td>\n","      <td>4664672</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19382</td>\n","      <td>2015092820</td>\n","      <td>280</td>\n","      <td>3092926</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>2015092809</td>\n","      <td>76</td>\n","      <td>1119360</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19380 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c7d61093-34c3-46c9-8a7c-4c2953793524')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c7d61093-34c3-46c9-8a7c-4c2953793524 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c7d61093-34c3-46c9-8a7c-4c2953793524');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["# 최근구매일(Recency) 칼럼 만들기 \n","from datetime import datetime\n","rfm_df['최근구매일']=rfm_df['최근구매일'].astype('str')\n","rfm_df['최근구매일']=rfm_df['최근구매일'].apply(lambda x : datetime.strptime(x,'%Y%m%d%H'))\n","current_day = pd.to_datetime('20140101') ## 기준 날짜 2014년 1월 1일\n","time_diff = rfm_df['최근구매일']-current_day ## 최근방문일과 기준 날짜의 시간 차이\n","rfm_df['Recency'] = time_diff "],"metadata":{"id":"grgjAYYSkTlo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["rfm_df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"aSCx_4I1kWSB","executionInfo":{"status":"ok","timestamp":1672597599743,"user_tz":-540,"elapsed":399,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"65744cc8-947f-4157-92e3-c63f657d9f43"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호               최근구매일  구매횟수      구매금액           Recency\n","0          1 2015-09-22 13:00:00   631  79746612 629 days 13:00:00\n","1          2 2015-09-29 12:00:00   602  87879540 636 days 12:00:00\n","2          3 2015-09-22 12:00:00   443   2907066 629 days 12:00:00\n","3          4 2015-09-30 18:00:00   455  15083665 637 days 18:00:00\n","4          5 2015-05-21 18:00:00   376  10620810 505 days 18:00:00\n","...      ...                 ...   ...       ...               ...\n","19375  19379 2015-09-29 21:00:00   298   4392090 636 days 21:00:00\n","19376  19380 2015-09-29 10:00:00    94   1729557 636 days 10:00:00\n","19377  19381 2015-09-29 21:00:00   283   4664672 636 days 21:00:00\n","19378  19382 2015-09-28 20:00:00   280   3092926 635 days 20:00:00\n","19379  19383 2015-09-28 09:00:00    76   1119360 635 days 09:00:00\n","\n","[19380 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-befa5480-590c-4fa0-9a7b-61cf8c3933ae\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>최근구매일</th>\n","      <th>구매횟수</th>\n","      <th>구매금액</th>\n","      <th>Recency</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2015-09-22 13:00:00</td>\n","      <td>631</td>\n","      <td>79746612</td>\n","      <td>629 days 13:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2015-09-29 12:00:00</td>\n","      <td>602</td>\n","      <td>87879540</td>\n","      <td>636 days 12:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2015-09-22 12:00:00</td>\n","      <td>443</td>\n","      <td>2907066</td>\n","      <td>629 days 12:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2015-09-30 18:00:00</td>\n","      <td>455</td>\n","      <td>15083665</td>\n","      <td>637 days 18:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2015-05-21 18:00:00</td>\n","      <td>376</td>\n","      <td>10620810</td>\n","      <td>505 days 18:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19375</th>\n","      <td>19379</td>\n","      <td>2015-09-29 21:00:00</td>\n","      <td>298</td>\n","      <td>4392090</td>\n","      <td>636 days 21:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19376</th>\n","      <td>19380</td>\n","      <td>2015-09-29 10:00:00</td>\n","      <td>94</td>\n","      <td>1729557</td>\n","      <td>636 days 10:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19377</th>\n","      <td>19381</td>\n","      <td>2015-09-29 21:00:00</td>\n","      <td>283</td>\n","      <td>4664672</td>\n","      <td>636 days 21:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19382</td>\n","      <td>2015-09-28 20:00:00</td>\n","      <td>280</td>\n","      <td>3092926</td>\n","      <td>635 days 20:00:00</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>2015-09-28 09:00:00</td>\n","      <td>76</td>\n","      <td>1119360</td>\n","      <td>635 days 09:00:00</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19380 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-befa5480-590c-4fa0-9a7b-61cf8c3933ae')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-befa5480-590c-4fa0-9a7b-61cf8c3933ae button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-befa5480-590c-4fa0-9a7b-61cf8c3933ae');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["# 1-7 RFM 등급 매기기\n","rfm_tick_point={'R':'quantile','F':'quantile','M':'quantile'} \n","rfm_col_map={'R':'Recency','F':'구매횟수','M':'구매금액'}\n","result = get_rfm_grade(df=rfm_df, num_class=5, rfm_tick_point=rfm_tick_point, rfm_col_map=rfm_col_map)"],"metadata":{"id":"KxlJbEw2keTf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["result"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"bz9lS2BrlgzZ","executionInfo":{"status":"ok","timestamp":1672597611242,"user_tz":-540,"elapsed":550,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"d07b4e6b-2540-4120-d30a-703931e3a26f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호               최근구매일  구매횟수      구매금액           Recency  Recency_R  \\\n","0          1 2015-09-22 13:00:00   631  79746612 629 days 13:00:00          1   \n","1          2 2015-09-29 12:00:00   602  87879540 636 days 12:00:00          2   \n","2          3 2015-09-22 12:00:00   443   2907066 629 days 12:00:00          1   \n","3          4 2015-09-30 18:00:00   455  15083665 637 days 18:00:00          4   \n","4          5 2015-05-21 18:00:00   376  10620810 505 days 18:00:00          1   \n","...      ...                 ...   ...       ...               ...        ...   \n","19375  19379 2015-09-29 21:00:00   298   4392090 636 days 21:00:00          3   \n","19376  19380 2015-09-29 10:00:00    94   1729557 636 days 10:00:00          2   \n","19377  19381 2015-09-29 21:00:00   283   4664672 636 days 21:00:00          3   \n","19378  19382 2015-09-28 20:00:00   280   3092926 635 days 20:00:00          2   \n","19379  19383 2015-09-28 09:00:00    76   1119360 635 days 09:00:00          2   \n","\n","       구매횟수_F  구매금액_M  \n","0           5       5  \n","1           4       5  \n","2           2       1  \n","3           3       3  \n","4           1       2  \n","...       ...     ...  \n","19375       1       1  \n","19376       1       1  \n","19377       1       1  \n","19378       1       1  \n","19379       1       1  \n","\n","[19380 rows x 8 columns]"],"text/html":["\n","  <div id=\"df-24b46f94-8d61-40ba-975e-bc6bfc5a582d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>최근구매일</th>\n","      <th>구매횟수</th>\n","      <th>구매금액</th>\n","      <th>Recency</th>\n","      <th>Recency_R</th>\n","      <th>구매횟수_F</th>\n","      <th>구매금액_M</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2015-09-22 13:00:00</td>\n","      <td>631</td>\n","      <td>79746612</td>\n","      <td>629 days 13:00:00</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2015-09-29 12:00:00</td>\n","      <td>602</td>\n","      <td>87879540</td>\n","      <td>636 days 12:00:00</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2015-09-22 12:00:00</td>\n","      <td>443</td>\n","      <td>2907066</td>\n","      <td>629 days 12:00:00</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2015-09-30 18:00:00</td>\n","      <td>455</td>\n","      <td>15083665</td>\n","      <td>637 days 18:00:00</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2015-05-21 18:00:00</td>\n","      <td>376</td>\n","      <td>10620810</td>\n","      <td>505 days 18:00:00</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19375</th>\n","      <td>19379</td>\n","      <td>2015-09-29 21:00:00</td>\n","      <td>298</td>\n","      <td>4392090</td>\n","      <td>636 days 21:00:00</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19376</th>\n","      <td>19380</td>\n","      <td>2015-09-29 10:00:00</td>\n","      <td>94</td>\n","      <td>1729557</td>\n","      <td>636 days 10:00:00</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19377</th>\n","      <td>19381</td>\n","      <td>2015-09-29 21:00:00</td>\n","      <td>283</td>\n","      <td>4664672</td>\n","      <td>636 days 21:00:00</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19382</td>\n","      <td>2015-09-28 20:00:00</td>\n","      <td>280</td>\n","      <td>3092926</td>\n","      <td>635 days 20:00:00</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>2015-09-28 09:00:00</td>\n","      <td>76</td>\n","      <td>1119360</td>\n","      <td>635 days 09:00:00</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19380 rows × 8 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-24b46f94-8d61-40ba-975e-bc6bfc5a582d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-24b46f94-8d61-40ba-975e-bc6bfc5a582d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-24b46f94-8d61-40ba-975e-bc6bfc5a582d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["RFM_TEST=result[['고객번호','Recency_R','구매횟수_F','구매금액_M']]\n","RFM_TEST"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"cAlEV7mNlmBW","executionInfo":{"status":"ok","timestamp":1672597711499,"user_tz":-540,"elapsed":4,"user":{"displayName":"hyung joong kim","userId":"17115953432759157922"}},"outputId":"29f8bccb-5afd-493a-e5b8-d74d29840ca2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  Recency_R  구매횟수_F  구매금액_M\n","0          1          1       5       5\n","1          2          2       4       5\n","2          3          1       2       1\n","3          4          4       3       3\n","4          5          1       1       2\n","...      ...        ...     ...     ...\n","19375  19379          3       1       1\n","19376  19380          2       1       1\n","19377  19381          3       1       1\n","19378  19382          2       1       1\n","19379  19383          2       1       1\n","\n","[19380 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-1146d99f-eca2-459d-a42c-2aca5cb441f1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>Recency_R</th>\n","      <th>구매횟수_F</th>\n","      <th>구매금액_M</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19375</th>\n","      <td>19379</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19376</th>\n","      <td>19380</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19377</th>\n","      <td>19381</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19382</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19380 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1146d99f-eca2-459d-a42c-2aca5cb441f1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1146d99f-eca2-459d-a42c-2aca5cb441f1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1146d99f-eca2-459d-a42c-2aca5cb441f1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":[],"metadata":{"id":"jLJlQLfWKkwZ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 3) 속성변수"],"metadata":{"id":"ob2FbdZmnl93"}},{"cell_type":"markdown","source":["### train, test 분기 설정\n","* train_data : 1~6분기 데이터만\n","* test_data : 1~7분기 데이터만\n"],"metadata":{"id":"r2S30mL1peTV"}},{"cell_type":"code","source":["data_1_train = data_1.query('가입년월 <= 201506')\n","data_1_test = data_1.query('가입년월 <= 201509')\n","data_1_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"-uU_9AKqos5l","executionInfo":{"status":"ok","timestamp":1672638346072,"user_tz":-540,"elapsed":447,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"27465590-9ea2-4b51-eb3b-c616e1cbe13e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       고객번호  멤버십명    가입년월\n","1        21  하이마트  201506\n","2        37  하이마트  201306\n","3        43  하이마트  201403\n","4        44  하이마트  201411\n","5        61  하이마트  201312\n","...     ...   ...     ...\n","7449  19373    롭스  201502\n","7451  19377    롭스  201411\n","7452  19379    롭스  201412\n","7453  19380    롭스  201412\n","7454  19381   다둥이  201506\n","\n","[6184 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-6b9cdacc-6266-4ecc-9a19-b485d161a625\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십명</th>\n","      <th>가입년월</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>21</td>\n","      <td>하이마트</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>37</td>\n","      <td>하이마트</td>\n","      <td>201306</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>43</td>\n","      <td>하이마트</td>\n","      <td>201403</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>44</td>\n","      <td>하이마트</td>\n","      <td>201411</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>61</td>\n","      <td>하이마트</td>\n","      <td>201312</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>7449</th>\n","      <td>19373</td>\n","      <td>롭스</td>\n","      <td>201502</td>\n","    </tr>\n","    <tr>\n","      <th>7451</th>\n","      <td>19377</td>\n","      <td>롭스</td>\n","      <td>201411</td>\n","    </tr>\n","    <tr>\n","      <th>7452</th>\n","      <td>19379</td>\n","      <td>롭스</td>\n","      <td>201412</td>\n","    </tr>\n","    <tr>\n","      <th>7453</th>\n","      <td>19380</td>\n","      <td>롭스</td>\n","      <td>201412</td>\n","    </tr>\n","    <tr>\n","      <th>7454</th>\n","      <td>19381</td>\n","      <td>다둥이</td>\n","      <td>201506</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>6184 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6b9cdacc-6266-4ecc-9a19-b485d161a625')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6b9cdacc-6266-4ecc-9a19-b485d161a625 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6b9cdacc-6266-4ecc-9a19-b485d161a625');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["data_3_train = data_3.query('이용년월 <= 201506')\n","data_3_test = data_3.query('이용년월 <= 201509')\n","data_3_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"qVYF1kQ_oGTn","executionInfo":{"status":"ok","timestamp":1672638364074,"user_tz":-540,"elapsed":418,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"2726e7ef-5279-48b5-8720-93e9a940e804"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호 제휴사  경쟁사    이용년월\n","1         51   D  D01  201504\n","2         77   D  D02  201503\n","3         77   D  D02  201506\n","13       118   D  D02  201501\n","14       118   D  D02  201505\n","...      ...  ..  ...     ...\n","28151  19372   C  C02  201501\n","28152  19372   C  C02  201502\n","28154  19375   B  B01  201501\n","28157  19376   B  B01  201506\n","28158  19377   B  B01  201504\n","\n","[13572 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-25babe6a-1f76-4202-9ece-86470c31e207\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>제휴사</th>\n","      <th>경쟁사</th>\n","      <th>이용년월</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>51</td>\n","      <td>D</td>\n","      <td>D01</td>\n","      <td>201504</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>77</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201503</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>77</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>118</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201501</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>118</td>\n","      <td>D</td>\n","      <td>D02</td>\n","      <td>201505</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28151</th>\n","      <td>19372</td>\n","      <td>C</td>\n","      <td>C02</td>\n","      <td>201501</td>\n","    </tr>\n","    <tr>\n","      <th>28152</th>\n","      <td>19372</td>\n","      <td>C</td>\n","      <td>C02</td>\n","      <td>201502</td>\n","    </tr>\n","    <tr>\n","      <th>28154</th>\n","      <td>19375</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201501</td>\n","    </tr>\n","    <tr>\n","      <th>28157</th>\n","      <td>19376</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201506</td>\n","    </tr>\n","    <tr>\n","      <th>28158</th>\n","      <td>19377</td>\n","      <td>B</td>\n","      <td>B01</td>\n","      <td>201504</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>13572 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-25babe6a-1f76-4202-9ece-86470c31e207')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-25babe6a-1f76-4202-9ece-86470c31e207 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-25babe6a-1f76-4202-9ece-86470c31e207');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["total_train = total.query('구매일자 <= 20150630')\n","total_test = total.query('구매일자 <= 20150930')\n","total_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":763},"id":"37Cgbg1opsjl","executionInfo":{"status":"ok","timestamp":1672638606685,"user_tz":-540,"elapsed":10566,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"5cda722c-3ff5-41e4-f4a9-135540f9c9e7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          Unnamed: 0  대분류코드  중분류코드    소분류코드    중분류명     소분류명       대분류  \\\n","0                  0      1    101  A010101    일용잡화     위생세제      일상용품   \n","1                  1      1    101  A010101    일용잡화     위생세제      일상용품   \n","2                  2      1    101  A010101    일용잡화     위생세제      일상용품   \n","3                  3      1    101  A010103    일용잡화     뷰티상품      일상용품   \n","4                  4      1    101  A010103    일용잡화     뷰티상품      일상용품   \n","...              ...    ...    ...      ...     ...      ...       ...   \n","28593015    28593015      6    601  D060108    미용소품   면봉/화장솜      일상용품   \n","28593018    28593018      6    602  D060202     양말류      스타킹  전문스포츠/레저   \n","28593019    28593019      6    603  D060301  우산/양산류      장우산      패션잡화   \n","28593027    28593027      8    803  D080302   립메이크업  립글로즈/틴트      일상용품   \n","28593028    28593028      8    803  D080302   립메이크업  립글로즈/틴트      일상용품   \n","\n","            영수증번호   고객번호  점포코드      구매일자  구매시간   구매금액  성별  연령대   거주지역    년도  \\\n","0         2757986  15148    10  20140920    20   1000   1    5  100.0  2014   \n","1         1878938  15148    10  20140505    19  15000   1    5  100.0  2014   \n","2         3436437  15148    10  20150102    16   9900   1    5  100.0  2015   \n","3         1385676  15148    10  20140215    17   7000   1    5  100.0  2014   \n","4         1547466  15148    10  20140315    19  21000   1    5  100.0  2014   \n","...           ...    ...   ...       ...   ...    ...  ..  ...    ...   ...   \n","28593015   229564  18799    24  20150512    14   2000   1    2   33.0  2015   \n","28593018   229572  18799    24  20150515    16   3500   1    2   33.0  2015   \n","28593019   229575  18799    24  20150519    16   7000   1    2   33.0  2015   \n","28593027   229653  18799    24  20150618    16   7200   1    2   33.0  2015   \n","28593028   229670  18799    24  20150625    14   9000   1    2   33.0  2015   \n","\n","          분류  분기 제휴사  \n","0         저가   3   A  \n","1         저가   2   A  \n","2         저가   5   A  \n","3         저가   1   A  \n","4         중가   1   A  \n","...       ..  ..  ..  \n","28593015  저가   6   D  \n","28593018  저가   6   D  \n","28593019  저가   6   D  \n","28593027  저가   6   D  \n","28593028  저가   6   D  \n","\n","[21345612 rows x 20 columns]"],"text/html":["\n","  <div id=\"df-c950c026-6cde-40ad-b7e3-54b8aa490354\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","      <th>영수증번호</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>년도</th>\n","      <th>분류</th>\n","      <th>분기</th>\n","      <th>제휴사</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>2757986</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140920</td>\n","      <td>20</td>\n","      <td>1000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>3</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>1878938</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140505</td>\n","      <td>19</td>\n","      <td>15000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>2</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>3436437</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20150102</td>\n","      <td>16</td>\n","      <td>9900</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>5</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","      <td>1385676</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140215</td>\n","      <td>17</td>\n","      <td>7000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>1</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","      <td>1547466</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140315</td>\n","      <td>19</td>\n","      <td>21000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>1</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593015</th>\n","      <td>28593015</td>\n","      <td>6</td>\n","      <td>601</td>\n","      <td>D060108</td>\n","      <td>미용소품</td>\n","      <td>면봉/화장솜</td>\n","      <td>일상용품</td>\n","      <td>229564</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150512</td>\n","      <td>14</td>\n","      <td>2000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593018</th>\n","      <td>28593018</td>\n","      <td>6</td>\n","      <td>602</td>\n","      <td>D060202</td>\n","      <td>양말류</td>\n","      <td>스타킹</td>\n","      <td>전문스포츠/레저</td>\n","      <td>229572</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150515</td>\n","      <td>16</td>\n","      <td>3500</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593019</th>\n","      <td>28593019</td>\n","      <td>6</td>\n","      <td>603</td>\n","      <td>D060301</td>\n","      <td>우산/양산류</td>\n","      <td>장우산</td>\n","      <td>패션잡화</td>\n","      <td>229575</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150519</td>\n","      <td>16</td>\n","      <td>7000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>28593027</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229653</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150618</td>\n","      <td>16</td>\n","      <td>7200</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>28593028</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229670</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150625</td>\n","      <td>14</td>\n","      <td>9000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>21345612 rows × 20 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c950c026-6cde-40ad-b7e3-54b8aa490354')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c950c026-6cde-40ad-b7e3-54b8aa490354 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c950c026-6cde-40ad-b7e3-54b8aa490354');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":14}]},{"cell_type":"markdown","source":["### (1) 멤버십 가입유무\n","가입되어 있으면 1, 아니면 0\n","여러 개에 가입되어 있는 경우도 1로 처리"],"metadata":{"id":"dw-a_-k-oTHE"}},{"cell_type":"code","source":["total_att_train = pd.DataFrame({'고객번호': np.arange(1, 19384)})\n","total_att_train['멤버십유무'] = np.where(np.isin(total_att_train['고객번호'], data_1_train['고객번호']) == True, 1, 0)\n","\n","total_att_test = pd.DataFrame({'고객번호': np.arange(1, 19384)})\n","total_att_test['멤버십유무'] = np.where(np.isin(total_att_test['고객번호'], data_1_train['고객번호']) == True, 1, 0)\n","\n","total_att_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640248135,"user_tz":-540,"elapsed":567,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"b3820eb4-8251-4e45-cb17-205716f15d99","id":"-L7pYFVWoTHF"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무\n","0          1      0\n","1          2      0\n","2          3      0\n","3          4      0\n","4          5      0\n","...      ...    ...\n","19378  19379      1\n","19379  19380      1\n","19380  19381      1\n","19381  19382      0\n","19382  19383      0\n","\n","[19383 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-e650ad7d-0d9d-498a-8609-0917ccf96195\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e650ad7d-0d9d-498a-8609-0917ccf96195')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e650ad7d-0d9d-498a-8609-0917ccf96195 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e650ad7d-0d9d-498a-8609-0917ccf96195');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":48}]},{"cell_type":"markdown","source":["### (2) 온라인 이용 유무"],"metadata":{"id":"-Fqv4swLBopm"}},{"cell_type":"code","source":["total_att_train['온라인유무'] = np.where(np.isin(total_att_train['고객번호'], data_2['고객번호']) == True, 1, 0)\n","total_att_test['온라인유무'] = np.where(np.isin(total_att_test['고객번호'], data_2['고객번호']) == True, 1, 0)\n","total_att_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"RSqYCpwWBpNb","executionInfo":{"status":"ok","timestamp":1672640253964,"user_tz":-540,"elapsed":360,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"46eb7c80-e398-4f45-b623-f8d23292a2af"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무  온라인유무\n","0          1      0      0\n","1          2      0      0\n","2          3      0      0\n","3          4      0      0\n","4          5      0      0\n","...      ...    ...    ...\n","19378  19379      1      0\n","19379  19380      1      1\n","19380  19381      1      1\n","19381  19382      0      1\n","19382  19383      0      0\n","\n","[19383 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-f3f67b2f-746d-4ab9-ba29-c37ff6cfd6e8\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","      <th>온라인유무</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f3f67b2f-746d-4ab9-ba29-c37ff6cfd6e8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f3f67b2f-746d-4ab9-ba29-c37ff6cfd6e8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f3f67b2f-746d-4ab9-ba29-c37ff6cfd6e8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":49}]},{"cell_type":"markdown","source":["### (3) 경쟁사 이용 횟수"],"metadata":{"id":"iaQpSb1vnvy6"}},{"cell_type":"code","source":["compet_train = data_3_train.groupby('고객번호')[['경쟁사']].count()\n","total_att_train = pd.merge(total_att_train, compet_train, on='고객번호', how='left')\n","\n","compet_test = data_3_test.groupby('고객번호')[['경쟁사']].count()\n","total_att_test = pd.merge(total_att_test, compet_test, on='고객번호', how='left')\n","\n","total_att_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640271026,"user_tz":-540,"elapsed":348,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"7097f13d-17d4-4ca1-c07e-6e5e79ff0c4a","id":"uCiaQsCmnvy7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무  온라인유무  경쟁사\n","0          1      0      0  3.0\n","1          2      0      0  2.0\n","2          3      0      0  NaN\n","3          4      0      0  1.0\n","4          5      0      0  NaN\n","...      ...    ...    ...  ...\n","19378  19379      1      0  NaN\n","19379  19380      1      1  NaN\n","19380  19381      1      1  NaN\n","19381  19382      0      1  NaN\n","19382  19383      0      0  NaN\n","\n","[19383 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-499c9ed4-0244-4618-b857-f8063f608b95\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","      <th>온라인유무</th>\n","      <th>경쟁사</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-499c9ed4-0244-4618-b857-f8063f608b95')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-499c9ed4-0244-4618-b857-f8063f608b95 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-499c9ed4-0244-4618-b857-f8063f608b95');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":50}]},{"cell_type":"markdown","source":["### (4) 주말 방문 구매액 비중\n","주말 방문 구매액 / 총 방문 구매액\n","\n","0~1 사이 비중으로 표현"],"metadata":{"id":"A30axJnMnvy7"}},{"cell_type":"code","source":["week_train = total_train.groupby(['고객번호','구매일자'])[['구매금액']].sum()\n","week_train = week_train.reset_index()\n","week_train['구매일자'] = week_train['구매일자'].astype('str')\n","week_train['구매일자'] = pd.to_datetime(week_train['구매일자'])\n","\n","week_test = total_test.groupby(['고객번호','구매일자'])[['구매금액']].sum()\n","week_test = week_test.reset_index()\n","week_test['구매일자'] = week_test['구매일자'].astype('str')\n","week_test['구매일자'] = pd.to_datetime(week_test['구매일자'])\n","\n","week_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640294958,"user_tz":-540,"elapsed":17876,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"69481b4e-8f35-484d-8065-7d627754ecb2","id":"DsfVQ2ZGnvy7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          고객번호       구매일자    구매금액\n","0            1 2014-01-08   42950\n","1            1 2014-01-13   24000\n","2            1 2014-01-14   41020\n","3            1 2014-01-15  132240\n","4            1 2014-01-17   42000\n","...        ...        ...     ...\n","4479838  19382 2015-06-27   16160\n","4479839  19382 2015-06-30   15260\n","4479840  19383 2015-06-13   18000\n","4479841  19383 2015-06-24    7000\n","4479842  19383 2015-06-26    2000\n","\n","[4479843 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-8a02ca94-e9e3-41a6-981e-c7c48a290635\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>구매일자</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>2014-01-08</td>\n","      <td>42950</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>2014-01-13</td>\n","      <td>24000</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>2014-01-14</td>\n","      <td>41020</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>2014-01-15</td>\n","      <td>132240</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>2014-01-17</td>\n","      <td>42000</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4479838</th>\n","      <td>19382</td>\n","      <td>2015-06-27</td>\n","      <td>16160</td>\n","    </tr>\n","    <tr>\n","      <th>4479839</th>\n","      <td>19382</td>\n","      <td>2015-06-30</td>\n","      <td>15260</td>\n","    </tr>\n","    <tr>\n","      <th>4479840</th>\n","      <td>19383</td>\n","      <td>2015-06-13</td>\n","      <td>18000</td>\n","    </tr>\n","    <tr>\n","      <th>4479841</th>\n","      <td>19383</td>\n","      <td>2015-06-24</td>\n","      <td>7000</td>\n","    </tr>\n","    <tr>\n","      <th>4479842</th>\n","      <td>19383</td>\n","      <td>2015-06-26</td>\n","      <td>2000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4479843 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8a02ca94-e9e3-41a6-981e-c7c48a290635')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8a02ca94-e9e3-41a6-981e-c7c48a290635 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8a02ca94-e9e3-41a6-981e-c7c48a290635');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":51}]},{"cell_type":"code","source":["week_train['구매일자'] = week_train['구매일자'].map(lambda x: '평일' if x.weekday() <=4 else '주말')\n","\n","week_test['구매일자'] = week_test['구매일자'].map(lambda x: '평일' if x.weekday() <=4 else '주말')\n","week_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640335312,"user_tz":-540,"elapsed":40365,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"3d883a22-941d-4ab4-baf1-f9e12693ae6f","id":"nVEqc__qnvy7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          고객번호 구매일자    구매금액\n","0            1   평일   42950\n","1            1   평일   24000\n","2            1   평일   41020\n","3            1   평일  132240\n","4            1   평일   42000\n","...        ...  ...     ...\n","4479838  19382   주말   16160\n","4479839  19382   평일   15260\n","4479840  19383   주말   18000\n","4479841  19383   평일    7000\n","4479842  19383   평일    2000\n","\n","[4479843 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-c89b66ab-e1f8-49d2-b092-294309113e4b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>구매일자</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>평일</td>\n","      <td>42950</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>평일</td>\n","      <td>24000</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>평일</td>\n","      <td>41020</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>평일</td>\n","      <td>132240</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>평일</td>\n","      <td>42000</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>4479838</th>\n","      <td>19382</td>\n","      <td>주말</td>\n","      <td>16160</td>\n","    </tr>\n","    <tr>\n","      <th>4479839</th>\n","      <td>19382</td>\n","      <td>평일</td>\n","      <td>15260</td>\n","    </tr>\n","    <tr>\n","      <th>4479840</th>\n","      <td>19383</td>\n","      <td>주말</td>\n","      <td>18000</td>\n","    </tr>\n","    <tr>\n","      <th>4479841</th>\n","      <td>19383</td>\n","      <td>평일</td>\n","      <td>7000</td>\n","    </tr>\n","    <tr>\n","      <th>4479842</th>\n","      <td>19383</td>\n","      <td>평일</td>\n","      <td>2000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>4479843 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c89b66ab-e1f8-49d2-b092-294309113e4b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c89b66ab-e1f8-49d2-b092-294309113e4b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c89b66ab-e1f8-49d2-b092-294309113e4b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":52}]},{"cell_type":"code","source":["week_train = week_train.pivot_table(index='고객번호', columns='구매일자', values='구매금액', aggfunc=sum)\n","week_train['주말구매비중'] = week_train['주말'] / (week_train['주말'] + week_train['평일']) \n","\n","week_test = week_test.pivot_table(index='고객번호', columns='구매일자', values='구매금액', aggfunc=sum)\n","week_test['주말구매비중'] = week_test['주말'] / (week_test['주말'] + week_test['평일']) \n","\n","week_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":455},"executionInfo":{"status":"ok","timestamp":1672640336551,"user_tz":-540,"elapsed":1251,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"9a21073c-bb9e-4e04-8cc4-daca3c6a46b9","id":"f14XPQRTnvy7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["구매일자           주말          평일    주말구매비중\n","고객번호                                   \n","1      20377090.0  51562942.0  0.283251\n","2      26003620.0  48033320.0  0.351225\n","3        384824.0   2101225.0  0.154793\n","4       2766002.0  10190551.0  0.213483\n","5       3983450.0   6637360.0  0.375061\n","...           ...         ...       ...\n","19379    702900.0   2883640.0  0.195983\n","19380    300640.0   1060010.0  0.220953\n","19381    856927.0   1940244.0  0.306355\n","19382    472329.0   1354410.0  0.258564\n","19383     18000.0      9000.0  0.666667\n","\n","[19372 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-cb8c11be-341b-44fc-8481-624a220cef42\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th>구매일자</th>\n","      <th>주말</th>\n","      <th>평일</th>\n","      <th>주말구매비중</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>20377090.0</td>\n","      <td>51562942.0</td>\n","      <td>0.283251</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>26003620.0</td>\n","      <td>48033320.0</td>\n","      <td>0.351225</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>384824.0</td>\n","      <td>2101225.0</td>\n","      <td>0.154793</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2766002.0</td>\n","      <td>10190551.0</td>\n","      <td>0.213483</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>3983450.0</td>\n","      <td>6637360.0</td>\n","      <td>0.375061</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>702900.0</td>\n","      <td>2883640.0</td>\n","      <td>0.195983</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>300640.0</td>\n","      <td>1060010.0</td>\n","      <td>0.220953</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>856927.0</td>\n","      <td>1940244.0</td>\n","      <td>0.306355</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>472329.0</td>\n","      <td>1354410.0</td>\n","      <td>0.258564</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>18000.0</td>\n","      <td>9000.0</td>\n","      <td>0.666667</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cb8c11be-341b-44fc-8481-624a220cef42')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-cb8c11be-341b-44fc-8481-624a220cef42 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-cb8c11be-341b-44fc-8481-624a220cef42');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":53}]},{"cell_type":"code","source":["total_att_train = pd.merge(total_att_train, week_train, on='고객번호')\n","total_att_test = pd.merge(total_att_test, week_test, on='고객번호')"],"metadata":{"id":"ZB2tqXL5nvy7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["total_att_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"AQnWvMXLr7KS","executionInfo":{"status":"ok","timestamp":1672640458208,"user_tz":-540,"elapsed":392,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"516be370-95ba-4997-ee0f-6d801680da6e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무  온라인유무  경쟁사          주말          평일    주말구매비중\n","0          1      0      0  3.0  20377090.0  51562942.0  0.283251\n","1          2      0      0  2.0  26003620.0  48033320.0  0.351225\n","2          3      0      0  NaN    384824.0   2101225.0  0.154793\n","3          4      0      0  1.0   2766002.0  10190551.0  0.213483\n","4          5      0      0  NaN   3983450.0   6637360.0  0.375061\n","...      ...    ...    ...  ...         ...         ...       ...\n","19367  19379      1      0  NaN    702900.0   2883640.0  0.195983\n","19368  19380      1      1  NaN    300640.0   1060010.0  0.220953\n","19369  19381      1      1  NaN    856927.0   1940244.0  0.306355\n","19370  19382      0      1  NaN    472329.0   1354410.0  0.258564\n","19371  19383      0      0  NaN     18000.0      9000.0  0.666667\n","\n","[19372 rows x 7 columns]"],"text/html":["\n","  <div id=\"df-1965ace0-f841-49d8-a4fe-e338ddc90038\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","      <th>온라인유무</th>\n","      <th>경쟁사</th>\n","      <th>주말</th>\n","      <th>평일</th>\n","      <th>주말구매비중</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3.0</td>\n","      <td>20377090.0</td>\n","      <td>51562942.0</td>\n","      <td>0.283251</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","      <td>26003620.0</td>\n","      <td>48033320.0</td>\n","      <td>0.351225</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>384824.0</td>\n","      <td>2101225.0</td>\n","      <td>0.154793</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","      <td>2766002.0</td>\n","      <td>10190551.0</td>\n","      <td>0.213483</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>3983450.0</td>\n","      <td>6637360.0</td>\n","      <td>0.375061</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>702900.0</td>\n","      <td>2883640.0</td>\n","      <td>0.195983</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>300640.0</td>\n","      <td>1060010.0</td>\n","      <td>0.220953</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>856927.0</td>\n","      <td>1940244.0</td>\n","      <td>0.306355</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>472329.0</td>\n","      <td>1354410.0</td>\n","      <td>0.258564</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>18000.0</td>\n","      <td>9000.0</td>\n","      <td>0.666667</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 7 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1965ace0-f841-49d8-a4fe-e338ddc90038')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1965ace0-f841-49d8-a4fe-e338ddc90038 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1965ace0-f841-49d8-a4fe-e338ddc90038');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":58}]},{"cell_type":"markdown","source":["### (5) 카테고리별 구매 비중\n"],"metadata":{"id":"7foY3bHnnvy7"}},{"cell_type":"code","source":["total_cate_train = total_train.pivot_table(index='고객번호', columns='대분류', values='구매금액', aggfunc=sum)\n","total_cate_train = total_cate_train.fillna(0)\n","total_cate_train['총구매액'] = total_cate_train.apply(sum, axis=1)\n","total_cate_train = total_cate_train.reset_index()\n","\n","total_cate_test = total_test.pivot_table(index='고객번호', columns='대분류', values='구매금액', aggfunc=sum)\n","total_cate_test = total_cate_test.fillna(0)\n","total_cate_test['총구매액'] = total_cate_test.apply(sum, axis=1)\n","total_cate_test = total_cate_test.reset_index()\n","\n","total_cate_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":520},"executionInfo":{"status":"ok","timestamp":1672640466553,"user_tz":-540,"elapsed":6108,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"abf18cf9-a2d7-47f9-b3a2-d7e85291bb17","id":"IMYsC70dnvy8"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류     고객번호        가공식품  가구/인테리어    교육/문화용품         기타     디지털/가전       신선식품  \\\n","0          1  10612191.0      0.0   732110.0  2382780.0  5984130.0   586331.0   \n","1          2  12122180.0      0.0  1616140.0   308000.0  6280560.0        0.0   \n","2          3   1442776.0      0.0        0.0        0.0    35690.0   611393.0   \n","3          4   4580740.0      0.0     6000.0   628450.0   992950.0   315983.0   \n","4          5   6829650.0      0.0    74200.0        0.0   422300.0    16000.0   \n","...      ...         ...      ...        ...        ...        ...        ...   \n","19367  19379    398860.0      0.0        0.0        0.0        0.0    36560.0   \n","19368  19380    188200.0      0.0        0.0        0.0        0.0        0.0   \n","19369  19381    745479.0      0.0     1500.0        0.0   129160.0  1244622.0   \n","19370  19382    870367.0      0.0    22070.0     3200.0    42920.0   535672.0   \n","19371  19383      4000.0      0.0        0.0        0.0        0.0        0.0   \n","\n","대분류         음식점          의류  의약품/의료기기        일상용품  전문스포츠/레저        패션잡화  \\\n","0      101200.0  12631220.0       0.0  24218010.0       0.0  14692060.0   \n","1           0.0  11716990.0       0.0  41175510.0    8800.0    808760.0   \n","2       13440.0     80000.0       0.0    302750.0       0.0         0.0   \n","3           0.0   1818610.0       0.0   3065160.0   17500.0   1531160.0   \n","4           0.0    223000.0       0.0   2876960.0       0.0    178700.0   \n","...         ...         ...       ...         ...       ...         ...   \n","19367       0.0    297000.0       0.0   2555970.0   13350.0    284800.0   \n","19368       0.0         0.0       0.0   1172450.0       0.0         0.0   \n","19369   24600.0    393100.0       0.0    196110.0   10000.0     52600.0   \n","19370   53400.0     21000.0       0.0    207410.0       0.0     70700.0   \n","19371       0.0         0.0       0.0     23000.0       0.0         0.0   \n","\n","대분류          총구매액  \n","0      71940032.0  \n","1      74036940.0  \n","2       2486049.0  \n","3      12956553.0  \n","4      10620810.0  \n","...           ...  \n","19367   3586540.0  \n","19368   1360650.0  \n","19369   2797171.0  \n","19370   1826739.0  \n","19371     27000.0  \n","\n","[19372 rows x 14 columns]"],"text/html":["\n","  <div id=\"df-3ae3cdc2-e43d-46ba-9f5d-132ed74a548c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th>대분류</th>\n","      <th>고객번호</th>\n","      <th>가공식품</th>\n","      <th>가구/인테리어</th>\n","      <th>교육/문화용품</th>\n","      <th>기타</th>\n","      <th>디지털/가전</th>\n","      <th>신선식품</th>\n","      <th>음식점</th>\n","      <th>의류</th>\n","      <th>의약품/의료기기</th>\n","      <th>일상용품</th>\n","      <th>전문스포츠/레저</th>\n","      <th>패션잡화</th>\n","      <th>총구매액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>10612191.0</td>\n","      <td>0.0</td>\n","      <td>732110.0</td>\n","      <td>2382780.0</td>\n","      <td>5984130.0</td>\n","      <td>586331.0</td>\n","      <td>101200.0</td>\n","      <td>12631220.0</td>\n","      <td>0.0</td>\n","      <td>24218010.0</td>\n","      <td>0.0</td>\n","      <td>14692060.0</td>\n","      <td>71940032.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>12122180.0</td>\n","      <td>0.0</td>\n","      <td>1616140.0</td>\n","      <td>308000.0</td>\n","      <td>6280560.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>11716990.0</td>\n","      <td>0.0</td>\n","      <td>41175510.0</td>\n","      <td>8800.0</td>\n","      <td>808760.0</td>\n","      <td>74036940.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>1442776.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>35690.0</td>\n","      <td>611393.0</td>\n","      <td>13440.0</td>\n","      <td>80000.0</td>\n","      <td>0.0</td>\n","      <td>302750.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2486049.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>4580740.0</td>\n","      <td>0.0</td>\n","      <td>6000.0</td>\n","      <td>628450.0</td>\n","      <td>992950.0</td>\n","      <td>315983.0</td>\n","      <td>0.0</td>\n","      <td>1818610.0</td>\n","      <td>0.0</td>\n","      <td>3065160.0</td>\n","      <td>17500.0</td>\n","      <td>1531160.0</td>\n","      <td>12956553.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>6829650.0</td>\n","      <td>0.0</td>\n","      <td>74200.0</td>\n","      <td>0.0</td>\n","      <td>422300.0</td>\n","      <td>16000.0</td>\n","      <td>0.0</td>\n","      <td>223000.0</td>\n","      <td>0.0</td>\n","      <td>2876960.0</td>\n","      <td>0.0</td>\n","      <td>178700.0</td>\n","      <td>10620810.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>398860.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>36560.0</td>\n","      <td>0.0</td>\n","      <td>297000.0</td>\n","      <td>0.0</td>\n","      <td>2555970.0</td>\n","      <td>13350.0</td>\n","      <td>284800.0</td>\n","      <td>3586540.0</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>188200.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1172450.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1360650.0</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>745479.0</td>\n","      <td>0.0</td>\n","      <td>1500.0</td>\n","      <td>0.0</td>\n","      <td>129160.0</td>\n","      <td>1244622.0</td>\n","      <td>24600.0</td>\n","      <td>393100.0</td>\n","      <td>0.0</td>\n","      <td>196110.0</td>\n","      <td>10000.0</td>\n","      <td>52600.0</td>\n","      <td>2797171.0</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>870367.0</td>\n","      <td>0.0</td>\n","      <td>22070.0</td>\n","      <td>3200.0</td>\n","      <td>42920.0</td>\n","      <td>535672.0</td>\n","      <td>53400.0</td>\n","      <td>21000.0</td>\n","      <td>0.0</td>\n","      <td>207410.0</td>\n","      <td>0.0</td>\n","      <td>70700.0</td>\n","      <td>1826739.0</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>4000.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>23000.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>27000.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 14 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3ae3cdc2-e43d-46ba-9f5d-132ed74a548c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3ae3cdc2-e43d-46ba-9f5d-132ed74a548c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3ae3cdc2-e43d-46ba-9f5d-132ed74a548c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":59}]},{"cell_type":"code","source":["cate_train['고객번호'] = total_cate_train['고객번호']\n","cate_train['식품구매비중'] = (total_cate_train['가공식품'] + total_cate_train[ '신선식품']) /  total_cate_train[ '총구매액']\n","cate_train['패션구매비중'] = (total_cate_train['의류'] + total_cate_train[ '패션잡화']) /  total_cate_train[ '총구매액']\n","cate_train['취미구매비중'] = (total_cate_train['교육/문화용품'] + total_cate_train[ '전문스포츠/레저']) /  total_cate_train[ '총구매액']\n","cate_train['주거구매비중'] = (total_cate_train['디지털/가전'] + total_cate_train[ '가구/인테리어']) /  total_cate_train[ '총구매액']\n","cate_train\n","\n","cate_test['고객번호'] = total_cate_test['고객번호']\n","cate_test['식품구매비중'] = (total_cate_test['가공식품'] + total_cate_test[ '신선식품']) /  total_cate_test[ '총구매액']\n","cate_test['패션구매비중'] = (total_cate_test['의류'] + total_cate_test[ '패션잡화']) /  total_cate_test[ '총구매액']\n","cate_test['취미구매비중'] = (total_cate_test['교육/문화용품'] + total_cate_test[ '전문스포츠/레저']) /  total_cate_test[ '총구매액']\n","cate_test['주거구매비중'] = (total_cate_test['디지털/가전'] + total_cate_test[ '가구/인테리어']) /  total_cate_test[ '총구매액']\n","\n","cate_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640511356,"user_tz":-540,"elapsed":453,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"33a7a363-f981-4bb4-cd81-a0fbed005d85","id":"ln5QvD_invy8"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       고객번호    식품구매비중    패션구매비중    취미구매비중    주거구매비중\n","0       1.0  0.155665  0.379806  0.010177  0.083182\n","1       2.0  0.163732  0.169182  0.021948  0.084830\n","2       3.0  0.826279  0.032180  0.000000  0.014356\n","3       4.0  0.377934  0.258539  0.001814  0.076637\n","4       5.0  0.644551  0.037822  0.006986  0.039762\n","...     ...       ...       ...       ...       ...\n","19378   NaN       NaN       NaN       NaN       NaN\n","19379   NaN       NaN       NaN       NaN       NaN\n","19380   NaN       NaN       NaN       NaN       NaN\n","19381   NaN       NaN       NaN       NaN       NaN\n","19382   NaN       NaN       NaN       NaN       NaN\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-b9177e81-f80c-46de-aa4e-2ebd957d4dac\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품구매비중</th>\n","      <th>패션구매비중</th>\n","      <th>취미구매비중</th>\n","      <th>주거구매비중</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1.0</td>\n","      <td>0.155665</td>\n","      <td>0.379806</td>\n","      <td>0.010177</td>\n","      <td>0.083182</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2.0</td>\n","      <td>0.163732</td>\n","      <td>0.169182</td>\n","      <td>0.021948</td>\n","      <td>0.084830</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3.0</td>\n","      <td>0.826279</td>\n","      <td>0.032180</td>\n","      <td>0.000000</td>\n","      <td>0.014356</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4.0</td>\n","      <td>0.377934</td>\n","      <td>0.258539</td>\n","      <td>0.001814</td>\n","      <td>0.076637</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5.0</td>\n","      <td>0.644551</td>\n","      <td>0.037822</td>\n","      <td>0.006986</td>\n","      <td>0.039762</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b9177e81-f80c-46de-aa4e-2ebd957d4dac')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b9177e81-f80c-46de-aa4e-2ebd957d4dac button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b9177e81-f80c-46de-aa4e-2ebd957d4dac');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":60}]},{"cell_type":"code","source":["total.query('고객번호==19383 & 구매일자 < 20150701 ')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"WBlEV7l2HaVv","executionInfo":{"status":"ok","timestamp":1672640376645,"user_tz":-540,"elapsed":932,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"739cd4b5-6268-4c20-ff32-ad15c388453c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          Unnamed: 0  대분류코드  중분류코드    소분류코드  중분류명    소분류명   대분류   영수증번호  \\\n","21663479    21663479      1    103  D010301   클렌징  페이셜클렌저  일상용품  237552   \n","21663493    21663493      1    104  D010401  집중케어   페이셜팩류  일상용품  237603   \n","21663571    21663571      4    401  D040108    과자    일반스낵  가공식품  237603   \n","21663589    21663589      4    402  D040202    음료     탄산수  가공식품  237609   \n","21663606    21663606      4    402  D040205    음료   스포츠음료  가공식품  237609   \n","\n","           고객번호  점포코드      구매일자  구매시간   구매금액  성별  연령대   거주지역    년도  분류  분기 제휴사  \n","21663479  19383    30  20150613    16  18000   1    2  500.0  2015  저가   6   D  \n","21663493  19383    30  20150624    23   5000   1    2  500.0  2015  저가   6   D  \n","21663571  19383    30  20150624    23   2000   1    2  500.0  2015  저가   6   D  \n","21663589  19383    30  20150626     9   1000   1    2  500.0  2015  저가   6   D  \n","21663606  19383    30  20150626     9   1000   1    2  500.0  2015  저가   6   D  "],"text/html":["\n","  <div id=\"df-f5d8a709-190c-414a-95d4-1071037a3537\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","      <th>영수증번호</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>년도</th>\n","      <th>분류</th>\n","      <th>분기</th>\n","      <th>제휴사</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>21663479</th>\n","      <td>21663479</td>\n","      <td>1</td>\n","      <td>103</td>\n","      <td>D010301</td>\n","      <td>클렌징</td>\n","      <td>페이셜클렌저</td>\n","      <td>일상용품</td>\n","      <td>237552</td>\n","      <td>19383</td>\n","      <td>30</td>\n","      <td>20150613</td>\n","      <td>16</td>\n","      <td>18000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>500.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>21663493</th>\n","      <td>21663493</td>\n","      <td>1</td>\n","      <td>104</td>\n","      <td>D010401</td>\n","      <td>집중케어</td>\n","      <td>페이셜팩류</td>\n","      <td>일상용품</td>\n","      <td>237603</td>\n","      <td>19383</td>\n","      <td>30</td>\n","      <td>20150624</td>\n","      <td>23</td>\n","      <td>5000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>500.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>21663571</th>\n","      <td>21663571</td>\n","      <td>4</td>\n","      <td>401</td>\n","      <td>D040108</td>\n","      <td>과자</td>\n","      <td>일반스낵</td>\n","      <td>가공식품</td>\n","      <td>237603</td>\n","      <td>19383</td>\n","      <td>30</td>\n","      <td>20150624</td>\n","      <td>23</td>\n","      <td>2000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>500.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>21663589</th>\n","      <td>21663589</td>\n","      <td>4</td>\n","      <td>402</td>\n","      <td>D040202</td>\n","      <td>음료</td>\n","      <td>탄산수</td>\n","      <td>가공식품</td>\n","      <td>237609</td>\n","      <td>19383</td>\n","      <td>30</td>\n","      <td>20150626</td>\n","      <td>9</td>\n","      <td>1000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>500.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>21663606</th>\n","      <td>21663606</td>\n","      <td>4</td>\n","      <td>402</td>\n","      <td>D040205</td>\n","      <td>음료</td>\n","      <td>스포츠음료</td>\n","      <td>가공식품</td>\n","      <td>237609</td>\n","      <td>19383</td>\n","      <td>30</td>\n","      <td>20150626</td>\n","      <td>9</td>\n","      <td>1000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>500.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f5d8a709-190c-414a-95d4-1071037a3537')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f5d8a709-190c-414a-95d4-1071037a3537 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f5d8a709-190c-414a-95d4-1071037a3537');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":57}]},{"cell_type":"code","source":["total_att_train = pd.merge(total_att_train, cate_train, on='고객번호')\n","total_att_test = pd.merge(total_att_test, cate_test, on='고객번호')\n","total_att_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640524037,"user_tz":-540,"elapsed":374,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"dce42f57-8b6d-4c79-cffd-0000dd6cf4b9","id":"KghYe1T_nvy8"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무  온라인유무  경쟁사          주말          평일    주말구매비중    식품구매비중  \\\n","0          1      0      0  3.0  20377090.0  51562942.0  0.283251  0.155665   \n","1          2      0      0  2.0  26003620.0  48033320.0  0.351225  0.163732   \n","2          3      0      0  NaN    384824.0   2101225.0  0.154793  0.826279   \n","3          4      0      0  1.0   2766002.0  10190551.0  0.213483  0.377934   \n","4          5      0      0  NaN   3983450.0   6637360.0  0.375061  0.644551   \n","...      ...    ...    ...  ...         ...         ...       ...       ...   \n","19367  19379      1      0  NaN    702900.0   2883640.0  0.195983  0.121404   \n","19368  19380      1      1  NaN    300640.0   1060010.0  0.220953  0.138316   \n","19369  19381      1      1  NaN    856927.0   1940244.0  0.306355  0.711469   \n","19370  19382      0      1  NaN    472329.0   1354410.0  0.258564  0.769699   \n","19371  19383      0      0  NaN     18000.0      9000.0  0.666667  0.148148   \n","\n","         패션구매비중    취미구매비중    주거구매비중  \n","0      0.379806  0.010177  0.083182  \n","1      0.169182  0.021948  0.084830  \n","2      0.032180  0.000000  0.014356  \n","3      0.258539  0.001814  0.076637  \n","4      0.037822  0.006986  0.039762  \n","...         ...       ...       ...  \n","19367  0.162218  0.003722  0.000000  \n","19368  0.000000  0.000000  0.000000  \n","19369  0.159340  0.004111  0.046175  \n","19370  0.050199  0.012082  0.023495  \n","19371  0.000000  0.000000  0.000000  \n","\n","[19372 rows x 11 columns]"],"text/html":["\n","  <div id=\"df-a434533a-f3ec-4b2f-8644-9af107731916\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","      <th>온라인유무</th>\n","      <th>경쟁사</th>\n","      <th>주말</th>\n","      <th>평일</th>\n","      <th>주말구매비중</th>\n","      <th>식품구매비중</th>\n","      <th>패션구매비중</th>\n","      <th>취미구매비중</th>\n","      <th>주거구매비중</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3.0</td>\n","      <td>20377090.0</td>\n","      <td>51562942.0</td>\n","      <td>0.283251</td>\n","      <td>0.155665</td>\n","      <td>0.379806</td>\n","      <td>0.010177</td>\n","      <td>0.083182</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","      <td>26003620.0</td>\n","      <td>48033320.0</td>\n","      <td>0.351225</td>\n","      <td>0.163732</td>\n","      <td>0.169182</td>\n","      <td>0.021948</td>\n","      <td>0.084830</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>384824.0</td>\n","      <td>2101225.0</td>\n","      <td>0.154793</td>\n","      <td>0.826279</td>\n","      <td>0.032180</td>\n","      <td>0.000000</td>\n","      <td>0.014356</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","      <td>2766002.0</td>\n","      <td>10190551.0</td>\n","      <td>0.213483</td>\n","      <td>0.377934</td>\n","      <td>0.258539</td>\n","      <td>0.001814</td>\n","      <td>0.076637</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>3983450.0</td>\n","      <td>6637360.0</td>\n","      <td>0.375061</td>\n","      <td>0.644551</td>\n","      <td>0.037822</td>\n","      <td>0.006986</td>\n","      <td>0.039762</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>702900.0</td>\n","      <td>2883640.0</td>\n","      <td>0.195983</td>\n","      <td>0.121404</td>\n","      <td>0.162218</td>\n","      <td>0.003722</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>300640.0</td>\n","      <td>1060010.0</td>\n","      <td>0.220953</td>\n","      <td>0.138316</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>856927.0</td>\n","      <td>1940244.0</td>\n","      <td>0.306355</td>\n","      <td>0.711469</td>\n","      <td>0.159340</td>\n","      <td>0.004111</td>\n","      <td>0.046175</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>472329.0</td>\n","      <td>1354410.0</td>\n","      <td>0.258564</td>\n","      <td>0.769699</td>\n","      <td>0.050199</td>\n","      <td>0.012082</td>\n","      <td>0.023495</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>NaN</td>\n","      <td>18000.0</td>\n","      <td>9000.0</td>\n","      <td>0.666667</td>\n","      <td>0.148148</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a434533a-f3ec-4b2f-8644-9af107731916')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a434533a-f3ec-4b2f-8644-9af107731916 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a434533a-f3ec-4b2f-8644-9af107731916');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["total_att_train = total_att_train.fillna(0)\n","total_att_train.to_excel('/content/drive/MyDrive/KDT/2차프로젝트/total_att_train.xlsx')\n","total_att_train"],"metadata":{"executionInfo":{"status":"ok","timestamp":1672640643845,"user_tz":-540,"elapsed":5695,"user":{"displayName":"lily","userId":"08025258415486728638"}},"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"NtezwwWUnvy8","outputId":"46f6d191-22d1-42b5-be12-eee37882746e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무  온라인유무  경쟁사          주말          평일    주말구매비중    식품구매비중  \\\n","0          1      0      0  3.0  20377090.0  51562942.0  0.283251  0.155665   \n","1          2      0      0  2.0  26003620.0  48033320.0  0.351225  0.163732   \n","2          3      0      0  0.0    384824.0   2101225.0  0.154793  0.826279   \n","3          4      0      0  1.0   2766002.0  10190551.0  0.213483  0.377934   \n","4          5      0      0  0.0   3983450.0   6637360.0  0.375061  0.644551   \n","...      ...    ...    ...  ...         ...         ...       ...       ...   \n","19367  19379      1      0  0.0    702900.0   2883640.0  0.195983  0.121404   \n","19368  19380      1      1  0.0    300640.0   1060010.0  0.220953  0.138316   \n","19369  19381      1      1  0.0    856927.0   1940244.0  0.306355  0.711469   \n","19370  19382      0      1  0.0    472329.0   1354410.0  0.258564  0.769699   \n","19371  19383      0      0  0.0     18000.0      9000.0  0.666667  0.148148   \n","\n","         패션구매비중    취미구매비중    주거구매비중  \n","0      0.379806  0.010177  0.083182  \n","1      0.169182  0.021948  0.084830  \n","2      0.032180  0.000000  0.014356  \n","3      0.258539  0.001814  0.076637  \n","4      0.037822  0.006986  0.039762  \n","...         ...       ...       ...  \n","19367  0.162218  0.003722  0.000000  \n","19368  0.000000  0.000000  0.000000  \n","19369  0.159340  0.004111  0.046175  \n","19370  0.050199  0.012082  0.023495  \n","19371  0.000000  0.000000  0.000000  \n","\n","[19372 rows x 11 columns]"],"text/html":["\n","  <div id=\"df-cbf1fda8-7793-438e-aaa3-052c418b320b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","      <th>온라인유무</th>\n","      <th>경쟁사</th>\n","      <th>주말</th>\n","      <th>평일</th>\n","      <th>주말구매비중</th>\n","      <th>식품구매비중</th>\n","      <th>패션구매비중</th>\n","      <th>취미구매비중</th>\n","      <th>주거구매비중</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>3.0</td>\n","      <td>20377090.0</td>\n","      <td>51562942.0</td>\n","      <td>0.283251</td>\n","      <td>0.155665</td>\n","      <td>0.379806</td>\n","      <td>0.010177</td>\n","      <td>0.083182</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","      <td>26003620.0</td>\n","      <td>48033320.0</td>\n","      <td>0.351225</td>\n","      <td>0.163732</td>\n","      <td>0.169182</td>\n","      <td>0.021948</td>\n","      <td>0.084830</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>384824.0</td>\n","      <td>2101225.0</td>\n","      <td>0.154793</td>\n","      <td>0.826279</td>\n","      <td>0.032180</td>\n","      <td>0.000000</td>\n","      <td>0.014356</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","      <td>2766002.0</td>\n","      <td>10190551.0</td>\n","      <td>0.213483</td>\n","      <td>0.377934</td>\n","      <td>0.258539</td>\n","      <td>0.001814</td>\n","      <td>0.076637</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>3983450.0</td>\n","      <td>6637360.0</td>\n","      <td>0.375061</td>\n","      <td>0.644551</td>\n","      <td>0.037822</td>\n","      <td>0.006986</td>\n","      <td>0.039762</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19367</th>\n","      <td>19379</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>702900.0</td>\n","      <td>2883640.0</td>\n","      <td>0.195983</td>\n","      <td>0.121404</td>\n","      <td>0.162218</td>\n","      <td>0.003722</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>19368</th>\n","      <td>19380</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>300640.0</td>\n","      <td>1060010.0</td>\n","      <td>0.220953</td>\n","      <td>0.138316</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>19369</th>\n","      <td>19381</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>856927.0</td>\n","      <td>1940244.0</td>\n","      <td>0.306355</td>\n","      <td>0.711469</td>\n","      <td>0.159340</td>\n","      <td>0.004111</td>\n","      <td>0.046175</td>\n","    </tr>\n","    <tr>\n","      <th>19370</th>\n","      <td>19382</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>472329.0</td>\n","      <td>1354410.0</td>\n","      <td>0.258564</td>\n","      <td>0.769699</td>\n","      <td>0.050199</td>\n","      <td>0.012082</td>\n","      <td>0.023495</td>\n","    </tr>\n","    <tr>\n","      <th>19371</th>\n","      <td>19383</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>18000.0</td>\n","      <td>9000.0</td>\n","      <td>0.666667</td>\n","      <td>0.148148</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19372 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cbf1fda8-7793-438e-aaa3-052c418b320b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-cbf1fda8-7793-438e-aaa3-052c418b320b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-cbf1fda8-7793-438e-aaa3-052c418b320b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":63}]},{"cell_type":"code","source":["total_att_test = total_att_test.fillna(0)\n","total_att_test.to_excel('/content/drive/MyDrive/KDT/2차프로젝트/total_att_test.xlsx')\n","total_att_test"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672640650770,"user_tz":-540,"elapsed":6938,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"81817d45-e1ba-4c44-ba53-eb0845a40cad","id":"LCgohfAunvy8"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  멤버십유무  온라인유무   경쟁사          주말          평일    주말구매비중    식품구매비중  \\\n","0          1      0      0  10.0  21508700.0  58237912.0  0.269713  0.148453   \n","1          2      0      0   4.0  30131020.0  57748520.0  0.342867  0.153350   \n","2          3      0      0   0.0    562124.0   2344942.0  0.193365  0.824122   \n","3          4      0      0   2.0   3278662.0  11805003.0  0.217365  0.380410   \n","4          5      0      0   0.0   3983450.0   6637360.0  0.375061  0.644551   \n","...      ...    ...    ...   ...         ...         ...       ...       ...   \n","19375  19379      1      0   0.0   1018240.0   3373850.0  0.231835  0.118404   \n","19376  19380      1      1   0.0    526160.0   1203397.0  0.304217  0.164514   \n","19377  19381      1      1   0.0   1408327.0   3256345.0  0.301913  0.740348   \n","19378  19382      0      1   0.0    793219.0   2299707.0  0.256462  0.773845   \n","19379  19383      0      0   0.0    573080.0    546280.0  0.511971  0.180818   \n","\n","         패션구매비중    취미구매비중    주거구매비중  \n","0      0.383456  0.009180  0.075039  \n","1      0.155082  0.019309  0.101468  \n","2      0.027519  0.000000  0.015713  \n","3      0.239774  0.002766  0.079003  \n","4      0.037822  0.006986  0.039762  \n","...         ...       ...       ...  \n","19375  0.140662  0.003040  0.000000  \n","19376  0.000000  0.000000  0.000000  \n","19377  0.108046  0.005767  0.032195  \n","19378  0.049371  0.011458  0.021362  \n","19379  0.195916  0.001367  0.004681  \n","\n","[19380 rows x 11 columns]"],"text/html":["\n","  <div id=\"df-1b41dbe3-94e4-4fa5-b608-d25c579b9e2b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>멤버십유무</th>\n","      <th>온라인유무</th>\n","      <th>경쟁사</th>\n","      <th>주말</th>\n","      <th>평일</th>\n","      <th>주말구매비중</th>\n","      <th>식품구매비중</th>\n","      <th>패션구매비중</th>\n","      <th>취미구매비중</th>\n","      <th>주거구매비중</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>10.0</td>\n","      <td>21508700.0</td>\n","      <td>58237912.0</td>\n","      <td>0.269713</td>\n","      <td>0.148453</td>\n","      <td>0.383456</td>\n","      <td>0.009180</td>\n","      <td>0.075039</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>4.0</td>\n","      <td>30131020.0</td>\n","      <td>57748520.0</td>\n","      <td>0.342867</td>\n","      <td>0.153350</td>\n","      <td>0.155082</td>\n","      <td>0.019309</td>\n","      <td>0.101468</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>562124.0</td>\n","      <td>2344942.0</td>\n","      <td>0.193365</td>\n","      <td>0.824122</td>\n","      <td>0.027519</td>\n","      <td>0.000000</td>\n","      <td>0.015713</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>2.0</td>\n","      <td>3278662.0</td>\n","      <td>11805003.0</td>\n","      <td>0.217365</td>\n","      <td>0.380410</td>\n","      <td>0.239774</td>\n","      <td>0.002766</td>\n","      <td>0.079003</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>3983450.0</td>\n","      <td>6637360.0</td>\n","      <td>0.375061</td>\n","      <td>0.644551</td>\n","      <td>0.037822</td>\n","      <td>0.006986</td>\n","      <td>0.039762</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19375</th>\n","      <td>19379</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1018240.0</td>\n","      <td>3373850.0</td>\n","      <td>0.231835</td>\n","      <td>0.118404</td>\n","      <td>0.140662</td>\n","      <td>0.003040</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>19376</th>\n","      <td>19380</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>526160.0</td>\n","      <td>1203397.0</td>\n","      <td>0.304217</td>\n","      <td>0.164514</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>19377</th>\n","      <td>19381</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>1408327.0</td>\n","      <td>3256345.0</td>\n","      <td>0.301913</td>\n","      <td>0.740348</td>\n","      <td>0.108046</td>\n","      <td>0.005767</td>\n","      <td>0.032195</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19382</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>793219.0</td>\n","      <td>2299707.0</td>\n","      <td>0.256462</td>\n","      <td>0.773845</td>\n","      <td>0.049371</td>\n","      <td>0.011458</td>\n","      <td>0.021362</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19383</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>573080.0</td>\n","      <td>546280.0</td>\n","      <td>0.511971</td>\n","      <td>0.180818</td>\n","      <td>0.195916</td>\n","      <td>0.001367</td>\n","      <td>0.004681</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19380 rows × 11 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1b41dbe3-94e4-4fa5-b608-d25c579b9e2b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1b41dbe3-94e4-4fa5-b608-d25c579b9e2b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1b41dbe3-94e4-4fa5-b608-d25c579b9e2b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":64}]},{"cell_type":"markdown","source":["## 4) 변동지수 재설정"],"metadata":{"id":"efIlRqamdYC-"}},{"cell_type":"markdown","source":["#### (1) 데이터 프레임 생성\n","분기/고객별 변동지수 \n","* sales_s_by_q : 분기/고객별 구매금액\n","* aff_c_by_q : 분기/고객/제휴사별 구매횟수\n","* cat_c_by_q : 분기/고객/대분류별 구매횟수\n","* aff_s_by_q : 분기/고객/제휴사별 구매금액\n","* cat_s_by_q : 분기/고객/대분류별 구매금액\n","* price_c_by_q : 분기/고객/분류(고가/중가/저가) 구매횟수\n"],"metadata":{"id":"r_9IoboNdyIa"}},{"cell_type":"code","source":["total = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/total_final.csv')\n","total"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"vfFFXxOZtiDb","executionInfo":{"status":"ok","timestamp":1672809775883,"user_tz":-540,"elapsed":54281,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"5cb1b6fe-641a-47a6-89b7-314b6d54a55b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          Unnamed: 0  대분류코드  중분류코드    소분류코드    중분류명      소분류명   대분류    영수증번호  \\\n","0                  0      1    101  A010101    일용잡화      위생세제  일상용품  2757986   \n","1                  1      1    101  A010101    일용잡화      위생세제  일상용품  1878938   \n","2                  2      1    101  A010101    일용잡화      위생세제  일상용품  3436437   \n","3                  3      1    101  A010103    일용잡화      뷰티상품  일상용품  1385676   \n","4                  4      1    101  A010103    일용잡화      뷰티상품  일상용품  1547466   \n","...              ...    ...    ...      ...     ...       ...   ...      ...   \n","28593025    28593025      8    802  D080204  아이메이크업     아이섀도우  일상용품   229784   \n","28593026    28593026      8    803  D080301   립메이크업  립스틱/립라이너  일상용품   230365   \n","28593027    28593027      8    803  D080302   립메이크업   립글로즈/틴트  일상용품   229653   \n","28593028    28593028      8    803  D080302   립메이크업   립글로즈/틴트  일상용품   229670   \n","28593029    28593029      8    803  D080302   립메이크업   립글로즈/틴트  일상용품   229914   \n","\n","           고객번호  점포코드      구매일자  구매시간   구매금액  성별  연령대   거주지역    년도  분류  분기 제휴사  \n","0         15148    10  20140920    20   1000   1    5  100.0  2014  저가   3   A  \n","1         15148    10  20140505    19  15000   1    5  100.0  2014  저가   2   A  \n","2         15148    10  20150102    16   9900   1    5  100.0  2015  저가   5   A  \n","3         15148    10  20140215    17   7000   1    5  100.0  2014  저가   1   A  \n","4         15148    10  20140315    19  21000   1    5  100.0  2014  중가   1   A  \n","...         ...   ...       ...   ...    ...  ..  ...    ...   ...  ..  ..  ..  \n","28593025  18799    24  20150805    15   9900   1    2   33.0  2015  저가   7   D  \n","28593026  18799    24  20151203    16  11200   1    2   33.0  2015  저가   8   D  \n","28593027  18799    24  20150618    16   7200   1    2   33.0  2015  저가   6   D  \n","28593028  18799    24  20150625    14   9000   1    2   33.0  2015  저가   6   D  \n","28593029  18799    24  20151007    16   9800   1    2   33.0  2015  저가   8   D  \n","\n","[28593030 rows x 20 columns]"],"text/html":["\n","  <div id=\"df-283d6835-6678-40a9-9098-5d4e3c80d951\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","      <th>영수증번호</th>\n","      <th>고객번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>년도</th>\n","      <th>분류</th>\n","      <th>분기</th>\n","      <th>제휴사</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>2757986</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140920</td>\n","      <td>20</td>\n","      <td>1000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>3</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>1878938</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140505</td>\n","      <td>19</td>\n","      <td>15000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>2</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010101</td>\n","      <td>일용잡화</td>\n","      <td>위생세제</td>\n","      <td>일상용품</td>\n","      <td>3436437</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20150102</td>\n","      <td>16</td>\n","      <td>9900</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>5</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","      <td>1385676</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140215</td>\n","      <td>17</td>\n","      <td>7000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>1</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>101</td>\n","      <td>A010103</td>\n","      <td>일용잡화</td>\n","      <td>뷰티상품</td>\n","      <td>일상용품</td>\n","      <td>1547466</td>\n","      <td>15148</td>\n","      <td>10</td>\n","      <td>20140315</td>\n","      <td>19</td>\n","      <td>21000</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>100.0</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>1</td>\n","      <td>A</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>28593025</th>\n","      <td>28593025</td>\n","      <td>8</td>\n","      <td>802</td>\n","      <td>D080204</td>\n","      <td>아이메이크업</td>\n","      <td>아이섀도우</td>\n","      <td>일상용품</td>\n","      <td>229784</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150805</td>\n","      <td>15</td>\n","      <td>9900</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>7</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593026</th>\n","      <td>28593026</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080301</td>\n","      <td>립메이크업</td>\n","      <td>립스틱/립라이너</td>\n","      <td>일상용품</td>\n","      <td>230365</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20151203</td>\n","      <td>16</td>\n","      <td>11200</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>8</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593027</th>\n","      <td>28593027</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229653</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150618</td>\n","      <td>16</td>\n","      <td>7200</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593028</th>\n","      <td>28593028</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229670</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20150625</td>\n","      <td>14</td>\n","      <td>9000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>6</td>\n","      <td>D</td>\n","    </tr>\n","    <tr>\n","      <th>28593029</th>\n","      <td>28593029</td>\n","      <td>8</td>\n","      <td>803</td>\n","      <td>D080302</td>\n","      <td>립메이크업</td>\n","      <td>립글로즈/틴트</td>\n","      <td>일상용품</td>\n","      <td>229914</td>\n","      <td>18799</td>\n","      <td>24</td>\n","      <td>20151007</td>\n","      <td>16</td>\n","      <td>9800</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>33.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>8</td>\n","      <td>D</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28593030 rows × 20 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-283d6835-6678-40a9-9098-5d4e3c80d951')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-283d6835-6678-40a9-9098-5d4e3c80d951 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-283d6835-6678-40a9-9098-5d4e3c80d951');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["sales_s_by_q = total.pivot_table('구매금액', '고객번호', '분기', aggfunc='sum').fillna(0)\n","sales_s_by_q"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":455},"id":"wRkkbMgWAEPo","executionInfo":{"status":"ok","timestamp":1672809947152,"user_tz":-540,"elapsed":2066,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"8ff07f35-1769-4869-fee4-55fa87b62edc"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["분기              1           2           3           4           5          6  \\\n","고객번호                                                                           \n","1       9141590.0  10783765.0  10781550.0  23334762.0   9302985.0  8595380.0   \n","2      14123470.0  10199760.0  14841180.0   7080920.0  18481480.0  9310130.0   \n","3        302782.0    548433.0    648188.0    394366.0    279310.0   312970.0   \n","4       1309643.0   3732463.0   2434410.0   1823100.0   1737292.0  1919645.0   \n","5       3145330.0   2314820.0   1827290.0    398440.0   2124430.0   810500.0   \n","...           ...         ...         ...         ...         ...        ...   \n","19379         0.0         0.0    130300.0   1060320.0   1131020.0  1264900.0   \n","19380         0.0         0.0         0.0    522700.0    486830.0   351120.0   \n","19381         0.0         0.0         0.0         0.0   1124750.0  1672421.0   \n","19382         0.0         0.0         0.0         0.0    786399.0  1040340.0   \n","19383         0.0         0.0         0.0         0.0         0.0    27000.0   \n","\n","분기              7           8  \n","고객번호                           \n","1       7806580.0   5295938.0  \n","2      13842600.0  12001220.0  \n","3        421017.0    258101.0  \n","4       2127112.0   1610145.0  \n","5             0.0   2616260.0  \n","...           ...         ...  \n","19379    805550.0   1387190.0  \n","19380    368907.0   2183420.0  \n","19381   1867501.0   1375997.0  \n","19382   1266187.0   1308847.0  \n","19383   1092360.0   1265040.0  \n","\n","[19383 rows x 8 columns]"],"text/html":["\n","  <div id=\"df-d772ccbe-4ca8-44d5-8de5-7d85bd54f38f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>9141590.0</td>\n","      <td>10783765.0</td>\n","      <td>10781550.0</td>\n","      <td>23334762.0</td>\n","      <td>9302985.0</td>\n","      <td>8595380.0</td>\n","      <td>7806580.0</td>\n","      <td>5295938.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>14123470.0</td>\n","      <td>10199760.0</td>\n","      <td>14841180.0</td>\n","      <td>7080920.0</td>\n","      <td>18481480.0</td>\n","      <td>9310130.0</td>\n","      <td>13842600.0</td>\n","      <td>12001220.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>302782.0</td>\n","      <td>548433.0</td>\n","      <td>648188.0</td>\n","      <td>394366.0</td>\n","      <td>279310.0</td>\n","      <td>312970.0</td>\n","      <td>421017.0</td>\n","      <td>258101.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1309643.0</td>\n","      <td>3732463.0</td>\n","      <td>2434410.0</td>\n","      <td>1823100.0</td>\n","      <td>1737292.0</td>\n","      <td>1919645.0</td>\n","      <td>2127112.0</td>\n","      <td>1610145.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>3145330.0</td>\n","      <td>2314820.0</td>\n","      <td>1827290.0</td>\n","      <td>398440.0</td>\n","      <td>2124430.0</td>\n","      <td>810500.0</td>\n","      <td>0.0</td>\n","      <td>2616260.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>130300.0</td>\n","      <td>1060320.0</td>\n","      <td>1131020.0</td>\n","      <td>1264900.0</td>\n","      <td>805550.0</td>\n","      <td>1387190.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>522700.0</td>\n","      <td>486830.0</td>\n","      <td>351120.0</td>\n","      <td>368907.0</td>\n","      <td>2183420.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1124750.0</td>\n","      <td>1672421.0</td>\n","      <td>1867501.0</td>\n","      <td>1375997.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>786399.0</td>\n","      <td>1040340.0</td>\n","      <td>1266187.0</td>\n","      <td>1308847.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>27000.0</td>\n","      <td>1092360.0</td>\n","      <td>1265040.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 8 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d772ccbe-4ca8-44d5-8de5-7d85bd54f38f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d772ccbe-4ca8-44d5-8de5-7d85bd54f38f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d772ccbe-4ca8-44d5-8de5-7d85bd54f38f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["aff_c_by_q = total.pivot_table('영수증번호', '고객번호', ['제휴사','분기'], aggfunc='nunique').fillna(0)\n","aff_c_by_q"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"id":"WWc814ctJmS3","executionInfo":{"status":"ok","timestamp":1672809956496,"user_tz":-540,"elapsed":6788,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"d913e329-8bdf-43b2-a691-9aa474f8aa45"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["제휴사        A                                                 B       ...  \\\n","분기         1      2     3      4      5     6     7     8    1    2  ...   \n","고객번호                                                                 ...   \n","1       76.0   78.0  95.0  111.0  105.0  68.0  61.0  43.0  1.0  0.0  ...   \n","2      102.0   85.0  95.0   71.0   93.0  64.0  80.0  74.0  1.0  0.0  ...   \n","3        0.0    1.0   0.0    0.0    0.0   0.0   0.0   0.0  0.0  0.0  ...   \n","4       41.0   77.0  47.0   37.0   58.0  54.0  63.0  68.0  0.0  3.0  ...   \n","5      113.0  106.0  59.0   16.0   59.0  19.0   0.0  49.0  1.0  0.0  ...   \n","...      ...    ...   ...    ...    ...   ...   ...   ...  ...  ...  ...   \n","19379    0.0    0.0   0.0    6.0    8.0   4.0   2.0  13.0  0.0  0.0  ...   \n","19380    0.0    0.0   0.0    0.0    0.0   0.0   0.0   3.0  0.0  0.0  ...   \n","19381    0.0    0.0   0.0    0.0    2.0   0.0   2.0   1.0  0.0  0.0  ...   \n","19382    0.0    0.0   0.0    0.0    1.0   3.0   0.0   0.0  0.0  0.0  ...   \n","19383    0.0    0.0   0.0    0.0    0.0   0.0  11.0   7.0  0.0  0.0  ...   \n","\n","제휴사       C          D                                           \n","분기        7     8    1    2    3     4     5     6     7      8  \n","고객번호                                                             \n","1       1.0   3.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0    0.0  \n","2       0.0   0.0  0.0  0.0  0.0   0.0   0.0   6.0   1.0    0.0  \n","3      53.0  47.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0    0.0  \n","4       9.0   6.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0    0.0  \n","5       0.0   0.0  0.0  0.0  0.0   0.0   2.0   1.0   0.0    1.0  \n","...     ...   ...  ...  ...  ...   ...   ...   ...   ...    ...  \n","19379   0.0   0.0  0.0  0.0  8.0  42.0  56.0  69.0  73.0   55.0  \n","19380   3.0  10.0  0.0  0.0  0.0   8.0  36.0  23.0  22.0  125.0  \n","19381   3.0   4.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0    0.0  \n","19382   0.0   1.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0    0.0  \n","19383   1.0   0.0  0.0  0.0  0.0   0.0   0.0   3.0  57.0   49.0  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-d4f06c36-d1ee-4357-a34e-06d992531e87\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>제휴사</th>\n","      <th colspan=\"8\" halign=\"left\">A</th>\n","      <th colspan=\"2\" halign=\"left\">B</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">C</th>\n","      <th colspan=\"8\" halign=\"left\">D</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>76.0</td>\n","      <td>78.0</td>\n","      <td>95.0</td>\n","      <td>111.0</td>\n","      <td>105.0</td>\n","      <td>68.0</td>\n","      <td>61.0</td>\n","      <td>43.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>102.0</td>\n","      <td>85.0</td>\n","      <td>95.0</td>\n","      <td>71.0</td>\n","      <td>93.0</td>\n","      <td>64.0</td>\n","      <td>80.0</td>\n","      <td>74.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>53.0</td>\n","      <td>47.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>41.0</td>\n","      <td>77.0</td>\n","      <td>47.0</td>\n","      <td>37.0</td>\n","      <td>58.0</td>\n","      <td>54.0</td>\n","      <td>63.0</td>\n","      <td>68.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>...</td>\n","      <td>9.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>113.0</td>\n","      <td>106.0</td>\n","      <td>59.0</td>\n","      <td>16.0</td>\n","      <td>59.0</td>\n","      <td>19.0</td>\n","      <td>0.0</td>\n","      <td>49.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>8.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>13.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>8.0</td>\n","      <td>42.0</td>\n","      <td>56.0</td>\n","      <td>69.0</td>\n","      <td>73.0</td>\n","      <td>55.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>3.0</td>\n","      <td>10.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>8.0</td>\n","      <td>36.0</td>\n","      <td>23.0</td>\n","      <td>22.0</td>\n","      <td>125.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>3.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>11.0</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>57.0</td>\n","      <td>49.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d4f06c36-d1ee-4357-a34e-06d992531e87')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d4f06c36-d1ee-4357-a34e-06d992531e87 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d4f06c36-d1ee-4357-a34e-06d992531e87');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["cat_c_by_q = total.pivot_table('영수증번호', '고객번호', ['대분류','분기'], aggfunc='nunique').fillna(0)\n","cat_c_by_q"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"id":"PI9Of0b-as2c","executionInfo":{"status":"ok","timestamp":1672810839217,"user_tz":-540,"elapsed":8022,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"8dfb59cb-cb9d-435a-804e-2778276d70f5"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류    가공식품                                           가구/인테리어       ...  \\\n","분기        1     2     3     4     5     6     7     8       1    2  ...   \n","고객번호                                                                ...   \n","1      34.0  35.0  45.0  59.0  61.0  39.0  25.0  20.0     0.0  0.0  ...   \n","2      54.0  53.0  51.0  50.0  41.0  25.0  34.0  41.0     0.0  0.0  ...   \n","3      49.0  65.0  81.0  64.0  27.0  45.0  44.0  37.0     0.0  0.0  ...   \n","4      34.0  60.0  29.0  33.0  54.0  50.0  58.0  60.0     0.0  0.0  ...   \n","5      96.0  91.0  49.0  16.0  57.0  20.0   0.0  44.0     0.0  0.0  ...   \n","...     ...   ...   ...   ...   ...   ...   ...   ...     ...  ...  ...   \n","19379   0.0   0.0   5.0  21.0  37.0  44.0  50.0  39.0     0.0  0.0  ...   \n","19380   0.0   0.0   0.0   2.0  28.0  14.0  10.0  88.0     0.0  0.0  ...   \n","19381   0.0   0.0   0.0   0.0  35.0  58.0  66.0  58.0     0.0  0.0  ...   \n","19382   0.0   0.0   0.0   0.0  44.0  60.0  88.0  83.0     0.0  0.0  ...   \n","19383   0.0   0.0   0.0   0.0   0.0   2.0  44.0  34.0     0.0  0.0  ...   \n","\n","대분류   전문스포츠/레저      패션잡화                                           \n","분기           7    8    1     2     3    4     5     6     7     8  \n","고객번호                                                               \n","1          0.0  0.0  6.0  10.0  11.0  7.0  11.0  15.0  12.0  13.0  \n","2          0.0  0.0  1.0   0.0   3.0  1.0   0.0   3.0   6.0   5.0  \n","3          0.0  0.0  0.0   0.0   0.0  0.0   0.0   0.0   0.0   0.0  \n","4          1.0  0.0  3.0   7.0  10.0  4.0   2.0   4.0   4.0   7.0  \n","5          0.0  0.0  2.0   2.0   0.0  0.0   0.0   0.0   0.0   1.0  \n","...        ...  ...  ...   ...   ...  ...   ...   ...   ...   ...  \n","19379      0.0  2.0  0.0   0.0   0.0  0.0   3.0   1.0   3.0   3.0  \n","19380      0.0  0.0  0.0   0.0   0.0  0.0   0.0   0.0   0.0   0.0  \n","19381      1.0  2.0  0.0   0.0   0.0  0.0   3.0   2.0   2.0   1.0  \n","19382      0.0  3.0  0.0   0.0   0.0  0.0   4.0   0.0   4.0   4.0  \n","19383      0.0  0.0  0.0   0.0   0.0  0.0   0.0   0.0   4.0   3.0  \n","\n","[19383 rows x 96 columns]"],"text/html":["\n","  <div id=\"df-a077c4d3-12a7-47c1-8901-41b76a831c99\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>대분류</th>\n","      <th colspan=\"8\" halign=\"left\">가공식품</th>\n","      <th colspan=\"2\" halign=\"left\">가구/인테리어</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">전문스포츠/레저</th>\n","      <th colspan=\"8\" halign=\"left\">패션잡화</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>34.0</td>\n","      <td>35.0</td>\n","      <td>45.0</td>\n","      <td>59.0</td>\n","      <td>61.0</td>\n","      <td>39.0</td>\n","      <td>25.0</td>\n","      <td>20.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>10.0</td>\n","      <td>11.0</td>\n","      <td>7.0</td>\n","      <td>11.0</td>\n","      <td>15.0</td>\n","      <td>12.0</td>\n","      <td>13.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>54.0</td>\n","      <td>53.0</td>\n","      <td>51.0</td>\n","      <td>50.0</td>\n","      <td>41.0</td>\n","      <td>25.0</td>\n","      <td>34.0</td>\n","      <td>41.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>49.0</td>\n","      <td>65.0</td>\n","      <td>81.0</td>\n","      <td>64.0</td>\n","      <td>27.0</td>\n","      <td>45.0</td>\n","      <td>44.0</td>\n","      <td>37.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>34.0</td>\n","      <td>60.0</td>\n","      <td>29.0</td>\n","      <td>33.0</td>\n","      <td>54.0</td>\n","      <td>50.0</td>\n","      <td>58.0</td>\n","      <td>60.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>7.0</td>\n","      <td>10.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>96.0</td>\n","      <td>91.0</td>\n","      <td>49.0</td>\n","      <td>16.0</td>\n","      <td>57.0</td>\n","      <td>20.0</td>\n","      <td>0.0</td>\n","      <td>44.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>21.0</td>\n","      <td>37.0</td>\n","      <td>44.0</td>\n","      <td>50.0</td>\n","      <td>39.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>28.0</td>\n","      <td>14.0</td>\n","      <td>10.0</td>\n","      <td>88.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>35.0</td>\n","      <td>58.0</td>\n","      <td>66.0</td>\n","      <td>58.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>44.0</td>\n","      <td>60.0</td>\n","      <td>88.0</td>\n","      <td>83.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>44.0</td>\n","      <td>34.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 96 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a077c4d3-12a7-47c1-8901-41b76a831c99')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a077c4d3-12a7-47c1-8901-41b76a831c99 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a077c4d3-12a7-47c1-8901-41b76a831c99');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["aff_s_by_q = total.pivot_table('구매금액', '고객번호', ['제휴사','분기'], aggfunc='sum').fillna(0)\n","aff_s_by_q"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":585},"executionInfo":{"status":"ok","timestamp":1672810867815,"user_tz":-540,"elapsed":2208,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"0f4c9cc2-3554-4b96-a6de-b0daff416c5b","id":"FxWivqI_S823"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["제휴사             A                                                             \\\n","분기              1           2           3           4           5          6   \n","고객번호                                                                           \n","1       9119790.0  10583420.0  10722160.0  22618140.0   9007070.0  8375680.0   \n","2      14092970.0  10199760.0  14841180.0   7034470.0  18386680.0  9099970.0   \n","3             0.0     80000.0         0.0         0.0         0.0        0.0   \n","4       1246430.0   3381830.0   2183520.0   1528000.0   1624190.0  1546590.0   \n","5       3129330.0   2314820.0   1827290.0    398440.0   2114930.0   802450.0   \n","...           ...         ...         ...         ...         ...        ...   \n","19379         0.0         0.0         0.0    469900.0    396320.0   303500.0   \n","19380         0.0         0.0         0.0         0.0         0.0        0.0   \n","19381         0.0         0.0         0.0         0.0    326100.0        0.0   \n","19382         0.0         0.0         0.0         0.0     49900.0   125200.0   \n","19383         0.0         0.0         0.0         0.0         0.0        0.0   \n","\n","제휴사                                  B           ...         C              D  \\\n","분기              7           8        1        2  ...         7         8    1   \n","고객번호                                             ...                            \n","1       7692890.0   5108000.0  21800.0      0.0  ...    2190.0  114538.0  0.0   \n","2      13798600.0  12001220.0  30500.0      0.0  ...       0.0       0.0  0.0   \n","3             0.0         0.0      0.0      0.0  ...  421017.0  258101.0  0.0   \n","4       1552540.0   1211510.0      0.0  80060.0  ...  105320.0  108485.0  0.0   \n","5             0.0   2586960.0  16000.0      0.0  ...       0.0       0.0  0.0   \n","...           ...         ...      ...      ...  ...       ...       ...  ...   \n","19379     34900.0    805400.0      0.0      0.0  ...       0.0       0.0  0.0   \n","19380         0.0     52300.0      0.0      0.0  ...   42437.0  104400.0  0.0   \n","19381     29000.0     47500.0      0.0      0.0  ...    8540.0   14950.0  0.0   \n","19382         0.0         0.0      0.0      0.0  ...       0.0    7990.0  0.0   \n","19383    594500.0    510300.0      0.0      0.0  ...    8590.0       0.0  0.0   \n","\n","제휴사                                                                      \n","분기       2         3         4         5         6         7          8  \n","고객번호                                                                     \n","1      0.0       0.0       0.0       0.0       0.0       0.0        0.0  \n","2      0.0       0.0       0.0       0.0  172460.0   44000.0        0.0  \n","3      0.0       0.0       0.0       0.0       0.0       0.0        0.0  \n","4      0.0       0.0       0.0       0.0       0.0       0.0        0.0  \n","5      0.0       0.0       0.0    9500.0    8050.0       0.0    29300.0  \n","...    ...       ...       ...       ...       ...       ...        ...  \n","19379  0.0  130300.0  590420.0  656720.0  781520.0  672960.0   581790.0  \n","19380  0.0       0.0  522700.0  486830.0  320840.0  296470.0  2026720.0  \n","19381  0.0       0.0       0.0       0.0       0.0       0.0        0.0  \n","19382  0.0       0.0       0.0       0.0       0.0       0.0        0.0  \n","19383  0.0       0.0       0.0       0.0   27000.0  440670.0   754740.0  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-f41d9c51-6f22-4d2f-8516-2210abf5b81b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>제휴사</th>\n","      <th colspan=\"8\" halign=\"left\">A</th>\n","      <th colspan=\"2\" halign=\"left\">B</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">C</th>\n","      <th colspan=\"8\" halign=\"left\">D</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>9119790.0</td>\n","      <td>10583420.0</td>\n","      <td>10722160.0</td>\n","      <td>22618140.0</td>\n","      <td>9007070.0</td>\n","      <td>8375680.0</td>\n","      <td>7692890.0</td>\n","      <td>5108000.0</td>\n","      <td>21800.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>2190.0</td>\n","      <td>114538.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>14092970.0</td>\n","      <td>10199760.0</td>\n","      <td>14841180.0</td>\n","      <td>7034470.0</td>\n","      <td>18386680.0</td>\n","      <td>9099970.0</td>\n","      <td>13798600.0</td>\n","      <td>12001220.0</td>\n","      <td>30500.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>172460.0</td>\n","      <td>44000.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.0</td>\n","      <td>80000.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>421017.0</td>\n","      <td>258101.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1246430.0</td>\n","      <td>3381830.0</td>\n","      <td>2183520.0</td>\n","      <td>1528000.0</td>\n","      <td>1624190.0</td>\n","      <td>1546590.0</td>\n","      <td>1552540.0</td>\n","      <td>1211510.0</td>\n","      <td>0.0</td>\n","      <td>80060.0</td>\n","      <td>...</td>\n","      <td>105320.0</td>\n","      <td>108485.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>3129330.0</td>\n","      <td>2314820.0</td>\n","      <td>1827290.0</td>\n","      <td>398440.0</td>\n","      <td>2114930.0</td>\n","      <td>802450.0</td>\n","      <td>0.0</td>\n","      <td>2586960.0</td>\n","      <td>16000.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>9500.0</td>\n","      <td>8050.0</td>\n","      <td>0.0</td>\n","      <td>29300.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>469900.0</td>\n","      <td>396320.0</td>\n","      <td>303500.0</td>\n","      <td>34900.0</td>\n","      <td>805400.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>130300.0</td>\n","      <td>590420.0</td>\n","      <td>656720.0</td>\n","      <td>781520.0</td>\n","      <td>672960.0</td>\n","      <td>581790.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>52300.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>42437.0</td>\n","      <td>104400.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>522700.0</td>\n","      <td>486830.0</td>\n","      <td>320840.0</td>\n","      <td>296470.0</td>\n","      <td>2026720.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>326100.0</td>\n","      <td>0.0</td>\n","      <td>29000.0</td>\n","      <td>47500.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>8540.0</td>\n","      <td>14950.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>49900.0</td>\n","      <td>125200.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>7990.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>594500.0</td>\n","      <td>510300.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>8590.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>27000.0</td>\n","      <td>440670.0</td>\n","      <td>754740.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f41d9c51-6f22-4d2f-8516-2210abf5b81b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f41d9c51-6f22-4d2f-8516-2210abf5b81b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f41d9c51-6f22-4d2f-8516-2210abf5b81b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["cat_s_by_q = total.pivot_table('구매금액', '고객번호', ['대분류','분기'], aggfunc='sum').fillna(0)\n","cat_s_by_q"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":585},"executionInfo":{"status":"ok","timestamp":1672810910791,"user_tz":-540,"elapsed":4509,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"c42cbc71-d885-43fa-aab3-764da8cbe718","id":"aUMObZHaS824"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류         가공식품                                                         \\\n","분기             1          2          3          4          5          6   \n","고객번호                                                                      \n","1      1830570.0  2966705.0  1160590.0  1583440.0  1945226.0  1125660.0   \n","2      2907240.0  2691440.0  1844100.0  1835670.0  1903230.0   940500.0   \n","3       206880.0   325020.0   328096.0   258550.0   145810.0   178420.0   \n","4       714193.0  1070903.0   667100.0   413370.0   903280.0   811894.0   \n","5      1834540.0  1508600.0  1099140.0   398440.0  1181280.0   807650.0   \n","...          ...        ...        ...        ...        ...        ...   \n","19379        0.0        0.0    20000.0   117240.0   123010.0   138610.0   \n","19380        0.0        0.0        0.0    16800.0   126180.0    45220.0   \n","19381        0.0        0.0        0.0        0.0   259228.0   486251.0   \n","19382        0.0        0.0        0.0        0.0   335150.0   535217.0   \n","19383        0.0        0.0        0.0        0.0        0.0     4000.0   \n","\n","대분류                         가구/인테리어       ... 전문스포츠/레저                패션잡화  \\\n","분기             7          8       1    2  ...        7        8          1   \n","고객번호                                      ...                                \n","1       640120.0   470748.0     0.0  0.0  ...      0.0      0.0  1948740.0   \n","2      1354190.0  1732140.0     0.0  0.0  ...      0.0      0.0    22900.0   \n","3       202455.0   148882.0     0.0  0.0  ...      0.0      0.0        0.0   \n","4       757449.0   690190.0     0.0  0.0  ...  14700.0      0.0    79600.0   \n","5            0.0  1698920.0     0.0  0.0  ...      0.0      0.0   128800.0   \n","...          ...        ...     ...  ...  ...      ...      ...        ...   \n","19379    84620.0   203150.0     0.0  0.0  ...      0.0  13800.0        0.0   \n","19380    81067.0   353440.0     0.0  0.0  ...      0.0      0.0        0.0   \n","19381   988747.0   610910.0     0.0  0.0  ...   9800.0  13800.0        0.0   \n","19382   641040.0   692486.0     0.0  0.0  ...      0.0  18000.0        0.0   \n","19383   193400.0   211290.0     0.0  0.0  ...      0.0      0.0        0.0   \n","\n","대분류                                                                      \\\n","분기             2          3          4          5          6          7   \n","고객번호                                                                      \n","1      2746430.0  1829420.0  2116590.0  2724710.0  3326170.0  1552230.0   \n","2            0.0   335090.0   278070.0        0.0   172700.0   934540.0   \n","3            0.0        0.0        0.0        0.0        0.0        0.0   \n","4       320350.0   522510.0   305900.0   198000.0   104800.0   158900.0   \n","5        49900.0        0.0        0.0        0.0        0.0        0.0   \n","...          ...        ...        ...        ...        ...        ...   \n","19379        0.0        0.0        0.0   242000.0    42800.0    36000.0   \n","19380        0.0        0.0        0.0        0.0        0.0        0.0   \n","19381        0.0        0.0        0.0    34700.0    17900.0    25400.0   \n","19382        0.0        0.0        0.0    70700.0        0.0    42200.0   \n","19383        0.0        0.0        0.0        0.0        0.0   148900.0   \n","\n","대분류               \n","분기             8  \n","고객번호              \n","1      2928290.0  \n","2       456600.0  \n","3            0.0  \n","4       417250.0  \n","5       113050.0  \n","...          ...  \n","19379   251880.0  \n","19380        0.0  \n","19381     3000.0  \n","19382    36200.0  \n","19383   344200.0  \n","\n","[19383 rows x 96 columns]"],"text/html":["\n","  <div id=\"df-dc91f09a-3c22-45ad-9df9-c2ebae2bbe7f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>대분류</th>\n","      <th colspan=\"8\" halign=\"left\">가공식품</th>\n","      <th colspan=\"2\" halign=\"left\">가구/인테리어</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">전문스포츠/레저</th>\n","      <th colspan=\"8\" halign=\"left\">패션잡화</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>1830570.0</td>\n","      <td>2966705.0</td>\n","      <td>1160590.0</td>\n","      <td>1583440.0</td>\n","      <td>1945226.0</td>\n","      <td>1125660.0</td>\n","      <td>640120.0</td>\n","      <td>470748.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1948740.0</td>\n","      <td>2746430.0</td>\n","      <td>1829420.0</td>\n","      <td>2116590.0</td>\n","      <td>2724710.0</td>\n","      <td>3326170.0</td>\n","      <td>1552230.0</td>\n","      <td>2928290.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2907240.0</td>\n","      <td>2691440.0</td>\n","      <td>1844100.0</td>\n","      <td>1835670.0</td>\n","      <td>1903230.0</td>\n","      <td>940500.0</td>\n","      <td>1354190.0</td>\n","      <td>1732140.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>22900.0</td>\n","      <td>0.0</td>\n","      <td>335090.0</td>\n","      <td>278070.0</td>\n","      <td>0.0</td>\n","      <td>172700.0</td>\n","      <td>934540.0</td>\n","      <td>456600.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>206880.0</td>\n","      <td>325020.0</td>\n","      <td>328096.0</td>\n","      <td>258550.0</td>\n","      <td>145810.0</td>\n","      <td>178420.0</td>\n","      <td>202455.0</td>\n","      <td>148882.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>714193.0</td>\n","      <td>1070903.0</td>\n","      <td>667100.0</td>\n","      <td>413370.0</td>\n","      <td>903280.0</td>\n","      <td>811894.0</td>\n","      <td>757449.0</td>\n","      <td>690190.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>14700.0</td>\n","      <td>0.0</td>\n","      <td>79600.0</td>\n","      <td>320350.0</td>\n","      <td>522510.0</td>\n","      <td>305900.0</td>\n","      <td>198000.0</td>\n","      <td>104800.0</td>\n","      <td>158900.0</td>\n","      <td>417250.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>1834540.0</td>\n","      <td>1508600.0</td>\n","      <td>1099140.0</td>\n","      <td>398440.0</td>\n","      <td>1181280.0</td>\n","      <td>807650.0</td>\n","      <td>0.0</td>\n","      <td>1698920.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>128800.0</td>\n","      <td>49900.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>113050.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>20000.0</td>\n","      <td>117240.0</td>\n","      <td>123010.0</td>\n","      <td>138610.0</td>\n","      <td>84620.0</td>\n","      <td>203150.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>13800.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>242000.0</td>\n","      <td>42800.0</td>\n","      <td>36000.0</td>\n","      <td>251880.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>16800.0</td>\n","      <td>126180.0</td>\n","      <td>45220.0</td>\n","      <td>81067.0</td>\n","      <td>353440.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>259228.0</td>\n","      <td>486251.0</td>\n","      <td>988747.0</td>\n","      <td>610910.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>9800.0</td>\n","      <td>13800.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>34700.0</td>\n","      <td>17900.0</td>\n","      <td>25400.0</td>\n","      <td>3000.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>335150.0</td>\n","      <td>535217.0</td>\n","      <td>641040.0</td>\n","      <td>692486.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>18000.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>70700.0</td>\n","      <td>0.0</td>\n","      <td>42200.0</td>\n","      <td>36200.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4000.0</td>\n","      <td>193400.0</td>\n","      <td>211290.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>148900.0</td>\n","      <td>344200.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 96 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dc91f09a-3c22-45ad-9df9-c2ebae2bbe7f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dc91f09a-3c22-45ad-9df9-c2ebae2bbe7f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dc91f09a-3c22-45ad-9df9-c2ebae2bbe7f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["price_c_by_q = total.pivot_table('영수증번호', '고객번호', ['분류','분기'], aggfunc='nunique').fillna(0)\n","price_c_by_q"],"metadata":{"id":"vEQE46JfatL9","colab":{"base_uri":"https://localhost:8080/","height":568},"executionInfo":{"status":"ok","timestamp":1672815496360,"user_tz":-540,"elapsed":9744,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"4dc02fef-fce0-42d9-fbdb-153545c1f313"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["분류       고가                                              저가        ...        \\\n","분기        1     2     3     4     5     6     7     8     1     2  ...     7   \n","고객번호                                                               ...         \n","1      39.0  42.0  24.0  53.0  32.0  25.0  23.0  13.0  23.0  22.0  ...  23.0   \n","2      57.0  49.0  61.0  31.0  59.0  30.0  44.0  42.0  17.0  21.0  ...  19.0   \n","3       3.0   2.0   4.0   2.0   2.0   1.0   3.0   0.0  55.0  69.0  ...  49.0   \n","4       4.0  18.0  10.0   6.0  10.0   9.0  14.0  11.0  24.0  53.0  ...  45.0   \n","5      22.0  14.0  14.0   5.0  12.0   9.0   0.0  23.0  36.0  52.0  ...   0.0   \n","...     ...   ...   ...   ...   ...   ...   ...   ...   ...   ...  ...   ...   \n","19379   0.0   0.0   1.0   3.0   1.0   1.0   0.0   3.0   0.0   0.0  ...  79.0   \n","19380   0.0   0.0   0.0   2.0   0.0   0.0   1.0   4.0   0.0   0.0  ...  23.0   \n","19381   0.0   0.0   0.0   0.0   6.0  19.0  17.0  15.0   0.0   0.0  ...  72.0   \n","19382   0.0   0.0   0.0   0.0   4.0   4.0   8.0   7.0   0.0   0.0  ...  92.0   \n","19383   0.0   0.0   0.0   0.0   0.0   0.0   4.0   1.0   0.0   0.0  ...  64.0   \n","\n","분류              중가                                            \n","분기         8     1     2     3     4     5     6     7     8  \n","고객번호                                                          \n","1       21.0  36.0  35.0  62.0  64.0  68.0  41.0  25.0  25.0  \n","2       14.0  54.0  42.0  37.0  41.0  36.0  35.0  33.0  33.0  \n","3       41.0  14.0  13.0  25.0  18.0  10.0  13.0  14.0  12.0  \n","4       37.0  32.0  49.0  26.0  28.0  43.0  38.0  36.0  42.0  \n","5       20.0  88.0  79.0  38.0  11.0  42.0  11.0   0.0  28.0  \n","...      ...   ...   ...   ...   ...   ...   ...   ...   ...  \n","19379   54.0   0.0   0.0   1.0  16.0  12.0  13.0  10.0  15.0  \n","19380  120.0   0.0   0.0   0.0   3.0  12.0   6.0   6.0  35.0  \n","19381   73.0   0.0   0.0   0.0   0.0  37.0  60.0  66.0  54.0  \n","19382  119.0   0.0   0.0   0.0   0.0  29.0  46.0  55.0  51.0  \n","19383   47.0   0.0   0.0   0.0   0.0   0.0   0.0   9.0  15.0  \n","\n","[19383 rows x 24 columns]"],"text/html":["\n","  <div id=\"df-473b88a0-0e1f-4f2f-bed9-c3730e0a20cd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>분류</th>\n","      <th colspan=\"8\" halign=\"left\">고가</th>\n","      <th colspan=\"5\" halign=\"left\">저가</th>\n","      <th colspan=\"8\" halign=\"left\">중가</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>39.0</td>\n","      <td>42.0</td>\n","      <td>24.0</td>\n","      <td>53.0</td>\n","      <td>32.0</td>\n","      <td>25.0</td>\n","      <td>23.0</td>\n","      <td>13.0</td>\n","      <td>23.0</td>\n","      <td>22.0</td>\n","      <td>...</td>\n","      <td>23.0</td>\n","      <td>21.0</td>\n","      <td>36.0</td>\n","      <td>35.0</td>\n","      <td>62.0</td>\n","      <td>64.0</td>\n","      <td>68.0</td>\n","      <td>41.0</td>\n","      <td>25.0</td>\n","      <td>25.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>57.0</td>\n","      <td>49.0</td>\n","      <td>61.0</td>\n","      <td>31.0</td>\n","      <td>59.0</td>\n","      <td>30.0</td>\n","      <td>44.0</td>\n","      <td>42.0</td>\n","      <td>17.0</td>\n","      <td>21.0</td>\n","      <td>...</td>\n","      <td>19.0</td>\n","      <td>14.0</td>\n","      <td>54.0</td>\n","      <td>42.0</td>\n","      <td>37.0</td>\n","      <td>41.0</td>\n","      <td>36.0</td>\n","      <td>35.0</td>\n","      <td>33.0</td>\n","      <td>33.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3.0</td>\n","      <td>2.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>55.0</td>\n","      <td>69.0</td>\n","      <td>...</td>\n","      <td>49.0</td>\n","      <td>41.0</td>\n","      <td>14.0</td>\n","      <td>13.0</td>\n","      <td>25.0</td>\n","      <td>18.0</td>\n","      <td>10.0</td>\n","      <td>13.0</td>\n","      <td>14.0</td>\n","      <td>12.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4.0</td>\n","      <td>18.0</td>\n","      <td>10.0</td>\n","      <td>6.0</td>\n","      <td>10.0</td>\n","      <td>9.0</td>\n","      <td>14.0</td>\n","      <td>11.0</td>\n","      <td>24.0</td>\n","      <td>53.0</td>\n","      <td>...</td>\n","      <td>45.0</td>\n","      <td>37.0</td>\n","      <td>32.0</td>\n","      <td>49.0</td>\n","      <td>26.0</td>\n","      <td>28.0</td>\n","      <td>43.0</td>\n","      <td>38.0</td>\n","      <td>36.0</td>\n","      <td>42.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>22.0</td>\n","      <td>14.0</td>\n","      <td>14.0</td>\n","      <td>5.0</td>\n","      <td>12.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>23.0</td>\n","      <td>36.0</td>\n","      <td>52.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>20.0</td>\n","      <td>88.0</td>\n","      <td>79.0</td>\n","      <td>38.0</td>\n","      <td>11.0</td>\n","      <td>42.0</td>\n","      <td>11.0</td>\n","      <td>0.0</td>\n","      <td>28.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>79.0</td>\n","      <td>54.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>16.0</td>\n","      <td>12.0</td>\n","      <td>13.0</td>\n","      <td>10.0</td>\n","      <td>15.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>23.0</td>\n","      <td>120.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>12.0</td>\n","      <td>6.0</td>\n","      <td>6.0</td>\n","      <td>35.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>19.0</td>\n","      <td>17.0</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>72.0</td>\n","      <td>73.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>37.0</td>\n","      <td>60.0</td>\n","      <td>66.0</td>\n","      <td>54.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>8.0</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>92.0</td>\n","      <td>119.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>29.0</td>\n","      <td>46.0</td>\n","      <td>55.0</td>\n","      <td>51.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>64.0</td>\n","      <td>47.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","      <td>15.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 24 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-473b88a0-0e1f-4f2f-bed9-c3730e0a20cd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-473b88a0-0e1f-4f2f-bed9-c3730e0a20cd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-473b88a0-0e1f-4f2f-bed9-c3730e0a20cd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":94}]},{"cell_type":"markdown","source":["#### (2) 함수 생성\n","구매가 없는 고객이 대다수인 경우 인원수대로 등급을 나누면 1,10등급만 존재하는 문제 발생\n","\n","-> 공동 꼴지의 순위를 기준으로 10등급 분할\n","\n","\n","\n"],"metadata":{"id":"clQetCBod-p1"}},{"cell_type":"code","source":["def df2grade2(df):\n","    df_rank = df.rank(ascending=False, method='min').astype('int')\n","    def rank2grade(x):\n","        max_x = x.max()\n","        bins = [0, max_x*0.1, max_x*0.2, max_x*0.3, max_x*0.4, max_x*0.5, max_x*0.6, max_x*0.7, max_x*0.8, max_x*0.9, max_x+1]\n","        labels = [1,2,3,4,5,6,7,8,9,10]\n","        return pd.cut(x, bins=bins, include_lowest=True, right=False, labels=labels)  \n","    \n","    df_grade = df_rank.agg(lambda x : rank2grade(x))\n","\n","    return df_grade"],"metadata":{"id":"g9gszHb5d-p1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df2grade2(aff_c_by_q)\n","# 제휴사 D의 경우 일부만 구매\n","# 2000, 4000.. 을 기준으로 등급을 나눈 경우 대부분 1, 10등급\n","# 각 분기 최대 순위를 기준으로 10등급 분할해서 아래와 같은 등급 조정 결과"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"executionInfo":{"status":"ok","timestamp":1672812501957,"user_tz":-540,"elapsed":565,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"ec3484c0-4eed-42b1-9a11-f679b15fd418","id":"kcFDUCeZd-p2"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["제휴사     A                               B      ...   C       D              \\\n","분기      1   2   3   4   5   6   7   8   1   2  ...   7   8   1   2   3   4   \n","고객번호                                           ...                           \n","1       2   2   1   1   1   3   4   5   9  10  ...   8   7  10  10  10  10   \n","2       1   2   1   3   1   4   2   2   9  10  ...  10  10  10  10  10  10   \n","3      10  10  10  10  10  10  10  10  10  10  ...   4   4  10  10  10  10   \n","4       5   2   5   6   4   5   3   3  10   8  ...   6   6  10  10  10  10   \n","5       1   1   4   7   3   7  10   5   9  10  ...  10  10  10  10  10  10   \n","...    ..  ..  ..  ..  ..  ..  ..  ..  ..  ..  ...  ..  ..  ..  ..  ..  ..   \n","19379  10  10  10   8   7   8   9   7  10  10  ...  10  10  10  10   3   1   \n","19380  10  10  10  10  10  10  10   9  10  10  ...   7   5  10  10  10   3   \n","19381  10  10  10  10   9  10   9  10  10  10  ...   7   7  10  10  10  10   \n","19382  10  10  10  10  10   9  10  10  10  10  ...  10   8  10  10  10  10   \n","19383  10  10  10  10  10  10   7   7  10  10  ...   8  10  10  10  10  10   \n","\n","제휴사                    \n","분기      5   6   7   8  \n","고객번호                   \n","1      10  10  10  10  \n","2      10   3   6  10  \n","3      10  10  10  10  \n","4      10  10  10  10  \n","5       4   6  10   5  \n","...    ..  ..  ..  ..  \n","19379   1   1   1   1  \n","19380   1   1   1   1  \n","19381  10  10  10  10  \n","19382  10  10  10  10  \n","19383  10   4   1   1  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-76adba34-c50c-4a06-9567-6914a8f7529c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>제휴사</th>\n","      <th colspan=\"8\" halign=\"left\">A</th>\n","      <th colspan=\"2\" halign=\"left\">B</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">C</th>\n","      <th colspan=\"8\" halign=\"left\">D</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>3</td>\n","      <td>6</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>10</td>\n","      <td>8</td>\n","      <td>...</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>5</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>10</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>8</td>\n","      <td>9</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>7</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>10</td>\n","      <td>8</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>7</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>8</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>10</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-76adba34-c50c-4a06-9567-6914a8f7529c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-76adba34-c50c-4a06-9567-6914a8f7529c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-76adba34-c50c-4a06-9567-6914a8f7529c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":69}]},{"cell_type":"code","source":["def grade2cv(df_grade, target_quarter, keyword=''):\n","  df_cv = pd.DataFrame(index=df_grade.index)   \n","\n","  if type(df_grade.columns[0]) == tuple:\n","    for column_name in df_grade.columns.levels[0]:\n","      cv = pd.DataFrame(data=(abs(df_grade[column_name].iloc[:,:target_quarter].astype('int').diff(axis=1)).sum(axis=1))*0.2 - \\\n","                (df_grade[column_name].agg(lambda x : x[target_quarter] - x[1],axis=1))*0.8, columns=[column_name+'_'+keyword+'지수'])\n","      df_cv = pd.concat([df_cv, cv], axis=1)\n","  else:\n","    df_cv = pd.DataFrame(data=(abs(df_grade.iloc[:,:target_quarter].astype('int').diff(axis=1)).sum(axis=1))*0.2 + \\\n","                (df_grade.agg(lambda x : x[target_quarter] - x[1],axis=1))*0.8, columns=['변동지수'])\n","\n","  return df_cv.reset_index()"],"metadata":{"id":"PZGAkdl4d-p2"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["#### (3) train 데이터 생성"],"metadata":{"id":"FkSkmbHGf2md"}},{"cell_type":"code","source":["train1 = grade2cv(df2grade2(sales_s_by_q), 6)\n","train1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672812765331,"user_tz":-540,"elapsed":10486,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"c8514a48-76a9-4d4a-aef0-7afa0dbe0889","id":"Fh_9gtULd-p3"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  변동지수\n","0          1   1.0\n","1          2   1.4\n","2          3   0.0\n","3          4   0.6\n","4          5   8.0\n","...      ...   ...\n","19378  19379  -1.2\n","19379  19380   0.0\n","19380  19381  -1.8\n","19381  19382  -0.6\n","19382  19383   0.0\n","\n","[19383 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-616f0d63-2c88-49f0-b1f7-eca89de078bb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>변동지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1.4</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0.6</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>-1.2</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>-0.6</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-616f0d63-2c88-49f0-b1f7-eca89de078bb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-616f0d63-2c88-49f0-b1f7-eca89de078bb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-616f0d63-2c88-49f0-b1f7-eca89de078bb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":71}]},{"cell_type":"code","source":["train2 = grade2cv(df2grade2(aff_c_by_q), 6, '방문')\n","train2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672812804747,"user_tz":-540,"elapsed":39419,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"2b251fd9-871b-4b54-b7d6-95d6cd5beb01","id":"ib3wApbhd-p4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  A_방문지수  B_방문지수  C_방문지수  D_방문지수\n","0          1    -0.2     0.8     4.4     0.0\n","1          2    -0.6     0.4     0.0     7.0\n","2          3     0.0     0.4     0.8     0.0\n","3          4     2.0     3.8     1.8     0.0\n","4          5    -2.0    -0.6     0.0     4.8\n","...      ...     ...     ...     ...     ...\n","19378  19379     2.4     4.0     2.0     9.0\n","19379  19380     0.0     1.0     0.0     9.0\n","19380  19381     0.4     9.0     0.0     0.0\n","19381  19382     1.0     9.0     0.0     0.0\n","19382  19383     0.0     0.0     0.0     6.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-c3ab8545-a678-4bed-805b-3b31c6e356d8\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>A_방문지수</th>\n","      <th>B_방문지수</th>\n","      <th>C_방문지수</th>\n","      <th>D_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>-0.2</td>\n","      <td>0.8</td>\n","      <td>4.4</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-0.6</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2.0</td>\n","      <td>3.8</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-2.0</td>\n","      <td>-0.6</td>\n","      <td>0.0</td>\n","      <td>4.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>2.4</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>0.4</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>1.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c3ab8545-a678-4bed-805b-3b31c6e356d8')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c3ab8545-a678-4bed-805b-3b31c6e356d8 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c3ab8545-a678-4bed-805b-3b31c6e356d8');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":72}]},{"cell_type":"code","source":["train3 = grade2cv(df2grade2(cat_c_by_q), 6, '방문')\n","train3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":502},"executionInfo":{"status":"ok","timestamp":1672812923245,"user_tz":-540,"elapsed":118501,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"52a42aab-a0d5-473f-c80d-f8d0c0a746c8","id":"q9g7xEtgd-p4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  가공식품_방문지수  가구/인테리어_방문지수  교육/문화용품_방문지수  기타_방문지수  디지털/가전_방문지수  \\\n","0          1        1.4           0.0           1.2      1.2          2.6   \n","1          2       -3.6           0.0           2.4      1.6         -1.6   \n","2          3        2.2           0.0           0.0      0.0          1.2   \n","3          4        3.8           0.0           0.8      4.8          5.8   \n","4          5       -2.6           0.0           1.2      0.0          1.2   \n","...      ...        ...           ...           ...      ...          ...   \n","19378  19379        4.0           0.0           0.0      0.0          0.0   \n","19379  19380        0.8           0.0           0.0      0.0          0.0   \n","19380  19381        7.0           0.0           0.8      0.0          7.0   \n","19381  19382        7.0           0.0           6.0      3.0          8.0   \n","19382  19383        0.0           0.0           0.0      0.0          0.0   \n","\n","       신선식품_방문지수  음식점_방문지수  의류_방문지수  의약품/의료기기_방문지수  일상용품_방문지수  전문스포츠/레저_방문지수  \\\n","0            2.4       0.2      0.8            0.0       -3.4            0.0   \n","1            0.0       0.0     -0.2            0.0        2.4            2.4   \n","2            1.4       1.0      0.8            0.0        3.8            0.0   \n","3            1.8       0.0      8.6            0.0        2.6            2.4   \n","4            0.0       0.0      1.2            0.0       -3.6            0.0   \n","...          ...       ...      ...            ...        ...            ...   \n","19378        1.0       0.0      6.0            0.0        9.0            2.4   \n","19379        0.0       0.0      0.0            0.0        2.0            0.0   \n","19380        9.0       6.0      5.6            0.0        3.0            3.2   \n","19381        7.0       7.4      2.0            0.0        4.0            0.0   \n","19382        0.0       0.0      0.0            0.0        0.0            0.0   \n","\n","       패션잡화_방문지수  \n","0            2.4  \n","1            3.4  \n","2            0.0  \n","3            2.0  \n","4           -1.8  \n","...          ...  \n","19378        2.2  \n","19379        0.0  \n","19380        2.8  \n","19381        2.0  \n","19382        0.0  \n","\n","[19383 rows x 13 columns]"],"text/html":["\n","  <div id=\"df-821a556f-bbd1-455c-a256-0db5ad0cd4b5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>가공식품_방문지수</th>\n","      <th>가구/인테리어_방문지수</th>\n","      <th>교육/문화용품_방문지수</th>\n","      <th>기타_방문지수</th>\n","      <th>디지털/가전_방문지수</th>\n","      <th>신선식품_방문지수</th>\n","      <th>음식점_방문지수</th>\n","      <th>의류_방문지수</th>\n","      <th>의약품/의료기기_방문지수</th>\n","      <th>일상용품_방문지수</th>\n","      <th>전문스포츠/레저_방문지수</th>\n","      <th>패션잡화_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1.4</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>2.6</td>\n","      <td>2.4</td>\n","      <td>0.2</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>-3.4</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-3.6</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>1.6</td>\n","      <td>-1.6</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-0.2</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>2.4</td>\n","      <td>3.4</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>2.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>1.4</td>\n","      <td>1.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>3.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>3.8</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>4.8</td>\n","      <td>5.8</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","      <td>8.6</td>\n","      <td>0.0</td>\n","      <td>2.6</td>\n","      <td>2.4</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-2.6</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>-3.6</td>\n","      <td>0.0</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","      <td>2.4</td>\n","      <td>2.2</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>9.0</td>\n","      <td>6.0</td>\n","      <td>5.6</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>3.2</td>\n","      <td>2.8</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>3.0</td>\n","      <td>8.0</td>\n","      <td>7.0</td>\n","      <td>7.4</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 13 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-821a556f-bbd1-455c-a256-0db5ad0cd4b5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-821a556f-bbd1-455c-a256-0db5ad0cd4b5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-821a556f-bbd1-455c-a256-0db5ad0cd4b5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":73}]},{"cell_type":"code","source":["train4 = grade2cv(df2grade2(aff_s_by_q), 6, '구매')\n","train4"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672813355885,"user_tz":-540,"elapsed":39793,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"f1a051b3-3b6b-4afe-c3dc-27eec46254aa","id":"NksOkvYSd-p4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  A_구매지수  B_구매지수  C_구매지수  D_구매지수\n","0          1     0.4     1.2     6.2     0.0\n","1          2     0.6     0.4     0.0     8.0\n","2          3     0.4     0.0     0.4     0.0\n","3          4     0.8     3.4     3.0     0.0\n","4          5    -0.6     0.0     0.0     2.0\n","...      ...     ...     ...     ...     ...\n","19378  19379     2.0     2.0     2.0     9.0\n","19379  19380     0.0     0.0     0.0     9.0\n","19380  19381     0.8     8.0     0.0     0.0\n","19381  19382     1.0     5.0     0.0     0.0\n","19382  19383     0.0     0.0     0.0     4.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-57ce9720-1887-44e9-9873-2341db4ef9bb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>A_구매지수</th>\n","      <th>B_구매지수</th>\n","      <th>C_구매지수</th>\n","      <th>D_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.4</td>\n","      <td>1.2</td>\n","      <td>6.2</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0.6</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0.8</td>\n","      <td>3.4</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-0.6</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>0.8</td>\n","      <td>8.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>1.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-57ce9720-1887-44e9-9873-2341db4ef9bb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-57ce9720-1887-44e9-9873-2341db4ef9bb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-57ce9720-1887-44e9-9873-2341db4ef9bb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":79}]},{"cell_type":"code","source":["train5 = grade2cv(df2grade2(cat_s_by_q), 6, '구매')\n","train5"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":502},"executionInfo":{"status":"ok","timestamp":1672813478459,"user_tz":-540,"elapsed":122587,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"065f0add-f2d0-4763-bd8c-62d11912892f","id":"j0L7AB38d-p5"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  가공식품_구매지수  가구/인테리어_구매지수  교육/문화용품_구매지수  기타_구매지수  디지털/가전_구매지수  \\\n","0          1       -0.4           0.0           4.6      1.4          1.4   \n","1          2       -1.8           0.0           0.8      3.2          0.0   \n","2          3        0.4           0.0           0.0      0.0          0.8   \n","3          4        2.8           0.0           0.4      6.0         10.6   \n","4          5        0.0           0.0           2.0      0.0          3.2   \n","...      ...        ...           ...           ...      ...          ...   \n","19378  19379        0.0           0.0           0.0      0.0          0.0   \n","19379  19380        0.0           0.0           0.0      0.0          0.0   \n","19380  19381        2.0           0.0           0.0      0.0          7.0   \n","19381  19382        3.0           0.0           2.0      0.0          3.0   \n","19382  19383        0.0           0.0           0.0      0.0          0.0   \n","\n","       신선식품_구매지수  음식점_구매지수  의류_구매지수  의약품/의료기기_구매지수  일상용품_구매지수  전문스포츠/레저_구매지수  \\\n","0            3.6       4.0      0.4            0.0       -3.6            0.0   \n","1            0.0       0.0     -1.2            0.0        0.4            1.6   \n","2            0.2       1.2      1.2            0.0        0.4            0.0   \n","3            2.2       0.0      7.2            0.0        0.0            2.8   \n","4            0.0       0.0      2.0            0.0       -1.4            0.0   \n","...          ...       ...      ...            ...        ...            ...   \n","19378        1.0       0.0      5.0            0.0        6.4            2.0   \n","19379        0.0       0.0      0.0            0.0        4.4            0.0   \n","19380        9.0       5.0      3.0            0.0        1.0            2.0   \n","19381        6.0       7.0      0.4            0.0        1.0            0.0   \n","19382        0.0       0.0      0.0            0.0        0.0            0.0   \n","\n","       패션잡화_구매지수  \n","0            1.4  \n","1            5.8  \n","2            0.0  \n","3            2.6  \n","4           -1.8  \n","...          ...  \n","19378        2.6  \n","19379        0.0  \n","19380        0.4  \n","19381        0.8  \n","19382        0.0  \n","\n","[19383 rows x 13 columns]"],"text/html":["\n","  <div id=\"df-a4188b09-968e-4f00-b803-11ff17d0b823\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>가공식품_구매지수</th>\n","      <th>가구/인테리어_구매지수</th>\n","      <th>교육/문화용품_구매지수</th>\n","      <th>기타_구매지수</th>\n","      <th>디지털/가전_구매지수</th>\n","      <th>신선식품_구매지수</th>\n","      <th>음식점_구매지수</th>\n","      <th>의류_구매지수</th>\n","      <th>의약품/의료기기_구매지수</th>\n","      <th>일상용품_구매지수</th>\n","      <th>전문스포츠/레저_구매지수</th>\n","      <th>패션잡화_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>-0.4</td>\n","      <td>0.0</td>\n","      <td>4.6</td>\n","      <td>1.4</td>\n","      <td>1.4</td>\n","      <td>3.6</td>\n","      <td>4.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>-3.6</td>\n","      <td>0.0</td>\n","      <td>1.4</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-1.8</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>1.6</td>\n","      <td>5.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>0.2</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2.8</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>6.0</td>\n","      <td>10.6</td>\n","      <td>2.2</td>\n","      <td>0.0</td>\n","      <td>7.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.8</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>-1.4</td>\n","      <td>0.0</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>6.4</td>\n","      <td>2.0</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>9.0</td>\n","      <td>5.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","      <td>0.4</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>7.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 13 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a4188b09-968e-4f00-b803-11ff17d0b823')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a4188b09-968e-4f00-b803-11ff17d0b823 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a4188b09-968e-4f00-b803-11ff17d0b823');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":80}]},{"cell_type":"code","source":["train5 = grade2cv(df2grade2(cat_s_by_q), 6, '구매')\n","train5"],"metadata":{"id":"2sgFa-ShlAJR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train = pd.merge(pd.merge(pd.merge(pd.merge(train1, train2, on='고객번호', how='outer'), train3, on='고객번호', how='outer'), \n","                          train4, on='고객번호', how='outer'), train5, on='고객번호', how='outer')\n","train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":554},"executionInfo":{"status":"ok","timestamp":1672813478460,"user_tz":-540,"elapsed":8,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"78a366bd-8d73-42ac-c902-fc195234af60","id":"xk3dhL9Yd-p5"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  변동지수  A_방문지수  B_방문지수  C_방문지수  D_방문지수  가공식품_방문지수  가구/인테리어_방문지수  \\\n","0          1   1.0    -0.2     0.8     4.4     0.0        1.4           0.0   \n","1          2   1.4    -0.6     0.4     0.0     7.0       -3.6           0.0   \n","2          3   0.0     0.0     0.4     0.8     0.0        2.2           0.0   \n","3          4   0.6     2.0     3.8     1.8     0.0        3.8           0.0   \n","4          5   8.0    -2.0    -0.6     0.0     4.8       -2.6           0.0   \n","...      ...   ...     ...     ...     ...     ...        ...           ...   \n","19378  19379  -1.2     2.4     4.0     2.0     9.0        4.0           0.0   \n","19379  19380   0.0     0.0     1.0     0.0     9.0        0.8           0.0   \n","19380  19381  -1.8     0.4     9.0     0.0     0.0        7.0           0.0   \n","19381  19382  -0.6     1.0     9.0     0.0     0.0        7.0           0.0   \n","19382  19383   0.0     0.0     0.0     0.0     6.0        0.0           0.0   \n","\n","       교육/문화용품_방문지수  기타_방문지수  ...  교육/문화용품_구매지수  기타_구매지수  디지털/가전_구매지수  \\\n","0               1.2      1.2  ...           4.6      1.4          1.4   \n","1               2.4      1.6  ...           0.8      3.2          0.0   \n","2               0.0      0.0  ...           0.0      0.0          0.8   \n","3               0.8      4.8  ...           0.4      6.0         10.6   \n","4               1.2      0.0  ...           2.0      0.0          3.2   \n","...             ...      ...  ...           ...      ...          ...   \n","19378           0.0      0.0  ...           0.0      0.0          0.0   \n","19379           0.0      0.0  ...           0.0      0.0          0.0   \n","19380           0.8      0.0  ...           0.0      0.0          7.0   \n","19381           6.0      3.0  ...           2.0      0.0          3.0   \n","19382           0.0      0.0  ...           0.0      0.0          0.0   \n","\n","       신선식품_구매지수  음식점_구매지수  의류_구매지수  의약품/의료기기_구매지수  일상용품_구매지수  전문스포츠/레저_구매지수  \\\n","0            3.6       4.0      0.4            0.0       -3.6            0.0   \n","1            0.0       0.0     -1.2            0.0        0.4            1.6   \n","2            0.2       1.2      1.2            0.0        0.4            0.0   \n","3            2.2       0.0      7.2            0.0        0.0            2.8   \n","4            0.0       0.0      2.0            0.0       -1.4            0.0   \n","...          ...       ...      ...            ...        ...            ...   \n","19378        1.0       0.0      5.0            0.0        6.4            2.0   \n","19379        0.0       0.0      0.0            0.0        4.4            0.0   \n","19380        9.0       5.0      3.0            0.0        1.0            2.0   \n","19381        6.0       7.0      0.4            0.0        1.0            0.0   \n","19382        0.0       0.0      0.0            0.0        0.0            0.0   \n","\n","       패션잡화_구매지수  \n","0            1.4  \n","1            5.8  \n","2            0.0  \n","3            2.6  \n","4           -1.8  \n","...          ...  \n","19378        2.6  \n","19379        0.0  \n","19380        0.4  \n","19381        0.8  \n","19382        0.0  \n","\n","[19383 rows x 34 columns]"],"text/html":["\n","  <div id=\"df-a8db565d-a387-476c-8d60-b71dea7244c0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>변동지수</th>\n","      <th>A_방문지수</th>\n","      <th>B_방문지수</th>\n","      <th>C_방문지수</th>\n","      <th>D_방문지수</th>\n","      <th>가공식품_방문지수</th>\n","      <th>가구/인테리어_방문지수</th>\n","      <th>교육/문화용품_방문지수</th>\n","      <th>기타_방문지수</th>\n","      <th>...</th>\n","      <th>교육/문화용품_구매지수</th>\n","      <th>기타_구매지수</th>\n","      <th>디지털/가전_구매지수</th>\n","      <th>신선식품_구매지수</th>\n","      <th>음식점_구매지수</th>\n","      <th>의류_구매지수</th>\n","      <th>의약품/의료기기_구매지수</th>\n","      <th>일상용품_구매지수</th>\n","      <th>전문스포츠/레저_구매지수</th>\n","      <th>패션잡화_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1.0</td>\n","      <td>-0.2</td>\n","      <td>0.8</td>\n","      <td>4.4</td>\n","      <td>0.0</td>\n","      <td>1.4</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>...</td>\n","      <td>4.6</td>\n","      <td>1.4</td>\n","      <td>1.4</td>\n","      <td>3.6</td>\n","      <td>4.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>-3.6</td>\n","      <td>0.0</td>\n","      <td>1.4</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1.4</td>\n","      <td>-0.6</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>-3.6</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>1.6</td>\n","      <td>...</td>\n","      <td>0.8</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>1.6</td>\n","      <td>5.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>2.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>0.2</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0.6</td>\n","      <td>2.0</td>\n","      <td>3.8</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","      <td>3.8</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>4.8</td>\n","      <td>...</td>\n","      <td>0.4</td>\n","      <td>6.0</td>\n","      <td>10.6</td>\n","      <td>2.2</td>\n","      <td>0.0</td>\n","      <td>7.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.8</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>8.0</td>\n","      <td>-2.0</td>\n","      <td>-0.6</td>\n","      <td>0.0</td>\n","      <td>4.8</td>\n","      <td>-2.6</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>-1.4</td>\n","      <td>0.0</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>-1.2</td>\n","      <td>2.4</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>9.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>6.4</td>\n","      <td>2.0</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>-1.8</td>\n","      <td>0.4</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>9.0</td>\n","      <td>5.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","      <td>0.4</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>-0.6</td>\n","      <td>1.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>3.0</td>\n","      <td>...</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>7.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 34 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a8db565d-a387-476c-8d60-b71dea7244c0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a8db565d-a387-476c-8d60-b71dea7244c0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a8db565d-a387-476c-8d60-b71dea7244c0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":81}]},{"cell_type":"code","source":["train.to_csv('/content/drive/MyDrive/KDT/2차프로젝트/cv_data_train.csv')"],"metadata":{"id":"teDTVJMvd-p5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# price별 추가\n","train6 = grade2cv(df2grade2(price_c_by_q), 6, '구매')\n","train6.to_csv('/content/drive/MyDrive/KDT/2차프로젝트/price_cv_data_train.csv')\n","train6"],"metadata":{"id":"AdJQ7ji6lIoZ"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["#### (4) test 데이터 생성"],"metadata":{"id":"t4v6qlGQf609"}},{"cell_type":"code","source":["test1 = grade2cv(df2grade2(sales_s_by_q), 7)\n","test1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672814272265,"user_tz":-540,"elapsed":11015,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"9e8929c1-0dd8-4aa8-f40c-b3f58457ede0","id":"Y5ZCoEW1f609"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  변동지수\n","0          1   1.0\n","1          2   0.8\n","2          3   0.0\n","3          4   0.0\n","4          5   8.0\n","...      ...   ...\n","19378  19379   0.8\n","19379  19380   0.0\n","19380  19381  -2.4\n","19381  19382  -1.2\n","19382  19383  -0.6\n","\n","[19383 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-f37775c6-1e3d-4785-9f73-bc2899987cef\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>변동지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>-2.4</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>-1.2</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>-0.6</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f37775c6-1e3d-4785-9f73-bc2899987cef')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f37775c6-1e3d-4785-9f73-bc2899987cef button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f37775c6-1e3d-4785-9f73-bc2899987cef');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":84}]},{"cell_type":"code","source":["test2 = grade2cv(df2grade2(aff_c_by_q), 7, '방문')\n","test2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672814318661,"user_tz":-540,"elapsed":40984,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"982c992f-4c3f-4551-ba37-57b06b27968e","id":"q2j1AGIWf609"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  A_방문지수  B_방문지수  C_방문지수  D_방문지수\n","0          1    -0.8     2.8     3.2     0.0\n","1          2     1.4    -0.2     0.0     5.2\n","2          3     0.0     0.4     0.8     0.0\n","3          4     4.0     3.8     1.8     0.0\n","4          5    -3.8    -0.6     0.0     2.4\n","...      ...     ...     ...     ...     ...\n","19378  19379     1.8     3.4     0.8     9.0\n","19379  19380     0.0     1.0     3.0     9.0\n","19380  19381     1.4     9.0     3.0     0.0\n","19381  19382     0.4     9.0     0.0     0.0\n","19382  19383     3.0     2.0     2.0     9.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-1d327d8a-931c-4b2f-8100-bd64f61cf062\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>A_방문지수</th>\n","      <th>B_방문지수</th>\n","      <th>C_방문지수</th>\n","      <th>D_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>-0.8</td>\n","      <td>2.8</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1.4</td>\n","      <td>-0.2</td>\n","      <td>0.0</td>\n","      <td>5.2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>4.0</td>\n","      <td>3.8</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-3.8</td>\n","      <td>-0.6</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>1.8</td>\n","      <td>3.4</td>\n","      <td>0.8</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>1.4</td>\n","      <td>9.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>0.4</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>3.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>9.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1d327d8a-931c-4b2f-8100-bd64f61cf062')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1d327d8a-931c-4b2f-8100-bd64f61cf062 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1d327d8a-931c-4b2f-8100-bd64f61cf062');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":85}]},{"cell_type":"code","source":["test3 = grade2cv(df2grade2(cat_c_by_q), 7, '방문')\n","test3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":537},"executionInfo":{"status":"ok","timestamp":1672814446342,"user_tz":-540,"elapsed":121290,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"f7b452f4-cbfc-4477-e963-ff7ee1cd987a","id":"JaC5vSMVf609"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  가공식품_방문지수  가구/인테리어_방문지수  교육/문화용품_방문지수  기타_방문지수  디지털/가전_방문지수  \\\n","0          1        0.2           0.0           0.0      5.2          0.2   \n","1          2       -2.6           0.0           6.4      6.6          3.4   \n","2          3        1.6           0.0           0.0      0.0          4.2   \n","3          4        5.8           7.0           2.8      9.8          6.8   \n","4          5       -2.6           0.0           1.2      0.0          1.2   \n","...      ...        ...           ...           ...      ...          ...   \n","19378  19379        5.0           0.0           0.0      0.0          0.0   \n","19379  19380        0.8           0.0           0.0      0.0          0.0   \n","19380  19381        7.0           0.0           4.8      0.0          5.8   \n","19381  19382        9.0           0.0           6.0      1.2          6.8   \n","19382  19383        4.0           0.0           2.0      0.0          3.0   \n","\n","       신선식품_방문지수  음식점_방문지수  의류_방문지수  의약품/의료기기_방문지수  일상용품_방문지수  전문스포츠/레저_방문지수  \\\n","0            1.2       6.2      1.8            0.0       -2.4            0.0   \n","1            0.0       0.0      0.8            0.0        1.2            2.4   \n","2            2.4       1.0      0.8            0.0        3.2            0.0   \n","3            1.8       0.0      7.4            0.0        2.0            9.4   \n","4            0.0       0.0      1.2            0.0       -3.6            0.0   \n","...          ...       ...      ...            ...        ...            ...   \n","19378        0.4       0.0      2.4            0.0        8.4            2.4   \n","19379        1.0       0.0      0.0            0.0        3.0            0.0   \n","19380        8.4       9.0      6.6            0.0        5.0           10.2   \n","19381        9.0       8.4      7.0            0.0        3.4            0.0   \n","19382        0.0       0.0      3.0            0.0        8.0            0.0   \n","\n","       패션잡화_방문지수  \n","0            1.8  \n","1            6.4  \n","2            0.0  \n","3            3.0  \n","4           -1.8  \n","...          ...  \n","19378        5.2  \n","19379        0.0  \n","19380        3.8  \n","19381        7.0  \n","19382        5.0  \n","\n","[19383 rows x 13 columns]"],"text/html":["\n","  <div id=\"df-97d36f36-0236-4381-b9f3-45b663ab3785\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>가공식품_방문지수</th>\n","      <th>가구/인테리어_방문지수</th>\n","      <th>교육/문화용품_방문지수</th>\n","      <th>기타_방문지수</th>\n","      <th>디지털/가전_방문지수</th>\n","      <th>신선식품_방문지수</th>\n","      <th>음식점_방문지수</th>\n","      <th>의류_방문지수</th>\n","      <th>의약품/의료기기_방문지수</th>\n","      <th>일상용품_방문지수</th>\n","      <th>전문스포츠/레저_방문지수</th>\n","      <th>패션잡화_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.2</td>\n","      <td>0.2</td>\n","      <td>1.2</td>\n","      <td>6.2</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","      <td>-2.4</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-2.6</td>\n","      <td>0.0</td>\n","      <td>6.4</td>\n","      <td>6.6</td>\n","      <td>3.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>2.4</td>\n","      <td>6.4</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>1.6</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4.2</td>\n","      <td>2.4</td>\n","      <td>1.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>5.8</td>\n","      <td>7.0</td>\n","      <td>2.8</td>\n","      <td>9.8</td>\n","      <td>6.8</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","      <td>7.4</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>9.4</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-2.6</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>-3.6</td>\n","      <td>0.0</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>0.0</td>\n","      <td>8.4</td>\n","      <td>2.4</td>\n","      <td>5.2</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>4.8</td>\n","      <td>0.0</td>\n","      <td>5.8</td>\n","      <td>8.4</td>\n","      <td>9.0</td>\n","      <td>6.6</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>10.2</td>\n","      <td>3.8</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>1.2</td>\n","      <td>6.8</td>\n","      <td>9.0</td>\n","      <td>8.4</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>3.4</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>8.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 13 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-97d36f36-0236-4381-b9f3-45b663ab3785')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-97d36f36-0236-4381-b9f3-45b663ab3785 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-97d36f36-0236-4381-b9f3-45b663ab3785');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":86}]},{"cell_type":"code","source":["test4 = grade2cv(df2grade2(aff_s_by_q), 7, '구매')\n","test4"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1672814487248,"user_tz":-540,"elapsed":40912,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"5cd3b9e6-fe81-43d4-d87c-39fbb4286ac9","id":"jQiUj5Omf60-"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  A_구매지수  B_구매지수  C_구매지수  D_구매지수\n","0          1     0.4     2.2     3.2     0.0\n","1          2     1.6     0.4     0.0     6.8\n","2          3     0.4     0.0     0.4     0.0\n","3          4     0.8     4.4     3.0     0.0\n","4          5    -2.4     0.0     0.0     0.8\n","...      ...     ...     ...     ...     ...\n","19378  19379     0.8     1.4     0.8     9.0\n","19379  19380     0.0     0.0     3.0     9.0\n","19380  19381     0.8     8.0     1.0     0.0\n","19381  19382     0.4     6.0     0.0     0.0\n","19382  19383     3.0     1.0     1.0     9.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-6a5ee3cd-eeee-4b0e-aee6-b89844d65687\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>A_구매지수</th>\n","      <th>B_구매지수</th>\n","      <th>C_구매지수</th>\n","      <th>D_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.4</td>\n","      <td>2.2</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>1.6</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>6.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0.8</td>\n","      <td>4.4</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-2.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.8</td>\n","      <td>1.4</td>\n","      <td>0.8</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>9.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>0.8</td>\n","      <td>8.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>0.4</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>9.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6a5ee3cd-eeee-4b0e-aee6-b89844d65687')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6a5ee3cd-eeee-4b0e-aee6-b89844d65687 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6a5ee3cd-eeee-4b0e-aee6-b89844d65687');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":87}]},{"cell_type":"code","source":["test5 = grade2cv(df2grade2(cat_s_by_q), 7, '구매')\n","test5"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":537},"executionInfo":{"status":"ok","timestamp":1672814606464,"user_tz":-540,"elapsed":119224,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"b949e9dd-a9e2-45d0-ec8e-039ba50681c9","id":"_Txj_gJ0f60-"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  가공식품_구매지수  가구/인테리어_구매지수  교육/문화용품_구매지수  기타_구매지수  디지털/가전_구매지수  \\\n","0          1       -2.2           0.0           0.4      2.4         -4.0   \n","1          2        0.2           0.0           6.8      9.2          0.0   \n","2          3        0.4           0.0           0.0      0.0          1.8   \n","3          4        2.8           4.0           0.4     14.0         11.6   \n","4          5       -3.0           0.0           2.0      0.0          3.2   \n","...      ...        ...           ...           ...      ...          ...   \n","19378  19379        0.0           0.0           0.0      0.0          0.0   \n","19379  19380        0.0           0.0           0.0      0.0          0.0   \n","19380  19381        6.0           0.0           1.0      0.0          4.6   \n","19381  19382        4.0           0.0           2.0      0.0          3.0   \n","19382  19383        0.0           0.0           0.0      0.0          0.0   \n","\n","       신선식품_구매지수  음식점_구매지수  의류_구매지수  의약품/의료기기_구매지수  일상용품_구매지수  전문스포츠/레저_구매지수  \\\n","0            2.4       7.0      0.4            0.0        2.4            0.0   \n","1            0.0       0.0     -0.2            0.0        0.4            1.6   \n","2            1.2       1.2      1.2            0.0        0.4            0.0   \n","3            2.2       0.0      6.0            0.0        2.0            8.8   \n","4            0.0       0.0      2.0            0.0       -1.4            0.0   \n","...          ...       ...      ...            ...        ...            ...   \n","19378        0.4       0.0      2.0            0.0        6.4            2.0   \n","19379        0.0       0.0      0.0            0.0        3.8            0.0   \n","19380        7.8       9.0      4.0            0.0        3.0            6.0   \n","19381        6.0       7.0      1.4            0.0        1.0            0.0   \n","19382        0.0       0.0      3.0            0.0        6.0            0.0   \n","\n","       패션잡화_구매지수  \n","0            0.8  \n","1            9.8  \n","2            0.0  \n","3            3.6  \n","4           -1.8  \n","...          ...  \n","19378        2.6  \n","19379        0.0  \n","19380        1.4  \n","19381        1.8  \n","19382        4.0  \n","\n","[19383 rows x 13 columns]"],"text/html":["\n","  <div id=\"df-892de0e6-c18f-440b-bd3e-2c8d01107697\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>가공식품_구매지수</th>\n","      <th>가구/인테리어_구매지수</th>\n","      <th>교육/문화용품_구매지수</th>\n","      <th>기타_구매지수</th>\n","      <th>디지털/가전_구매지수</th>\n","      <th>신선식품_구매지수</th>\n","      <th>음식점_구매지수</th>\n","      <th>의류_구매지수</th>\n","      <th>의약품/의료기기_구매지수</th>\n","      <th>일상용품_구매지수</th>\n","      <th>전문스포츠/레저_구매지수</th>\n","      <th>패션잡화_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>-2.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>2.4</td>\n","      <td>-4.0</td>\n","      <td>2.4</td>\n","      <td>7.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0.2</td>\n","      <td>0.0</td>\n","      <td>6.8</td>\n","      <td>9.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-0.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>1.6</td>\n","      <td>9.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2.8</td>\n","      <td>4.0</td>\n","      <td>0.4</td>\n","      <td>14.0</td>\n","      <td>11.6</td>\n","      <td>2.2</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>8.8</td>\n","      <td>3.6</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-3.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>-1.4</td>\n","      <td>0.0</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>6.4</td>\n","      <td>2.0</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>4.6</td>\n","      <td>7.8</td>\n","      <td>9.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>1.4</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>7.0</td>\n","      <td>1.4</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 13 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-892de0e6-c18f-440b-bd3e-2c8d01107697')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-892de0e6-c18f-440b-bd3e-2c8d01107697 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-892de0e6-c18f-440b-bd3e-2c8d01107697');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":88}]},{"cell_type":"code","source":["test = pd.merge(pd.merge(pd.merge(pd.merge(test1, test2, on='고객번호', how='outer'), test3, on='고객번호', how='outer'), test4, on='고객번호', how='outer'), test5, on='고객번호', how='outer')\n","test"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":661},"executionInfo":{"status":"ok","timestamp":1672814606465,"user_tz":-540,"elapsed":49,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"00ef7bb0-4e86-4cd2-824f-3c1c0b0b65fb","id":"FJoJHewSf60-"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  변동지수  A_방문지수  B_방문지수  C_방문지수  D_방문지수  가공식품_방문지수  가구/인테리어_방문지수  \\\n","0          1   1.0    -0.8     2.8     3.2     0.0        0.2           0.0   \n","1          2   0.8     1.4    -0.2     0.0     5.2       -2.6           0.0   \n","2          3   0.0     0.0     0.4     0.8     0.0        1.6           0.0   \n","3          4   0.0     4.0     3.8     1.8     0.0        5.8           7.0   \n","4          5   8.0    -3.8    -0.6     0.0     2.4       -2.6           0.0   \n","...      ...   ...     ...     ...     ...     ...        ...           ...   \n","19378  19379   0.8     1.8     3.4     0.8     9.0        5.0           0.0   \n","19379  19380   0.0     0.0     1.0     3.0     9.0        0.8           0.0   \n","19380  19381  -2.4     1.4     9.0     3.0     0.0        7.0           0.0   \n","19381  19382  -1.2     0.4     9.0     0.0     0.0        9.0           0.0   \n","19382  19383  -0.6     3.0     2.0     2.0     9.0        4.0           0.0   \n","\n","       교육/문화용품_방문지수  기타_방문지수  ...  교육/문화용품_구매지수  기타_구매지수  디지털/가전_구매지수  \\\n","0               0.0      5.2  ...           0.4      2.4         -4.0   \n","1               6.4      6.6  ...           6.8      9.2          0.0   \n","2               0.0      0.0  ...           0.0      0.0          1.8   \n","3               2.8      9.8  ...           0.4     14.0         11.6   \n","4               1.2      0.0  ...           2.0      0.0          3.2   \n","...             ...      ...  ...           ...      ...          ...   \n","19378           0.0      0.0  ...           0.0      0.0          0.0   \n","19379           0.0      0.0  ...           0.0      0.0          0.0   \n","19380           4.8      0.0  ...           1.0      0.0          4.6   \n","19381           6.0      1.2  ...           2.0      0.0          3.0   \n","19382           2.0      0.0  ...           0.0      0.0          0.0   \n","\n","       신선식품_구매지수  음식점_구매지수  의류_구매지수  의약품/의료기기_구매지수  일상용품_구매지수  전문스포츠/레저_구매지수  \\\n","0            2.4       7.0      0.4            0.0        2.4            0.0   \n","1            0.0       0.0     -0.2            0.0        0.4            1.6   \n","2            1.2       1.2      1.2            0.0        0.4            0.0   \n","3            2.2       0.0      6.0            0.0        2.0            8.8   \n","4            0.0       0.0      2.0            0.0       -1.4            0.0   \n","...          ...       ...      ...            ...        ...            ...   \n","19378        0.4       0.0      2.0            0.0        6.4            2.0   \n","19379        0.0       0.0      0.0            0.0        3.8            0.0   \n","19380        7.8       9.0      4.0            0.0        3.0            6.0   \n","19381        6.0       7.0      1.4            0.0        1.0            0.0   \n","19382        0.0       0.0      3.0            0.0        6.0            0.0   \n","\n","       패션잡화_구매지수  \n","0            0.8  \n","1            9.8  \n","2            0.0  \n","3            3.6  \n","4           -1.8  \n","...          ...  \n","19378        2.6  \n","19379        0.0  \n","19380        1.4  \n","19381        1.8  \n","19382        4.0  \n","\n","[19383 rows x 34 columns]"],"text/html":["\n","  <div id=\"df-8ff7ee7a-0778-4831-acac-ad050d69cfac\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>변동지수</th>\n","      <th>A_방문지수</th>\n","      <th>B_방문지수</th>\n","      <th>C_방문지수</th>\n","      <th>D_방문지수</th>\n","      <th>가공식품_방문지수</th>\n","      <th>가구/인테리어_방문지수</th>\n","      <th>교육/문화용품_방문지수</th>\n","      <th>기타_방문지수</th>\n","      <th>...</th>\n","      <th>교육/문화용품_구매지수</th>\n","      <th>기타_구매지수</th>\n","      <th>디지털/가전_구매지수</th>\n","      <th>신선식품_구매지수</th>\n","      <th>음식점_구매지수</th>\n","      <th>의류_구매지수</th>\n","      <th>의약품/의료기기_구매지수</th>\n","      <th>일상용품_구매지수</th>\n","      <th>전문스포츠/레저_구매지수</th>\n","      <th>패션잡화_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1.0</td>\n","      <td>-0.8</td>\n","      <td>2.8</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.2</td>\n","      <td>...</td>\n","      <td>0.4</td>\n","      <td>2.4</td>\n","      <td>-4.0</td>\n","      <td>2.4</td>\n","      <td>7.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>0.8</td>\n","      <td>1.4</td>\n","      <td>-0.2</td>\n","      <td>0.0</td>\n","      <td>5.2</td>\n","      <td>-2.6</td>\n","      <td>0.0</td>\n","      <td>6.4</td>\n","      <td>6.6</td>\n","      <td>...</td>\n","      <td>6.8</td>\n","      <td>9.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-0.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>1.6</td>\n","      <td>9.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>1.6</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>3.8</td>\n","      <td>1.8</td>\n","      <td>0.0</td>\n","      <td>5.8</td>\n","      <td>7.0</td>\n","      <td>2.8</td>\n","      <td>9.8</td>\n","      <td>...</td>\n","      <td>0.4</td>\n","      <td>14.0</td>\n","      <td>11.6</td>\n","      <td>2.2</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>8.8</td>\n","      <td>3.6</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>8.0</td>\n","      <td>-3.8</td>\n","      <td>-0.6</td>\n","      <td>0.0</td>\n","      <td>2.4</td>\n","      <td>-2.6</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.2</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>-1.4</td>\n","      <td>0.0</td>\n","      <td>-1.8</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.8</td>\n","      <td>1.8</td>\n","      <td>3.4</td>\n","      <td>0.8</td>\n","      <td>9.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>6.4</td>\n","      <td>2.0</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>9.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.8</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>-2.4</td>\n","      <td>1.4</td>\n","      <td>9.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>4.8</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>4.6</td>\n","      <td>7.8</td>\n","      <td>9.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>1.4</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>-1.2</td>\n","      <td>0.4</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>1.2</td>\n","      <td>...</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>6.0</td>\n","      <td>7.0</td>\n","      <td>1.4</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>-0.6</td>\n","      <td>3.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>9.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 34 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8ff7ee7a-0778-4831-acac-ad050d69cfac')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8ff7ee7a-0778-4831-acac-ad050d69cfac button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8ff7ee7a-0778-4831-acac-ad050d69cfac');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":89}]},{"cell_type":"code","source":["test.to_csv('/content/drive/MyDrive/KDT/2차프로젝트/cv_data_test.csv')"],"metadata":{"id":"uHBJfCWrf60-"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 5) 대분류 합치기\n","피처 축소를 위해 대분류를 4개로 합치기"],"metadata":{"id":"p7Gf5fBoRjaB"}},{"cell_type":"markdown","source":["### (1) 대분류 통합"],"metadata":{"id":"UAxKxRQ_nLVu"}},{"cell_type":"code","source":["# 구매금액 합치기\n","cate4_sum = total.pivot_table(index='고객번호', columns=['대분류','분기'], values='구매금액', aggfunc=sum)\n","cate4_sum = cate4_sum.stack().fillna(0)\n","cate4_sum"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":568},"id":"qqktdfPuhN9k","executionInfo":{"status":"ok","timestamp":1672899929594,"user_tz":-540,"elapsed":5279,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"4bca87e8-9700-43e8-a989-70ffc9c6898f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류            가공식품  가구/인테리어   교육/문화용품        기타     디지털/가전      신선식품  \\\n","고객번호  분기                                                                \n","1     1   1830570.0      0.0  103740.0  711900.0   296490.0       0.0   \n","      2   2966705.0      0.0   73720.0   66500.0   241240.0   15480.0   \n","      3   1160590.0      0.0  246450.0  463400.0   133840.0   22210.0   \n","      4   1583440.0      0.0   55000.0  473500.0  4709570.0  288682.0   \n","      5   1945226.0      0.0       0.0  133240.0   108590.0  162579.0   \n","...             ...      ...       ...       ...        ...       ...   \n","19382 7    641040.0      0.0   13370.0       0.0    23150.0  346367.0   \n","      8    692486.0      0.0   22930.0   16800.0    23010.0  364031.0   \n","19383 6      4000.0      0.0       0.0       0.0        0.0       0.0   \n","      7    193400.0      0.0    1530.0       0.0     5240.0    5000.0   \n","      8    211290.0      0.0       0.0       0.0        0.0       0.0   \n","\n","대분류           음식점         의류  의약품/의료기기        일상용품  전문스포츠/레저       패션잡화  \n","고객번호  분기                                                                 \n","1     1   21800.0  1580990.0       0.0   2647360.0       0.0  1948740.0  \n","      2       0.0  1317270.0       0.0   3356420.0       0.0  2746430.0  \n","      3       0.0  3391330.0       0.0   3534310.0       0.0  1829420.0  \n","      4   48400.0  1682360.0       0.0  12377220.0       0.0  2116590.0  \n","      5   12500.0  2166590.0       0.0   2049550.0       0.0  2724710.0  \n","...           ...        ...       ...         ...       ...        ...  \n","19382 7   28800.0    18800.0       0.0    152460.0       0.0    42200.0  \n","      8   44430.0        0.0       0.0     90960.0   18000.0    36200.0  \n","19383 6       0.0        0.0       0.0     23000.0       0.0        0.0  \n","      7       0.0    70400.0       0.0    667890.0       0.0   148900.0  \n","      8       0.0        0.0       0.0    709550.0       0.0   344200.0  \n","\n","[153895 rows x 12 columns]"],"text/html":["\n","  <div id=\"df-b99c9975-d049-4ebd-bcff-c192cf52a1e2\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>대분류</th>\n","      <th>가공식품</th>\n","      <th>가구/인테리어</th>\n","      <th>교육/문화용품</th>\n","      <th>기타</th>\n","      <th>디지털/가전</th>\n","      <th>신선식품</th>\n","      <th>음식점</th>\n","      <th>의류</th>\n","      <th>의약품/의료기기</th>\n","      <th>일상용품</th>\n","      <th>전문스포츠/레저</th>\n","      <th>패션잡화</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th>분기</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th rowspan=\"5\" valign=\"top\">1</th>\n","      <th>1</th>\n","      <td>1830570.0</td>\n","      <td>0.0</td>\n","      <td>103740.0</td>\n","      <td>711900.0</td>\n","      <td>296490.0</td>\n","      <td>0.0</td>\n","      <td>21800.0</td>\n","      <td>1580990.0</td>\n","      <td>0.0</td>\n","      <td>2647360.0</td>\n","      <td>0.0</td>\n","      <td>1948740.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2966705.0</td>\n","      <td>0.0</td>\n","      <td>73720.0</td>\n","      <td>66500.0</td>\n","      <td>241240.0</td>\n","      <td>15480.0</td>\n","      <td>0.0</td>\n","      <td>1317270.0</td>\n","      <td>0.0</td>\n","      <td>3356420.0</td>\n","      <td>0.0</td>\n","      <td>2746430.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1160590.0</td>\n","      <td>0.0</td>\n","      <td>246450.0</td>\n","      <td>463400.0</td>\n","      <td>133840.0</td>\n","      <td>22210.0</td>\n","      <td>0.0</td>\n","      <td>3391330.0</td>\n","      <td>0.0</td>\n","      <td>3534310.0</td>\n","      <td>0.0</td>\n","      <td>1829420.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1583440.0</td>\n","      <td>0.0</td>\n","      <td>55000.0</td>\n","      <td>473500.0</td>\n","      <td>4709570.0</td>\n","      <td>288682.0</td>\n","      <td>48400.0</td>\n","      <td>1682360.0</td>\n","      <td>0.0</td>\n","      <td>12377220.0</td>\n","      <td>0.0</td>\n","      <td>2116590.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>1945226.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>133240.0</td>\n","      <td>108590.0</td>\n","      <td>162579.0</td>\n","      <td>12500.0</td>\n","      <td>2166590.0</td>\n","      <td>0.0</td>\n","      <td>2049550.0</td>\n","      <td>0.0</td>\n","      <td>2724710.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th rowspan=\"2\" valign=\"top\">19382</th>\n","      <th>7</th>\n","      <td>641040.0</td>\n","      <td>0.0</td>\n","      <td>13370.0</td>\n","      <td>0.0</td>\n","      <td>23150.0</td>\n","      <td>346367.0</td>\n","      <td>28800.0</td>\n","      <td>18800.0</td>\n","      <td>0.0</td>\n","      <td>152460.0</td>\n","      <td>0.0</td>\n","      <td>42200.0</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>692486.0</td>\n","      <td>0.0</td>\n","      <td>22930.0</td>\n","      <td>16800.0</td>\n","      <td>23010.0</td>\n","      <td>364031.0</td>\n","      <td>44430.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>90960.0</td>\n","      <td>18000.0</td>\n","      <td>36200.0</td>\n","    </tr>\n","    <tr>\n","      <th rowspan=\"3\" valign=\"top\">19383</th>\n","      <th>6</th>\n","      <td>4000.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>23000.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>193400.0</td>\n","      <td>0.0</td>\n","      <td>1530.0</td>\n","      <td>0.0</td>\n","      <td>5240.0</td>\n","      <td>5000.0</td>\n","      <td>0.0</td>\n","      <td>70400.0</td>\n","      <td>0.0</td>\n","      <td>667890.0</td>\n","      <td>0.0</td>\n","      <td>148900.0</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>211290.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>709550.0</td>\n","      <td>0.0</td>\n","      <td>344200.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>153895 rows × 12 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b99c9975-d049-4ebd-bcff-c192cf52a1e2')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b99c9975-d049-4ebd-bcff-c192cf52a1e2 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b99c9975-d049-4ebd-bcff-c192cf52a1e2');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":56}]},{"cell_type":"code","source":["cate4_sum['식품'] = (cate4_sum['가공식품'] + cate4_sum[ '신선식품']) \n","cate4_sum['패션'] = (cate4_sum['의류'] + cate4_sum[ '패션잡화']) \n","cate4_sum['취미'] = (cate4_sum['교육/문화용품'] + cate4_sum[ '전문스포츠/레저']) \n","cate4_sum['주거'] = (cate4_sum['디지털/가전'] + cate4_sum[ '가구/인테리어']) \n","cate4_sum = cate4_sum.iloc[:,12:]\n","cate4_sum = cate4_sum.unstack().fillna(0)\n","cate4_sum"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":585},"id":"bLr4YIrxjqat","executionInfo":{"status":"ok","timestamp":1672899929594,"user_tz":-540,"elapsed":22,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"23b6f21d-ac82-4f60-d12f-1f6cc2d8fcfb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류           식품                                                         \\\n","분기             1          2          3          4          5          6   \n","고객번호                                                                      \n","1      1830570.0  2982185.0  1182800.0  1872122.0  2107805.0  1223040.0   \n","2      2907240.0  2691440.0  1844100.0  1835670.0  1903230.0   940500.0   \n","3       293992.0   428233.0   523398.0   316246.0   242070.0   250230.0   \n","4       739303.0  1157683.0   673990.0   458920.0   956382.0   910445.0   \n","5      1850540.0  1508600.0  1099140.0   398440.0  1181280.0   807650.0   \n","...          ...        ...        ...        ...        ...        ...   \n","19379        0.0        0.0    20000.0   117240.0   132850.0   165330.0   \n","19380        0.0        0.0        0.0    16800.0   126180.0    45220.0   \n","19381        0.0        0.0        0.0        0.0   617350.0  1372751.0   \n","19382        0.0        0.0        0.0        0.0   556549.0   849490.0   \n","19383        0.0        0.0        0.0        0.0        0.0     4000.0   \n","\n","대분류                                 패션             ...       취미            \\\n","분기             7          8          1          2  ...        7         8   \n","고객번호                                               ...                      \n","1       640120.0   492688.0  3529730.0  4063700.0  ...      0.0       0.0   \n","2      1354190.0  1732140.0  1421950.0   916670.0  ...  71900.0       0.0   \n","3       341607.0   229271.0        0.0    80000.0  ...      0.0       0.0   \n","4       841252.0   775805.0    79600.0  1087350.0  ...  18220.0       0.0   \n","5            0.0  1698920.0   128800.0   106900.0  ...      0.0       0.0   \n","...          ...        ...        ...        ...  ...      ...       ...   \n","19379    84620.0   203150.0        0.0        0.0  ...      0.0  317050.0   \n","19380    96337.0   368080.0        0.0        0.0  ...      0.0       0.0   \n","19381  1463381.0  1059167.0        0.0        0.0  ...  15400.0   14800.0   \n","19382   987407.0  1056517.0        0.0        0.0  ...  13370.0   40930.0   \n","19383   198400.0   211290.0        0.0        0.0  ...   1530.0       0.0   \n","\n","대분류          주거                                                       \\\n","분기            1         2          3          4         5          6   \n","고객번호                                                                   \n","1      296490.0  241240.0   133840.0  4709570.0  108590.0   494400.0   \n","2      554900.0  583100.0  1817220.0  1225680.0  806960.0  1292700.0   \n","3        4500.0    1380.0     2850.0     9980.0   11830.0     5150.0   \n","4           0.0  423050.0   150000.0   321900.0       0.0    98000.0   \n","5           0.0  210000.0   212300.0        0.0       0.0        0.0   \n","...         ...       ...        ...        ...       ...        ...   \n","19379       0.0       0.0        0.0        0.0       0.0        0.0   \n","19380       0.0       0.0        0.0        0.0       0.0        0.0   \n","19381       0.0       0.0        0.0        0.0    7680.0   121480.0   \n","19382       0.0       0.0        0.0        0.0   19450.0    23470.0   \n","19383       0.0       0.0        0.0        0.0       0.0        0.0   \n","\n","대분류                          \n","분기             7          8  \n","고객번호                         \n","1            0.0   142730.0  \n","2      2636360.0  2545400.0  \n","3         9990.0     9960.0  \n","4       198700.0        0.0  \n","5            0.0   604000.0  \n","...          ...        ...  \n","19379        0.0        0.0  \n","19380        0.0        0.0  \n","19381    21020.0    21780.0  \n","19382    23150.0    23010.0  \n","19383     5240.0        0.0  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-762c7fdc-d1f9-450c-87fc-de45c53e4f50\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>대분류</th>\n","      <th colspan=\"8\" halign=\"left\">식품</th>\n","      <th colspan=\"2\" halign=\"left\">패션</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">취미</th>\n","      <th colspan=\"8\" halign=\"left\">주거</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>1830570.0</td>\n","      <td>2982185.0</td>\n","      <td>1182800.0</td>\n","      <td>1872122.0</td>\n","      <td>2107805.0</td>\n","      <td>1223040.0</td>\n","      <td>640120.0</td>\n","      <td>492688.0</td>\n","      <td>3529730.0</td>\n","      <td>4063700.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>296490.0</td>\n","      <td>241240.0</td>\n","      <td>133840.0</td>\n","      <td>4709570.0</td>\n","      <td>108590.0</td>\n","      <td>494400.0</td>\n","      <td>0.0</td>\n","      <td>142730.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2907240.0</td>\n","      <td>2691440.0</td>\n","      <td>1844100.0</td>\n","      <td>1835670.0</td>\n","      <td>1903230.0</td>\n","      <td>940500.0</td>\n","      <td>1354190.0</td>\n","      <td>1732140.0</td>\n","      <td>1421950.0</td>\n","      <td>916670.0</td>\n","      <td>...</td>\n","      <td>71900.0</td>\n","      <td>0.0</td>\n","      <td>554900.0</td>\n","      <td>583100.0</td>\n","      <td>1817220.0</td>\n","      <td>1225680.0</td>\n","      <td>806960.0</td>\n","      <td>1292700.0</td>\n","      <td>2636360.0</td>\n","      <td>2545400.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>293992.0</td>\n","      <td>428233.0</td>\n","      <td>523398.0</td>\n","      <td>316246.0</td>\n","      <td>242070.0</td>\n","      <td>250230.0</td>\n","      <td>341607.0</td>\n","      <td>229271.0</td>\n","      <td>0.0</td>\n","      <td>80000.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4500.0</td>\n","      <td>1380.0</td>\n","      <td>2850.0</td>\n","      <td>9980.0</td>\n","      <td>11830.0</td>\n","      <td>5150.0</td>\n","      <td>9990.0</td>\n","      <td>9960.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>739303.0</td>\n","      <td>1157683.0</td>\n","      <td>673990.0</td>\n","      <td>458920.0</td>\n","      <td>956382.0</td>\n","      <td>910445.0</td>\n","      <td>841252.0</td>\n","      <td>775805.0</td>\n","      <td>79600.0</td>\n","      <td>1087350.0</td>\n","      <td>...</td>\n","      <td>18220.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>423050.0</td>\n","      <td>150000.0</td>\n","      <td>321900.0</td>\n","      <td>0.0</td>\n","      <td>98000.0</td>\n","      <td>198700.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>1850540.0</td>\n","      <td>1508600.0</td>\n","      <td>1099140.0</td>\n","      <td>398440.0</td>\n","      <td>1181280.0</td>\n","      <td>807650.0</td>\n","      <td>0.0</td>\n","      <td>1698920.0</td>\n","      <td>128800.0</td>\n","      <td>106900.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>210000.0</td>\n","      <td>212300.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>604000.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>20000.0</td>\n","      <td>117240.0</td>\n","      <td>132850.0</td>\n","      <td>165330.0</td>\n","      <td>84620.0</td>\n","      <td>203150.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>317050.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>16800.0</td>\n","      <td>126180.0</td>\n","      <td>45220.0</td>\n","      <td>96337.0</td>\n","      <td>368080.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>617350.0</td>\n","      <td>1372751.0</td>\n","      <td>1463381.0</td>\n","      <td>1059167.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>15400.0</td>\n","      <td>14800.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>7680.0</td>\n","      <td>121480.0</td>\n","      <td>21020.0</td>\n","      <td>21780.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>556549.0</td>\n","      <td>849490.0</td>\n","      <td>987407.0</td>\n","      <td>1056517.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>13370.0</td>\n","      <td>40930.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>19450.0</td>\n","      <td>23470.0</td>\n","      <td>23150.0</td>\n","      <td>23010.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>4000.0</td>\n","      <td>198400.0</td>\n","      <td>211290.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1530.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5240.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-762c7fdc-d1f9-450c-87fc-de45c53e4f50')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-762c7fdc-d1f9-450c-87fc-de45c53e4f50 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-762c7fdc-d1f9-450c-87fc-de45c53e4f50');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":57}]},{"cell_type":"code","source":["# 구매횟수 합치기\n","cate4_nunique = total.pivot_table(index='고객번호', columns=['대분류','분기'], values='영수증번호', aggfunc='nunique')\n","cate4_nunique = cate4_nunique.stack().fillna(0)\n","cate4_nunique"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":534},"executionInfo":{"status":"ok","timestamp":1672900280995,"user_tz":-540,"elapsed":12036,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"3fa5ce71-e5f3-4534-a991-1f6deb12a8c2","id":"zFSIi-4kkoXb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류       가공식품  가구/인테리어  교육/문화용품   기타  디지털/가전  신선식품  음식점   의류  의약품/의료기기  일상용품  \\\n","고객번호  분기                                                                        \n","1     1   34.0      0.0      1.0  4.0     2.0   0.0  1.0  7.0       0.0  27.0   \n","      2   35.0      0.0      1.0  1.0     2.0   2.0  0.0  6.0       0.0  30.0   \n","      3   45.0      0.0      2.0  4.0     3.0   3.0  0.0  9.0       0.0  28.0   \n","      4   59.0      0.0      1.0  4.0    11.0   5.0  1.0  6.0       0.0  36.0   \n","      5   61.0      0.0      0.0  1.0     3.0   4.0  1.0  8.0       0.0  31.0   \n","...        ...      ...      ...  ...     ...   ...  ...  ...       ...   ...   \n","19382 7   88.0      0.0      4.0  0.0     6.0  46.0  7.0  2.0       0.0  15.0   \n","      8   83.0      0.0      9.0  1.0     6.0  46.0  9.0  0.0       0.0  30.0   \n","19383 6    2.0      0.0      0.0  0.0     0.0   0.0  0.0  0.0       0.0   2.0   \n","      7   44.0      0.0      1.0  0.0     2.0   1.0  0.0  1.0       0.0  33.0   \n","      8   34.0      0.0      0.0  0.0     0.0   0.0  0.0  0.0       0.0  32.0   \n","\n","대분류       전문스포츠/레저  패션잡화  \n","고객번호  분기                  \n","1     1        0.0   6.0  \n","      2        0.0  10.0  \n","      3        0.0  11.0  \n","      4        0.0   7.0  \n","      5        0.0  11.0  \n","...            ...   ...  \n","19382 7        0.0   4.0  \n","      8        3.0   4.0  \n","19383 6        0.0   0.0  \n","      7        0.0   4.0  \n","      8        0.0   3.0  \n","\n","[153895 rows x 12 columns]"],"text/html":["\n","  <div id=\"df-e63679d3-c670-4163-abbb-e4c406636c8d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>대분류</th>\n","      <th>가공식품</th>\n","      <th>가구/인테리어</th>\n","      <th>교육/문화용품</th>\n","      <th>기타</th>\n","      <th>디지털/가전</th>\n","      <th>신선식품</th>\n","      <th>음식점</th>\n","      <th>의류</th>\n","      <th>의약품/의료기기</th>\n","      <th>일상용품</th>\n","      <th>전문스포츠/레저</th>\n","      <th>패션잡화</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th>분기</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th rowspan=\"5\" valign=\"top\">1</th>\n","      <th>1</th>\n","      <td>34.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>7.0</td>\n","      <td>0.0</td>\n","      <td>27.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>35.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>30.0</td>\n","      <td>0.0</td>\n","      <td>10.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>45.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>28.0</td>\n","      <td>0.0</td>\n","      <td>11.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>59.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>4.0</td>\n","      <td>11.0</td>\n","      <td>5.0</td>\n","      <td>1.0</td>\n","      <td>6.0</td>\n","      <td>0.0</td>\n","      <td>36.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>61.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>4.0</td>\n","      <td>1.0</td>\n","      <td>8.0</td>\n","      <td>0.0</td>\n","      <td>31.0</td>\n","      <td>0.0</td>\n","      <td>11.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th rowspan=\"2\" valign=\"top\">19382</th>\n","      <th>7</th>\n","      <td>88.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>46.0</td>\n","      <td>7.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>83.0</td>\n","      <td>0.0</td>\n","      <td>9.0</td>\n","      <td>1.0</td>\n","      <td>6.0</td>\n","      <td>46.0</td>\n","      <td>9.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>30.0</td>\n","      <td>3.0</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th rowspan=\"3\" valign=\"top\">19383</th>\n","      <th>6</th>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>44.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>33.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>34.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>32.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>153895 rows × 12 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e63679d3-c670-4163-abbb-e4c406636c8d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e63679d3-c670-4163-abbb-e4c406636c8d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e63679d3-c670-4163-abbb-e4c406636c8d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["cate4_nunique['식품'] = (cate4_nunique['가공식품'] + cate4_nunique[ '신선식품']) \n","cate4_nunique['패션'] = (cate4_nunique['의류'] + cate4_nunique[ '패션잡화']) \n","cate4_nunique['취미'] = (cate4_nunique['교육/문화용품'] + cate4_nunique[ '전문스포츠/레저']) \n","cate4_nunique['주거'] = (cate4_nunique['디지털/가전'] + cate4_nunique[ '가구/인테리어']) \n","cate4_nunique = cate4_nunique.iloc[:,12:]\n","cate4_nunique = cate4_nunique.unstack().fillna(0)\n","cate4_nunique"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486},"executionInfo":{"status":"ok","timestamp":1672900280996,"user_tz":-540,"elapsed":8,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"4b1d0017-b880-46fc-8143-4503fbcea70d","id":"AZKLgIIukoXc"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["대분류      식품                                                  패션        ...  \\\n","분기        1     2      3     4     5      6      7      8     1     2  ...   \n","고객번호                                                                   ...   \n","1      34.0  37.0   48.0  64.0  65.0   44.0   25.0   22.0  13.0  16.0  ...   \n","2      54.0  53.0   51.0  50.0  41.0   25.0   34.0   41.0   5.0   5.0  ...   \n","3      63.0  82.0  115.0  72.0  39.0   58.0   62.0   53.0   0.0   1.0  ...   \n","4      37.0  68.0   31.0  39.0  59.0   59.0   64.0   67.0   3.0  17.0  ...   \n","5      97.0  91.0   49.0  16.0  57.0   20.0    0.0   44.0   2.0   3.0  ...   \n","...     ...   ...    ...   ...   ...    ...    ...    ...   ...   ...  ...   \n","19379   0.0   0.0    5.0  21.0  38.0   47.0   50.0   39.0   0.0   0.0  ...   \n","19380   0.0   0.0    0.0   2.0  28.0   14.0   12.0   93.0   0.0   0.0  ...   \n","19381   0.0   0.0    0.0   0.0  61.0  109.0  111.0  107.0   0.0   0.0  ...   \n","19382   0.0   0.0    0.0   0.0  64.0   94.0  134.0  129.0   0.0   0.0  ...   \n","19383   0.0   0.0    0.0   0.0   0.0    2.0   45.0   34.0   0.0   0.0  ...   \n","\n","대분류     취미         주거                                       \n","분기       7     8    1    2    3     4    5    6     7    8  \n","고객번호                                                        \n","1      0.0   0.0  2.0  2.0  3.0  11.0  3.0  3.0   0.0  3.0  \n","2      2.0   0.0  7.0  2.0  4.0   4.0  3.0  2.0  10.0  3.0  \n","3      0.0   0.0  1.0  1.0  1.0   3.0  3.0  1.0   3.0  2.0  \n","4      2.0   0.0  0.0  5.0  2.0   3.0  0.0  2.0   4.0  0.0  \n","5      0.0   0.0  0.0  1.0  2.0   0.0  0.0  0.0   0.0  1.0  \n","...    ...   ...  ...  ...  ...   ...  ...  ...   ...  ...  \n","19379  0.0   3.0  0.0  0.0  0.0   0.0  0.0  0.0   0.0  0.0  \n","19380  0.0   0.0  0.0  0.0  0.0   0.0  0.0  0.0   0.0  0.0  \n","19381  3.0   3.0  0.0  0.0  0.0   0.0  1.0  7.0   4.0  2.0  \n","19382  4.0  12.0  0.0  0.0  0.0   0.0  6.0  9.0   6.0  6.0  \n","19383  1.0   0.0  0.0  0.0  0.0   0.0  0.0  0.0   2.0  0.0  \n","\n","[19383 rows x 32 columns]"],"text/html":["\n","  <div id=\"df-d13478eb-fdf9-4649-b0ed-7a9f101b3433\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th>대분류</th>\n","      <th colspan=\"8\" halign=\"left\">식품</th>\n","      <th colspan=\"2\" halign=\"left\">패션</th>\n","      <th>...</th>\n","      <th colspan=\"2\" halign=\"left\">취미</th>\n","      <th colspan=\"8\" halign=\"left\">주거</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>...</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>34.0</td>\n","      <td>37.0</td>\n","      <td>48.0</td>\n","      <td>64.0</td>\n","      <td>65.0</td>\n","      <td>44.0</td>\n","      <td>25.0</td>\n","      <td>22.0</td>\n","      <td>13.0</td>\n","      <td>16.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","      <td>11.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>54.0</td>\n","      <td>53.0</td>\n","      <td>51.0</td>\n","      <td>50.0</td>\n","      <td>41.0</td>\n","      <td>25.0</td>\n","      <td>34.0</td>\n","      <td>41.0</td>\n","      <td>5.0</td>\n","      <td>5.0</td>\n","      <td>...</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>7.0</td>\n","      <td>2.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","      <td>2.0</td>\n","      <td>10.0</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>63.0</td>\n","      <td>82.0</td>\n","      <td>115.0</td>\n","      <td>72.0</td>\n","      <td>39.0</td>\n","      <td>58.0</td>\n","      <td>62.0</td>\n","      <td>53.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>1.0</td>\n","      <td>3.0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>37.0</td>\n","      <td>68.0</td>\n","      <td>31.0</td>\n","      <td>39.0</td>\n","      <td>59.0</td>\n","      <td>59.0</td>\n","      <td>64.0</td>\n","      <td>67.0</td>\n","      <td>3.0</td>\n","      <td>17.0</td>\n","      <td>...</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>97.0</td>\n","      <td>91.0</td>\n","      <td>49.0</td>\n","      <td>16.0</td>\n","      <td>57.0</td>\n","      <td>20.0</td>\n","      <td>0.0</td>\n","      <td>44.0</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>21.0</td>\n","      <td>38.0</td>\n","      <td>47.0</td>\n","      <td>50.0</td>\n","      <td>39.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>28.0</td>\n","      <td>14.0</td>\n","      <td>12.0</td>\n","      <td>93.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>61.0</td>\n","      <td>109.0</td>\n","      <td>111.0</td>\n","      <td>107.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>7.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>64.0</td>\n","      <td>94.0</td>\n","      <td>134.0</td>\n","      <td>129.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>4.0</td>\n","      <td>12.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>6.0</td>\n","      <td>9.0</td>\n","      <td>6.0</td>\n","      <td>6.0</td>\n","    </tr>\n","    <tr>\n","      <th>19383</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>45.0</td>\n","      <td>34.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 32 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d13478eb-fdf9-4649-b0ed-7a9f101b3433')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d13478eb-fdf9-4649-b0ed-7a9f101b3433 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d13478eb-fdf9-4649-b0ed-7a9f101b3433');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":62}]},{"cell_type":"markdown","source":["### (2) 함수 적용"],"metadata":{"id":"LMNql36mkpbd"}},{"cell_type":"code","source":["train1 = grade2cv(df2grade2(cate4_sum), 6, '구매')\n","train1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"7TJdIK2_kpd_","executionInfo":{"status":"ok","timestamp":1672900415983,"user_tz":-540,"elapsed":57389,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"deb754c9-36b9-4bb5-8b3a-a28789dba3f6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  식품_구매지수  패션_구매지수  취미_구매지수  주거_구매지수\n","0          1      0.0      1.4      4.2      1.8\n","1          2     -3.0     -0.2      0.8      0.0\n","2          3      0.4      0.8      0.0      0.8\n","3          4      3.0      4.4      1.2     10.2\n","4          5     -0.6     -1.4      2.0      3.2\n","...      ...      ...      ...      ...      ...\n","19378  19379      0.0      4.0      0.8      0.0\n","19379  19380      0.0      0.0      0.0      0.0\n","19380  19381      7.0      2.6      0.8      7.0\n","19381  19382      3.0      0.8      2.0      3.0\n","19382  19383      0.0      0.0      0.0      0.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-0fc9c66e-9975-4f72-9cc4-64bbf9b3d780\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품_구매지수</th>\n","      <th>패션_구매지수</th>\n","      <th>취미_구매지수</th>\n","      <th>주거_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>1.4</td>\n","      <td>4.2</td>\n","      <td>1.8</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-3.0</td>\n","      <td>-0.2</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>3.0</td>\n","      <td>4.4</td>\n","      <td>1.2</td>\n","      <td>10.2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-0.6</td>\n","      <td>-1.4</td>\n","      <td>2.0</td>\n","      <td>3.2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>7.0</td>\n","      <td>2.6</td>\n","      <td>0.8</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>3.0</td>\n","      <td>0.8</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0fc9c66e-9975-4f72-9cc4-64bbf9b3d780')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0fc9c66e-9975-4f72-9cc4-64bbf9b3d780 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0fc9c66e-9975-4f72-9cc4-64bbf9b3d780');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":68}]},{"cell_type":"code","source":["train2 = grade2cv(df2grade2(cate4_nunique), 6, '방문')\n","train2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"jznIVAqQkpgs","executionInfo":{"status":"ok","timestamp":1672900498331,"user_tz":-540,"elapsed":56401,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"1a42e1c1-1490-4e0e-ccac-b776115027ad"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  식품_방문지수  패션_방문지수  취미_방문지수  주거_방문지수\n","0          1      1.2      1.4      1.6      2.6\n","1          2     -2.4      2.6      2.4     -2.2\n","2          3      0.8      0.4      0.0      1.2\n","3          4      3.0      3.2      1.2      4.4\n","4          5     -3.2     -0.8      1.2      1.2\n","...      ...      ...      ...      ...      ...\n","19378  19379      3.0      3.0      0.8      0.0\n","19379  19380      0.4      0.0      0.0      0.0\n","19380  19381      8.0      4.2      2.0      7.0\n","19381  19382      7.0      2.0      6.0      8.0\n","19382  19383      0.0      0.0      0.0      0.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-fd4e5029-a02d-463a-9ba9-da68c2d3a026\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품_방문지수</th>\n","      <th>패션_방문지수</th>\n","      <th>취미_방문지수</th>\n","      <th>주거_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1.2</td>\n","      <td>1.4</td>\n","      <td>1.6</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-2.4</td>\n","      <td>2.6</td>\n","      <td>2.4</td>\n","      <td>-2.2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.8</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>3.0</td>\n","      <td>3.2</td>\n","      <td>1.2</td>\n","      <td>4.4</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-3.2</td>\n","      <td>-0.8</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>8.0</td>\n","      <td>4.2</td>\n","      <td>2.0</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>7.0</td>\n","      <td>2.0</td>\n","      <td>6.0</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fd4e5029-a02d-463a-9ba9-da68c2d3a026')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-fd4e5029-a02d-463a-9ba9-da68c2d3a026 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-fd4e5029-a02d-463a-9ba9-da68c2d3a026');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}]},{"cell_type":"code","source":["test1 = grade2cv(df2grade2(cate4_sum), 7, '구매')\n","test1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"WDn4oYKNkpje","executionInfo":{"status":"ok","timestamp":1672900578159,"user_tz":-540,"elapsed":56364,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"59832110-ccdc-4134-c597-f41134ba346f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  식품_구매지수  패션_구매지수  취미_구매지수  주거_구매지수\n","0          1     -2.4      0.8      0.0     -3.6\n","1          2     -1.0      2.8      6.8      0.0\n","2          3      0.4      0.8      0.0      1.8\n","3          4      2.4      3.2      4.2     11.2\n","4          5     -2.4     -1.4      2.0      3.2\n","...      ...      ...      ...      ...      ...\n","19378  19379      0.0      2.2      0.8      0.0\n","19379  19380      0.0      0.0      0.0      0.0\n","19380  19381      7.0      3.6      2.8      4.6\n","19381  19382      4.0      2.8      2.0      3.0\n","19382  19383      0.0      4.0      0.0      0.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-82d89553-166d-46a5-8b39-8b283c46d17d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품_구매지수</th>\n","      <th>패션_구매지수</th>\n","      <th>취미_구매지수</th>\n","      <th>주거_구매지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>-2.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>-3.6</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-1.0</td>\n","      <td>2.8</td>\n","      <td>6.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2.4</td>\n","      <td>3.2</td>\n","      <td>4.2</td>\n","      <td>11.2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-2.4</td>\n","      <td>-1.4</td>\n","      <td>2.0</td>\n","      <td>3.2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.0</td>\n","      <td>2.2</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>7.0</td>\n","      <td>3.6</td>\n","      <td>2.8</td>\n","      <td>4.6</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>4.0</td>\n","      <td>2.8</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-82d89553-166d-46a5-8b39-8b283c46d17d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-82d89553-166d-46a5-8b39-8b283c46d17d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-82d89553-166d-46a5-8b39-8b283c46d17d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":71}]},{"cell_type":"code","source":["test2 = grade2cv(df2grade2(cate4_nunique), 7, '방문')\n","test2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"jEkXqKPuo5iZ","executionInfo":{"status":"ok","timestamp":1672900634960,"user_tz":-540,"elapsed":56808,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"501fb619-7f12-494d-af33-f24162c61e0b"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  식품_방문지수  패션_방문지수  취미_방문지수  주거_방문지수\n","0          1      0.6      1.4      0.4      0.2\n","1          2     -2.4      4.6      6.4      3.8\n","2          3      0.8      0.4      0.0      4.2\n","3          4      4.0      3.2      5.2      7.4\n","4          5     -3.2     -0.8      1.2      1.2\n","...      ...      ...      ...      ...      ...\n","19378  19379      3.0      3.0      0.8      0.0\n","19379  19380      0.4      0.0      0.0      0.0\n","19380  19381      8.0      5.2      7.0      5.8\n","19381  19382      9.0      7.0      6.0      6.8\n","19382  19383      3.0      4.0      2.0      2.0\n","\n","[19383 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-8ce18272-26f8-402e-aa3f-cace522ecda4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품_방문지수</th>\n","      <th>패션_방문지수</th>\n","      <th>취미_방문지수</th>\n","      <th>주거_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.6</td>\n","      <td>1.4</td>\n","      <td>0.4</td>\n","      <td>0.2</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-2.4</td>\n","      <td>4.6</td>\n","      <td>6.4</td>\n","      <td>3.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.8</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>4.2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>4.0</td>\n","      <td>3.2</td>\n","      <td>5.2</td>\n","      <td>7.4</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-3.2</td>\n","      <td>-0.8</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>8.0</td>\n","      <td>5.2</td>\n","      <td>7.0</td>\n","      <td>5.8</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>9.0</td>\n","      <td>7.0</td>\n","      <td>6.0</td>\n","      <td>6.8</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>3.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 5 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8ce18272-26f8-402e-aa3f-cace522ecda4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8ce18272-26f8-402e-aa3f-cace522ecda4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8ce18272-26f8-402e-aa3f-cace522ecda4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":72}]},{"cell_type":"code","source":["train = pd.merge(train1, train2, on='고객번호')\n","train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":485},"id":"mBf6UnYZpMHu","executionInfo":{"status":"ok","timestamp":1672900662506,"user_tz":-540,"elapsed":416,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"021380ab-41b0-4133-f1cd-d41225703cb1"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  식품_구매지수  패션_구매지수  취미_구매지수  주거_구매지수  식품_방문지수  패션_방문지수  취미_방문지수  \\\n","0          1      0.0      1.4      4.2      1.8      1.2      1.4      1.6   \n","1          2     -3.0     -0.2      0.8      0.0     -2.4      2.6      2.4   \n","2          3      0.4      0.8      0.0      0.8      0.8      0.4      0.0   \n","3          4      3.0      4.4      1.2     10.2      3.0      3.2      1.2   \n","4          5     -0.6     -1.4      2.0      3.2     -3.2     -0.8      1.2   \n","...      ...      ...      ...      ...      ...      ...      ...      ...   \n","19378  19379      0.0      4.0      0.8      0.0      3.0      3.0      0.8   \n","19379  19380      0.0      0.0      0.0      0.0      0.4      0.0      0.0   \n","19380  19381      7.0      2.6      0.8      7.0      8.0      4.2      2.0   \n","19381  19382      3.0      0.8      2.0      3.0      7.0      2.0      6.0   \n","19382  19383      0.0      0.0      0.0      0.0      0.0      0.0      0.0   \n","\n","       주거_방문지수  \n","0          2.6  \n","1         -2.2  \n","2          1.2  \n","3          4.4  \n","4          1.2  \n","...        ...  \n","19378      0.0  \n","19379      0.0  \n","19380      7.0  \n","19381      8.0  \n","19382      0.0  \n","\n","[19383 rows x 9 columns]"],"text/html":["\n","  <div id=\"df-7e76477b-0f47-451d-af7c-68d1fa89d0a3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품_구매지수</th>\n","      <th>패션_구매지수</th>\n","      <th>취미_구매지수</th>\n","      <th>주거_구매지수</th>\n","      <th>식품_방문지수</th>\n","      <th>패션_방문지수</th>\n","      <th>취미_방문지수</th>\n","      <th>주거_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0.0</td>\n","      <td>1.4</td>\n","      <td>4.2</td>\n","      <td>1.8</td>\n","      <td>1.2</td>\n","      <td>1.4</td>\n","      <td>1.6</td>\n","      <td>2.6</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-3.0</td>\n","      <td>-0.2</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>-2.4</td>\n","      <td>2.6</td>\n","      <td>2.4</td>\n","      <td>-2.2</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>0.8</td>\n","      <td>0.8</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>3.0</td>\n","      <td>4.4</td>\n","      <td>1.2</td>\n","      <td>10.2</td>\n","      <td>3.0</td>\n","      <td>3.2</td>\n","      <td>1.2</td>\n","      <td>4.4</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-0.6</td>\n","      <td>-1.4</td>\n","      <td>2.0</td>\n","      <td>3.2</td>\n","      <td>-3.2</td>\n","      <td>-0.8</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>7.0</td>\n","      <td>2.6</td>\n","      <td>0.8</td>\n","      <td>7.0</td>\n","      <td>8.0</td>\n","      <td>4.2</td>\n","      <td>2.0</td>\n","      <td>7.0</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>3.0</td>\n","      <td>0.8</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","      <td>7.0</td>\n","      <td>2.0</td>\n","      <td>6.0</td>\n","      <td>8.0</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 9 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7e76477b-0f47-451d-af7c-68d1fa89d0a3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7e76477b-0f47-451d-af7c-68d1fa89d0a3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7e76477b-0f47-451d-af7c-68d1fa89d0a3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":73}]},{"cell_type":"code","source":["test = pd.merge(test1, test2, on='고객번호')\n","test"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":485},"executionInfo":{"status":"ok","timestamp":1672900674881,"user_tz":-540,"elapsed":404,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"1977fa67-8862-4ccf-e234-35f812b4da09","id":"D0KU93vLpMOs"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        고객번호  식품_구매지수  패션_구매지수  취미_구매지수  주거_구매지수  식품_방문지수  패션_방문지수  취미_방문지수  \\\n","0          1     -2.4      0.8      0.0     -3.6      0.6      1.4      0.4   \n","1          2     -1.0      2.8      6.8      0.0     -2.4      4.6      6.4   \n","2          3      0.4      0.8      0.0      1.8      0.8      0.4      0.0   \n","3          4      2.4      3.2      4.2     11.2      4.0      3.2      5.2   \n","4          5     -2.4     -1.4      2.0      3.2     -3.2     -0.8      1.2   \n","...      ...      ...      ...      ...      ...      ...      ...      ...   \n","19378  19379      0.0      2.2      0.8      0.0      3.0      3.0      0.8   \n","19379  19380      0.0      0.0      0.0      0.0      0.4      0.0      0.0   \n","19380  19381      7.0      3.6      2.8      4.6      8.0      5.2      7.0   \n","19381  19382      4.0      2.8      2.0      3.0      9.0      7.0      6.0   \n","19382  19383      0.0      4.0      0.0      0.0      3.0      4.0      2.0   \n","\n","       주거_방문지수  \n","0          0.2  \n","1          3.8  \n","2          4.2  \n","3          7.4  \n","4          1.2  \n","...        ...  \n","19378      0.0  \n","19379      0.0  \n","19380      5.8  \n","19381      6.8  \n","19382      2.0  \n","\n","[19383 rows x 9 columns]"],"text/html":["\n","  <div id=\"df-8c83f7ca-63c4-4e90-9a7b-c6e2e8b75fdd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>식품_구매지수</th>\n","      <th>패션_구매지수</th>\n","      <th>취미_구매지수</th>\n","      <th>주거_구매지수</th>\n","      <th>식품_방문지수</th>\n","      <th>패션_방문지수</th>\n","      <th>취미_방문지수</th>\n","      <th>주거_방문지수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>-2.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>-3.6</td>\n","      <td>0.6</td>\n","      <td>1.4</td>\n","      <td>0.4</td>\n","      <td>0.2</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>-1.0</td>\n","      <td>2.8</td>\n","      <td>6.8</td>\n","      <td>0.0</td>\n","      <td>-2.4</td>\n","      <td>4.6</td>\n","      <td>6.4</td>\n","      <td>3.8</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3</td>\n","      <td>0.4</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>1.8</td>\n","      <td>0.8</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>4.2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4</td>\n","      <td>2.4</td>\n","      <td>3.2</td>\n","      <td>4.2</td>\n","      <td>11.2</td>\n","      <td>4.0</td>\n","      <td>3.2</td>\n","      <td>5.2</td>\n","      <td>7.4</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>5</td>\n","      <td>-2.4</td>\n","      <td>-1.4</td>\n","      <td>2.0</td>\n","      <td>3.2</td>\n","      <td>-3.2</td>\n","      <td>-0.8</td>\n","      <td>1.2</td>\n","      <td>1.2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19378</th>\n","      <td>19379</td>\n","      <td>0.0</td>\n","      <td>2.2</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>3.0</td>\n","      <td>0.8</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19379</th>\n","      <td>19380</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.4</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>19380</th>\n","      <td>19381</td>\n","      <td>7.0</td>\n","      <td>3.6</td>\n","      <td>2.8</td>\n","      <td>4.6</td>\n","      <td>8.0</td>\n","      <td>5.2</td>\n","      <td>7.0</td>\n","      <td>5.8</td>\n","    </tr>\n","    <tr>\n","      <th>19381</th>\n","      <td>19382</td>\n","      <td>4.0</td>\n","      <td>2.8</td>\n","      <td>2.0</td>\n","      <td>3.0</td>\n","      <td>9.0</td>\n","      <td>7.0</td>\n","      <td>6.0</td>\n","      <td>6.8</td>\n","    </tr>\n","    <tr>\n","      <th>19382</th>\n","      <td>19383</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>4.0</td>\n","      <td>2.0</td>\n","      <td>2.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>19383 rows × 9 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8c83f7ca-63c4-4e90-9a7b-c6e2e8b75fdd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8c83f7ca-63c4-4e90-9a7b-c6e2e8b75fdd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8c83f7ca-63c4-4e90-9a7b-c6e2e8b75fdd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":74}]},{"cell_type":"code","source":["train.to_csv('/content/drive/MyDrive/KDT/2차프로젝트/cate4_train.csv')\n","test.to_csv('/content/drive/MyDrive/KDT/2차프로젝트/cate4_test.csv')"],"metadata":{"id":"o5zHtW6NpMOt"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["## 6) features 데이터 생성"],"metadata":{"id":"jJpNbGBZ7qRv"}},{"cell_type":"markdown","source":["- 고객 기본속성"],"metadata":{"id":"Ys-NX19m_hAd"}},{"cell_type":"code","source":["customer = pd.DataFrame(total.groupby('고객번호')[['성별', '거주지역', '연령대']].max().reset_index())\n","customer"],"metadata":{"id":"RRrKDMk17u5e"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["- 변동지수"],"metadata":{"id":"cVra9bvs_l9Z"}},{"cell_type":"code","source":[],"metadata":{"id":"nAhAf1lh_c59"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Train set"],"metadata":{"id":"dr_e9FXg8rBG"}},{"cell_type":"code","source":["train_set = customer.merge(pd.read_excel('/content/drive/MyDrive/Second_Project_By_Choonang/2차프로젝트 공유폴더/프로젝트데이터셋/전체구매금액_train.xlsx').iloc[:,1:], on='고객번호', how='outer').merge(\n","                           pd.read_csv('/content/drive/MyDrive/Second_Project_By_Choonang/2차프로젝트 공유폴더/프로젝트데이터셋/RFM_TRAIN_FINAL.csv').iloc[:,1:], on='고객번호', how='outer').merge(\n","                           pd.read_excel('/content/drive/MyDrive/Second_Project_By_Choonang/2차프로젝트 공유폴더/프로젝트데이터셋/제휴사별_train.xlsx'), on='고객번호', how='outer').merge(\n","                           pd.read_csv('/content/drive/MyDrive/Second_Project_By_Choonang/2차프로젝트 공유폴더/프로젝트데이터셋/카테고리별_train.csv'), on='고객번호', how='outer').merge(\n","                           pd.read_excel('/content/drive/MyDrive/Second_Project_By_Choonang/2차프로젝트 공유폴더/프로젝트데이터셋/금액별 구매빈도 train.xlsx'), on='고객번호', how='outer').merge(\n","                           pd.read_excel('/content/drive/MyDrive/Second_Project_By_Choonang/2차프로젝트 공유폴더/프로젝트데이터셋/total_att_train.xlsx').iloc[:,1:], on='고객번호', how='outer')\n","train_set"],"metadata":{"id":"zFIuiahc8xNl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"TohATKaTdaLd"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"CojXXv1y8xQu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"sOOPxu3A8xTR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"v7NXv7IK8xWU"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Test set"],"metadata":{"id":"eoo5lCkr8rD2"}},{"cell_type":"code","source":["test_set = customer.merge(rfm_test_df, on='고객번호', how='outer')\n","test_set"],"metadata":{"id":"QWckxlmb7999"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"is0s4Bs57vJi"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"tnXoJg0l7vMG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"kalZpmag7vPF"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"XUVvomFhYe0r"},"source":["# #5. label 설정"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KdNLGjRCYhuj"},"outputs":[],"source":["customer_pur_by_q = total.pivot_table(values='구매금액', index='고객번호', columns='분기', aggfunc='sum')\n","customer_pur_by_q = customer_pur_by_q[customer_pur_by_q.notna().all(axis=1)]\n","customer_pur_by_q"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KhNgGTm3YhxR"},"outputs":[],"source":["total_pur_by_q = pd.DataFrame(customer_pur_by_q.sum()).T\n","total_pur_by_q"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uubF9kBVYhz1"},"outputs":[],"source":["print(total_pur_by_q[7] / total_pur_by_q[1]) # 1분기 - 7분기 매출 변화율\n","print(total_pur_by_q[8] / total_pur_by_q[1]) # 1분기 - 8분기 매출 변화율"]},{"cell_type":"code","source":["# 타겟 분기의 매출 변화율 이상으로 매출이 증가, 감소한 고객의 수\n","print((customer_pur_by_q[7] / (customer_pur_by_q[1]*1.01) >= 1).sum())\n","print((customer_pur_by_q[7] / (customer_pur_by_q[1]*1.01) < 1).sum())\n","print((customer_pur_by_q[8] / (customer_pur_by_q[1]*1.25) >= 1).sum())\n","print((customer_pur_by_q[8] / (customer_pur_by_q[1]*1.25) < 1).sum())"],"metadata":{"id":"s8p-7vm4uRBd"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TN_M2_lVYh23"},"outputs":[],"source":["# 타겟 분기의 매출 변화율 이상으로 매출이 증가한 고객 : 1   / 증가하지 않은 고객 : 0\n","customer_pur_by_q['target7'] = np.where(customer_pur_by_q[7] / (customer_pur_by_q[1]*1.01) >= 1, 1, 0)\n","customer_pur_by_q['target8'] = np.where(customer_pur_by_q[8] / (customer_pur_by_q[1]*1.25) >= 1, 1, 0)"]},{"cell_type":"code","source":["# 고객별 데이터와 merge\n","pd.merge(customer_pur_by_q.reset_index()[['고객번호', 'target7', 'target8']])"],"metadata":{"id":"-zs7YJOvuPby"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Ky8ZtzahYiU2"},"source":["# #6. 모델 학습 및 평가"]},{"cell_type":"markdown","source":["## 1) Pycaret"],"metadata":{"id":"tikZ0KvWlqLj"}},{"cell_type":"code","source":["from pycaret.classification import *"],"metadata":{"id":"QI0WiX8yyVBO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["clf_n = setup(data=train_set_2, target='target', session_id=210)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["aac44f998d944d7b968c3624cd2bbe2c","6c6e55d6fa274784a4eccafc7d5b64bc","5846f4a7d3b2424cb5c557a8ab625e31","ae521d52766e4f4da5ad4dbd6aaee758","1f75aba088704061a49915adddc5f889","6a6855380f9b4935bebb248f9194f767"]},"executionInfo":{"status":"ok","timestamp":1673416487748,"user_tz":-540,"elapsed":4731,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"b7a2894e-aa20-4937-920c-d594f85d6601","id":"pqGTgEs7rGfa"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["                               Description             Value\n","0                               session_id               210\n","1                                   Target            target\n","2                              Target Type            Binary\n","3                            Label Encoded              None\n","4                            Original Data       (18866, 36)\n","5                           Missing Values             False\n","6                         Numeric Features                26\n","7                     Categorical Features                 9\n","8                         Ordinal Features             False\n","9                High Cardinality Features             False\n","10                 High Cardinality Method              None\n","11                   Transformed Train Set       (13206, 72)\n","12                    Transformed Test Set        (5660, 72)\n","13                      Shuffle Train-Test              True\n","14                     Stratify Train-Test             False\n","15                          Fold Generator   StratifiedKFold\n","16                             Fold Number                10\n","17                                CPU Jobs                -1\n","18                                 Use GPU             False\n","19                          Log Experiment             False\n","20                         Experiment Name  clf-default-name\n","21                                     USI              32ee\n","22                         Imputation Type            simple\n","23          Iterative Imputation Iteration              None\n","24                         Numeric Imputer              mean\n","25      Iterative Imputation Numeric Model              None\n","26                     Categorical Imputer          constant\n","27  Iterative Imputation Categorical Model              None\n","28           Unknown Categoricals Handling    least_frequent\n","29                               Normalize             False\n","30                        Normalize Method              None\n","31                          Transformation             False\n","32                   Transformation Method              None\n","33                                     PCA             False\n","34                              PCA Method              None\n","35                          PCA Components              None\n","36                     Ignore Low Variance             False\n","37                     Combine Rare Levels             False\n","38                    Rare Level Threshold              None\n","39                         Numeric Binning             False\n","40                         Remove Outliers             False\n","41                      Outliers Threshold              None\n","42                Remove Multicollinearity             False\n","43             Multicollinearity Threshold              None\n","44             Remove Perfect Collinearity              True\n","45                              Clustering             False\n","46                    Clustering Iteration              None\n","47                     Polynomial Features             False\n","48                       Polynomial Degree              None\n","49                    Trignometry Features             False\n","50                    Polynomial Threshold              None\n","51                          Group Features             False\n","52                       Feature Selection             False\n","53                Feature Selection Method           classic\n","54            Features Selection Threshold              None\n","55                     Feature Interaction             False\n","56                           Feature Ratio             False\n","57                   Interaction Threshold              None\n","58                           Fix Imbalance             False\n","59                    Fix Imbalance Method             SMOTE"],"text/html":["\n","  <div id=\"df-2c7c9883-c107-4a1b-b7f3-2408ff318c41\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Description</th>\n","      <th>Value</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>session_id</td>\n","      <td>210</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Target</td>\n","      <td>target</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Target Type</td>\n","      <td>Binary</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Label Encoded</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Original Data</td>\n","      <td>(18866, 36)</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Missing Values</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Numeric Features</td>\n","      <td>26</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Categorical Features</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Ordinal Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>High Cardinality Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>High Cardinality Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Transformed Train Set</td>\n","      <td>(13206, 72)</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Transformed Test Set</td>\n","      <td>(5660, 72)</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Shuffle Train-Test</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Stratify Train-Test</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Fold Generator</td>\n","      <td>StratifiedKFold</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Fold Number</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>CPU Jobs</td>\n","      <td>-1</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>Use GPU</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>Log Experiment</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>Experiment Name</td>\n","      <td>clf-default-name</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>USI</td>\n","      <td>32ee</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>Imputation Type</td>\n","      <td>simple</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>Iterative Imputation Iteration</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>Numeric Imputer</td>\n","      <td>mean</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>Iterative Imputation Numeric Model</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>Categorical Imputer</td>\n","      <td>constant</td>\n","    </tr>\n","    <tr>\n","      <th>27</th>\n","      <td>Iterative Imputation Categorical Model</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>28</th>\n","      <td>Unknown Categoricals Handling</td>\n","      <td>least_frequent</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>Normalize</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>Normalize Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Transformation</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>Transformation Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>33</th>\n","      <td>PCA</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>34</th>\n","      <td>PCA Method</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>35</th>\n","      <td>PCA Components</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>36</th>\n","      <td>Ignore Low Variance</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>37</th>\n","      <td>Combine Rare Levels</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>38</th>\n","      <td>Rare Level Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>39</th>\n","      <td>Numeric Binning</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>Remove Outliers</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>41</th>\n","      <td>Outliers Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>42</th>\n","      <td>Remove Multicollinearity</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>43</th>\n","      <td>Multicollinearity Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>44</th>\n","      <td>Remove Perfect Collinearity</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>45</th>\n","      <td>Clustering</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>46</th>\n","      <td>Clustering Iteration</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>47</th>\n","      <td>Polynomial Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>48</th>\n","      <td>Polynomial Degree</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>49</th>\n","      <td>Trignometry Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>50</th>\n","      <td>Polynomial Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>51</th>\n","      <td>Group Features</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>52</th>\n","      <td>Feature Selection</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>53</th>\n","      <td>Feature Selection Method</td>\n","      <td>classic</td>\n","    </tr>\n","    <tr>\n","      <th>54</th>\n","      <td>Features Selection Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>55</th>\n","      <td>Feature Interaction</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>56</th>\n","      <td>Feature Ratio</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>57</th>\n","      <td>Interaction Threshold</td>\n","      <td>None</td>\n","    </tr>\n","    <tr>\n","      <th>58</th>\n","      <td>Fix Imbalance</td>\n","      <td>False</td>\n","    </tr>\n","    <tr>\n","      <th>59</th>\n","      <td>Fix Imbalance Method</td>\n","      <td>SMOTE</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2c7c9883-c107-4a1b-b7f3-2408ff318c41')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2c7c9883-c107-4a1b-b7f3-2408ff318c41 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2c7c9883-c107-4a1b-b7f3-2408ff318c41');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["INFO:logs:create_model_container: 0\n","INFO:logs:master_model_container: 0\n","INFO:logs:display_container: 1\n","INFO:logs:Pipeline(memory=None,\n","         steps=[('dtypes',\n","                 DataTypes_Auto_infer(categorical_features=[],\n","                                      display_types=True, features_todrop=[],\n","                                      id_columns=[],\n","                                      ml_usecase='classification',\n","                                      numerical_features=[], target='target',\n","                                      time_features=[])),\n","                ('imputer',\n","                 Simple_Imputer(categorical_strategy='not_available',\n","                                fill_value_categorical=None,\n","                                fill_value_numerical=None,\n","                                numeric_strat...\n","                ('scaling', 'passthrough'), ('P_transform', 'passthrough'),\n","                ('binn', 'passthrough'), ('rem_outliers', 'passthrough'),\n","                ('cluster_all', 'passthrough'),\n","                ('dummy', Dummify(target='target')),\n","                ('fix_perfect', Remove_100(target='target')),\n","                ('clean_names', Clean_Colum_Names()),\n","                ('feature_select', 'passthrough'), ('fix_multi', 'passthrough'),\n","                ('dfs', 'passthrough'), ('pca', 'passthrough')],\n","         verbose=False)\n","INFO:logs:setup() succesfully completed......................................\n"]}]},{"cell_type":"code","source":["best_model = compare_models()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":794,"referenced_widgets":["69917a17ccb947bf86a3dac9a242709a","f1470cf98a714390ad103f1c84430770","a4920837be504e429f42b2b4380a81cf"]},"executionInfo":{"status":"ok","timestamp":1673416622460,"user_tz":-540,"elapsed":134723,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"bdd41fe2-7d87-4619-f724-9a75c29e8da8","id":"60y6_HPErGfb"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["                                    Model  Accuracy     AUC  Recall   Prec.  \\\n","gbc          Gradient Boosting Classifier    0.7631  0.8440  0.7872  0.7825   \n","catboost              CatBoost Classifier    0.7628  0.8425  0.7862  0.7824   \n","lightgbm  Light Gradient Boosting Machine    0.7617  0.8400  0.7840  0.7822   \n","rf               Random Forest Classifier    0.7603  0.8384  0.7813  0.7818   \n","lr                    Logistic Regression    0.7586  0.8367  0.7961  0.7715   \n","ada                  Ada Boost Classifier    0.7582  0.8331  0.7923  0.7728   \n","et                 Extra Trees Classifier    0.7495  0.8290  0.7802  0.7673   \n","ridge                    Ridge Classifier    0.7478  0.0000  0.7875  0.7613   \n","lda          Linear Discriminant Analysis    0.7478  0.8268  0.7874  0.7614   \n","xgboost         Extreme Gradient Boosting    0.7463  0.8254  0.7704  0.7679   \n","knn                K Neighbors Classifier    0.7286  0.7846  0.7854  0.7372   \n","svm                   SVM - Linear Kernel    0.7258  0.0000  0.7510  0.7494   \n","nb                            Naive Bayes    0.6995  0.7789  0.6378  0.7746   \n","dt               Decision Tree Classifier    0.6719  0.6688  0.7009  0.7008   \n","dummy                    Dummy Classifier    0.5484  0.5000  1.0000  0.5484   \n","qda       Quadratic Discriminant Analysis    0.5182  0.4919  0.7643  0.5424   \n","\n","              F1   Kappa     MCC  TT (Sec)  \n","gbc       0.7847  0.5215  0.5217     2.073  \n","catboost  0.7842  0.5208  0.5210     4.770  \n","lightgbm  0.7830  0.5188  0.5190     0.152  \n","rf        0.7814  0.5160  0.5162     1.047  \n","lr        0.7834  0.5109  0.5115     0.650  \n","ada       0.7823  0.5105  0.5109     0.462  \n","et        0.7736  0.4933  0.4936     0.724  \n","ridge     0.7740  0.4888  0.4895     0.029  \n","lda       0.7740  0.4888  0.4895     0.064  \n","xgboost   0.7690  0.4877  0.4878     1.445  \n","knn       0.7605  0.4482  0.4495     0.627  \n","svm       0.7414  0.4481  0.4556     0.133  \n","nb        0.6995  0.4046  0.4124     0.022  \n","dt        0.7008  0.3376  0.3376     0.131  \n","dummy     0.7083  0.0000  0.0000     0.017  \n","qda       0.6320 -0.0168 -0.0170     0.040  "],"text/html":["\n","  <div id=\"df-1151b214-a8d0-4cb0-803e-84e549f84122\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Model</th>\n","      <th>Accuracy</th>\n","      <th>AUC</th>\n","      <th>Recall</th>\n","      <th>Prec.</th>\n","      <th>F1</th>\n","      <th>Kappa</th>\n","      <th>MCC</th>\n","      <th>TT (Sec)</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>gbc</th>\n","      <td>Gradient Boosting Classifier</td>\n","      <td>0.7631</td>\n","      <td>0.8440</td>\n","      <td>0.7872</td>\n","      <td>0.7825</td>\n","      <td>0.7847</td>\n","      <td>0.5215</td>\n","      <td>0.5217</td>\n","      <td>2.073</td>\n","    </tr>\n","    <tr>\n","      <th>catboost</th>\n","      <td>CatBoost Classifier</td>\n","      <td>0.7628</td>\n","      <td>0.8425</td>\n","      <td>0.7862</td>\n","      <td>0.7824</td>\n","      <td>0.7842</td>\n","      <td>0.5208</td>\n","      <td>0.5210</td>\n","      <td>4.770</td>\n","    </tr>\n","    <tr>\n","      <th>lightgbm</th>\n","      <td>Light Gradient Boosting Machine</td>\n","      <td>0.7617</td>\n","      <td>0.8400</td>\n","      <td>0.7840</td>\n","      <td>0.7822</td>\n","      <td>0.7830</td>\n","      <td>0.5188</td>\n","      <td>0.5190</td>\n","      <td>0.152</td>\n","    </tr>\n","    <tr>\n","      <th>rf</th>\n","      <td>Random Forest Classifier</td>\n","      <td>0.7603</td>\n","      <td>0.8384</td>\n","      <td>0.7813</td>\n","      <td>0.7818</td>\n","      <td>0.7814</td>\n","      <td>0.5160</td>\n","      <td>0.5162</td>\n","      <td>1.047</td>\n","    </tr>\n","    <tr>\n","      <th>lr</th>\n","      <td>Logistic Regression</td>\n","      <td>0.7586</td>\n","      <td>0.8367</td>\n","      <td>0.7961</td>\n","      <td>0.7715</td>\n","      <td>0.7834</td>\n","      <td>0.5109</td>\n","      <td>0.5115</td>\n","      <td>0.650</td>\n","    </tr>\n","    <tr>\n","      <th>ada</th>\n","      <td>Ada Boost Classifier</td>\n","      <td>0.7582</td>\n","      <td>0.8331</td>\n","      <td>0.7923</td>\n","      <td>0.7728</td>\n","      <td>0.7823</td>\n","      <td>0.5105</td>\n","      <td>0.5109</td>\n","      <td>0.462</td>\n","    </tr>\n","    <tr>\n","      <th>et</th>\n","      <td>Extra Trees Classifier</td>\n","      <td>0.7495</td>\n","      <td>0.8290</td>\n","      <td>0.7802</td>\n","      <td>0.7673</td>\n","      <td>0.7736</td>\n","      <td>0.4933</td>\n","      <td>0.4936</td>\n","      <td>0.724</td>\n","    </tr>\n","    <tr>\n","      <th>ridge</th>\n","      <td>Ridge Classifier</td>\n","      <td>0.7478</td>\n","      <td>0.0000</td>\n","      <td>0.7875</td>\n","      <td>0.7613</td>\n","      <td>0.7740</td>\n","      <td>0.4888</td>\n","      <td>0.4895</td>\n","      <td>0.029</td>\n","    </tr>\n","    <tr>\n","      <th>lda</th>\n","      <td>Linear Discriminant Analysis</td>\n","      <td>0.7478</td>\n","      <td>0.8268</td>\n","      <td>0.7874</td>\n","      <td>0.7614</td>\n","      <td>0.7740</td>\n","      <td>0.4888</td>\n","      <td>0.4895</td>\n","      <td>0.064</td>\n","    </tr>\n","    <tr>\n","      <th>xgboost</th>\n","      <td>Extreme Gradient Boosting</td>\n","      <td>0.7463</td>\n","      <td>0.8254</td>\n","      <td>0.7704</td>\n","      <td>0.7679</td>\n","      <td>0.7690</td>\n","      <td>0.4877</td>\n","      <td>0.4878</td>\n","      <td>1.445</td>\n","    </tr>\n","    <tr>\n","      <th>knn</th>\n","      <td>K Neighbors Classifier</td>\n","      <td>0.7286</td>\n","      <td>0.7846</td>\n","      <td>0.7854</td>\n","      <td>0.7372</td>\n","      <td>0.7605</td>\n","      <td>0.4482</td>\n","      <td>0.4495</td>\n","      <td>0.627</td>\n","    </tr>\n","    <tr>\n","      <th>svm</th>\n","      <td>SVM - Linear Kernel</td>\n","      <td>0.7258</td>\n","      <td>0.0000</td>\n","      <td>0.7510</td>\n","      <td>0.7494</td>\n","      <td>0.7414</td>\n","      <td>0.4481</td>\n","      <td>0.4556</td>\n","      <td>0.133</td>\n","    </tr>\n","    <tr>\n","      <th>nb</th>\n","      <td>Naive Bayes</td>\n","      <td>0.6995</td>\n","      <td>0.7789</td>\n","      <td>0.6378</td>\n","      <td>0.7746</td>\n","      <td>0.6995</td>\n","      <td>0.4046</td>\n","      <td>0.4124</td>\n","      <td>0.022</td>\n","    </tr>\n","    <tr>\n","      <th>dt</th>\n","      <td>Decision Tree Classifier</td>\n","      <td>0.6719</td>\n","      <td>0.6688</td>\n","      <td>0.7009</td>\n","      <td>0.7008</td>\n","      <td>0.7008</td>\n","      <td>0.3376</td>\n","      <td>0.3376</td>\n","      <td>0.131</td>\n","    </tr>\n","    <tr>\n","      <th>dummy</th>\n","      <td>Dummy Classifier</td>\n","      <td>0.5484</td>\n","      <td>0.5000</td>\n","      <td>1.0000</td>\n","      <td>0.5484</td>\n","      <td>0.7083</td>\n","      <td>0.0000</td>\n","      <td>0.0000</td>\n","      <td>0.017</td>\n","    </tr>\n","    <tr>\n","      <th>qda</th>\n","      <td>Quadratic Discriminant Analysis</td>\n","      <td>0.5182</td>\n","      <td>0.4919</td>\n","      <td>0.7643</td>\n","      <td>0.5424</td>\n","      <td>0.6320</td>\n","      <td>-0.0168</td>\n","      <td>-0.0170</td>\n","      <td>0.040</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1151b214-a8d0-4cb0-803e-84e549f84122')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1151b214-a8d0-4cb0-803e-84e549f84122 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1151b214-a8d0-4cb0-803e-84e549f84122');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["INFO:logs:create_model_container: 16\n","INFO:logs:master_model_container: 16\n","INFO:logs:display_container: 2\n","INFO:logs:GradientBoostingClassifier(ccp_alpha=0.0, criterion='friedman_mse', init=None,\n","                           learning_rate=0.1, loss='deviance', max_depth=3,\n","                           max_features=None, max_leaf_nodes=None,\n","                           min_impurity_decrease=0.0, min_impurity_split=None,\n","                           min_samples_leaf=1, min_samples_split=2,\n","                           min_weight_fraction_leaf=0.0, n_estimators=100,\n","                           n_iter_no_change=None, presort='deprecated',\n","                           random_state=210, subsample=1.0, tol=0.0001,\n","                           validation_fraction=0.1, verbose=0,\n","                           warm_start=False)\n","INFO:logs:compare_models() succesfully completed......................................\n"]}]},{"cell_type":"code","source":["rf_n = create_model('rf')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":665,"referenced_widgets":["e3204ba66bf24291ac41d8918804aa85","15b1c2518d074ee0a98cea7cc1e2c878","5361f751151148ffac77e0574e842543"]},"id":"cl9PS3l2tIhL","executionInfo":{"status":"ok","timestamp":1673416640055,"user_tz":-540,"elapsed":12354,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"07f0ea3c-97a8-4b03-ad7c-ccd4f9831dca"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["      Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC\n","Fold                                                          \n","0       0.7578  0.8368  0.7873  0.7745  0.7808  0.5101  0.5102\n","1       0.7540  0.8281  0.7818  0.7722  0.7769  0.5027  0.5027\n","2       0.7419  0.8374  0.7514  0.7716  0.7614  0.4804  0.4806\n","3       0.7547  0.8402  0.7831  0.7725  0.7778  0.5042  0.5042\n","4       0.7699  0.8404  0.7572  0.8109  0.7832  0.5386  0.5401\n","5       0.7570  0.8323  0.7917  0.7715  0.7815  0.5079  0.5081\n","6       0.7576  0.8406  0.7956  0.7701  0.7826  0.5088  0.5091\n","7       0.7682  0.8450  0.7928  0.7863  0.7895  0.5315  0.5316\n","8       0.7689  0.8373  0.7901  0.7890  0.7895  0.5334  0.5334\n","9       0.7727  0.8456  0.7818  0.7994  0.7905  0.5422  0.5424\n","Mean    0.7603  0.8384  0.7813  0.7818  0.7814  0.5160  0.5162\n","Std     0.0090  0.0051  0.0143  0.0135  0.0081  0.0187  0.0188"],"text/html":["\n","  <div id=\"df-d99cfe41-a1ad-49bf-b797-44e9a97af263\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Accuracy</th>\n","      <th>AUC</th>\n","      <th>Recall</th>\n","      <th>Prec.</th>\n","      <th>F1</th>\n","      <th>Kappa</th>\n","      <th>MCC</th>\n","    </tr>\n","    <tr>\n","      <th>Fold</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0.7578</td>\n","      <td>0.8368</td>\n","      <td>0.7873</td>\n","      <td>0.7745</td>\n","      <td>0.7808</td>\n","      <td>0.5101</td>\n","      <td>0.5102</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.7540</td>\n","      <td>0.8281</td>\n","      <td>0.7818</td>\n","      <td>0.7722</td>\n","      <td>0.7769</td>\n","      <td>0.5027</td>\n","      <td>0.5027</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.7419</td>\n","      <td>0.8374</td>\n","      <td>0.7514</td>\n","      <td>0.7716</td>\n","      <td>0.7614</td>\n","      <td>0.4804</td>\n","      <td>0.4806</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.7547</td>\n","      <td>0.8402</td>\n","      <td>0.7831</td>\n","      <td>0.7725</td>\n","      <td>0.7778</td>\n","      <td>0.5042</td>\n","      <td>0.5042</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0.7699</td>\n","      <td>0.8404</td>\n","      <td>0.7572</td>\n","      <td>0.8109</td>\n","      <td>0.7832</td>\n","      <td>0.5386</td>\n","      <td>0.5401</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>0.7570</td>\n","      <td>0.8323</td>\n","      <td>0.7917</td>\n","      <td>0.7715</td>\n","      <td>0.7815</td>\n","      <td>0.5079</td>\n","      <td>0.5081</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>0.7576</td>\n","      <td>0.8406</td>\n","      <td>0.7956</td>\n","      <td>0.7701</td>\n","      <td>0.7826</td>\n","      <td>0.5088</td>\n","      <td>0.5091</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>0.7682</td>\n","      <td>0.8450</td>\n","      <td>0.7928</td>\n","      <td>0.7863</td>\n","      <td>0.7895</td>\n","      <td>0.5315</td>\n","      <td>0.5316</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>0.7689</td>\n","      <td>0.8373</td>\n","      <td>0.7901</td>\n","      <td>0.7890</td>\n","      <td>0.7895</td>\n","      <td>0.5334</td>\n","      <td>0.5334</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>0.7727</td>\n","      <td>0.8456</td>\n","      <td>0.7818</td>\n","      <td>0.7994</td>\n","      <td>0.7905</td>\n","      <td>0.5422</td>\n","      <td>0.5424</td>\n","    </tr>\n","    <tr>\n","      <th>Mean</th>\n","      <td>0.7603</td>\n","      <td>0.8384</td>\n","      <td>0.7813</td>\n","      <td>0.7818</td>\n","      <td>0.7814</td>\n","      <td>0.5160</td>\n","      <td>0.5162</td>\n","    </tr>\n","    <tr>\n","      <th>Std</th>\n","      <td>0.0090</td>\n","      <td>0.0051</td>\n","      <td>0.0143</td>\n","      <td>0.0135</td>\n","      <td>0.0081</td>\n","      <td>0.0187</td>\n","      <td>0.0188</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d99cfe41-a1ad-49bf-b797-44e9a97af263')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d99cfe41-a1ad-49bf-b797-44e9a97af263 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d99cfe41-a1ad-49bf-b797-44e9a97af263');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["INFO:logs:create_model_container: 18\n","INFO:logs:master_model_container: 18\n","INFO:logs:display_container: 4\n","INFO:logs:RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,\n","                       criterion='gini', max_depth=None, max_features='auto',\n","                       max_leaf_nodes=None, max_samples=None,\n","                       min_impurity_decrease=0.0, min_impurity_split=None,\n","                       min_samples_leaf=1, min_samples_split=2,\n","                       min_weight_fraction_leaf=0.0, n_estimators=100,\n","                       n_jobs=-1, oob_score=False, random_state=210, verbose=0,\n","                       warm_start=False)\n","INFO:logs:create_model() succesfully completed......................................\n"]}]},{"cell_type":"code","source":["pred_n = predict_model(best_model, data=test_set_2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":324},"id":"GtafivuYqhQP","executionInfo":{"status":"ok","timestamp":1673416645435,"user_tz":-540,"elapsed":901,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"356d60e2-737b-4d25-fcff-b27ee0207fa2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:logs:Initializing predict_model()\n","INFO:logs:predict_model(estimator=GradientBoostingClassifier(ccp_alpha=0.0, criterion='friedman_mse', init=None,\n","                           learning_rate=0.1, loss='deviance', max_depth=3,\n","                           max_features=None, max_leaf_nodes=None,\n","                           min_impurity_decrease=0.0, min_impurity_split=None,\n","                           min_samples_leaf=1, min_samples_split=2,\n","                           min_weight_fraction_leaf=0.0, n_estimators=100,\n","                           n_iter_no_change=None, presort='deprecated',\n","                           random_state=210, subsample=1.0, tol=0.0001,\n","                           validation_fraction=0.1, verbose=0,\n","                           warm_start=False), probability_threshold=None, encoded_labels=False, drift_report=False, raw_score=False, round=4, verbose=True, ml_usecase=MLUsecase.CLASSIFICATION, display=None, drift_kwargs=None)\n","INFO:logs:Checking exceptions\n","INFO:logs:Preloading libraries\n","INFO:logs:Preparing display monitor\n"]},{"output_type":"display_data","data":{"text/plain":["                          Model  Accuracy     AUC  Recall   Prec.      F1  \\\n","0  Gradient Boosting Classifier    0.6977  0.7894  0.7694  0.6198  0.6865   \n","\n","   Kappa     MCC  \n","0  0.401  0.4098  "],"text/html":["\n","  <div id=\"df-5fd66288-6f57-423c-b098-7917105ed6b5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Model</th>\n","      <th>Accuracy</th>\n","      <th>AUC</th>\n","      <th>Recall</th>\n","      <th>Prec.</th>\n","      <th>F1</th>\n","      <th>Kappa</th>\n","      <th>MCC</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Gradient Boosting Classifier</td>\n","      <td>0.6977</td>\n","      <td>0.7894</td>\n","      <td>0.7694</td>\n","      <td>0.6198</td>\n","      <td>0.6865</td>\n","      <td>0.401</td>\n","      <td>0.4098</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5fd66288-6f57-423c-b098-7917105ed6b5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5fd66288-6f57-423c-b098-7917105ed6b5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5fd66288-6f57-423c-b098-7917105ed6b5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"code","source":["pred1 = predict_model(rf_n, data=test_set_2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":289},"id":"Yu2zGwLjs9oh","executionInfo":{"status":"ok","timestamp":1673416645970,"user_tz":-540,"elapsed":544,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"02ca80a0-b7ad-4214-dcea-973e8b1ca3f5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:logs:Initializing predict_model()\n","INFO:logs:predict_model(estimator=RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,\n","                       criterion='gini', max_depth=None, max_features='auto',\n","                       max_leaf_nodes=None, max_samples=None,\n","                       min_impurity_decrease=0.0, min_impurity_split=None,\n","                       min_samples_leaf=1, min_samples_split=2,\n","                       min_weight_fraction_leaf=0.0, n_estimators=100,\n","                       n_jobs=-1, oob_score=False, random_state=210, verbose=0,\n","                       warm_start=False), probability_threshold=None, encoded_labels=False, drift_report=False, raw_score=False, round=4, verbose=True, ml_usecase=MLUsecase.CLASSIFICATION, display=None, drift_kwargs=None)\n","INFO:logs:Checking exceptions\n","INFO:logs:Preloading libraries\n","INFO:logs:Preparing display monitor\n"]},{"output_type":"display_data","data":{"text/plain":["                      Model  Accuracy     AUC  Recall   Prec.      F1   Kappa  \\\n","0  Random Forest Classifier    0.7033  0.7901  0.7841  0.6234  0.6946  0.4133   \n","\n","      MCC  \n","0  0.4236  "],"text/html":["\n","  <div id=\"df-4b693a71-06b3-4595-9067-c7cf4b9b8e29\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Model</th>\n","      <th>Accuracy</th>\n","      <th>AUC</th>\n","      <th>Recall</th>\n","      <th>Prec.</th>\n","      <th>F1</th>\n","      <th>Kappa</th>\n","      <th>MCC</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Random Forest Classifier</td>\n","      <td>0.7033</td>\n","      <td>0.7901</td>\n","      <td>0.7841</td>\n","      <td>0.6234</td>\n","      <td>0.6946</td>\n","      <td>0.4133</td>\n","      <td>0.4236</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4b693a71-06b3-4595-9067-c7cf4b9b8e29')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4b693a71-06b3-4595-9067-c7cf4b9b8e29 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4b693a71-06b3-4595-9067-c7cf4b9b8e29');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{}}]},{"cell_type":"markdown","source":["## 2) Sklearn"],"metadata":{"id":"L0BLVcugluWr"}},{"cell_type":"code","source":["from sklearn.tree import DecisionTreeClassifier\n","from sklearn.ensemble import RandomForestClassifier\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.metrics import accuracy_score"],"metadata":{"id":"7X_PJcIW8T6a"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["dt_clf = DecisionTreeClassifier()\n","rf_clf = RandomForestClassifier()\n","lr_clf = LogisticRegression()"],"metadata":{"id":"dupzR8228gLX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["X_train = train2.loc[:, train2.columns != 'target']\n","y_train = train2[['target']]\n","\n","X_test = test2.loc[:, test2.columns != 'target']\n","y_test = test2[['target']]"],"metadata":{"id":"F0VsibJT8r8g"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_train = np.array(y_train).flatten()\n","y_test = np.array(y_test).flatten()"],"metadata":{"id":"2yheDMh-877N"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### (1) prediction"],"metadata":{"id":"DZ6geDAOBMAY"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"900a70db-fd85-4ae9-abb8-4541f8516bd9","outputId":"49415a39-52e7-4153-c245-f9c3d50799e7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1673419490661,"user_tz":-540,"elapsed":736,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["정확도:  0.6303\n"]}],"source":["dt_clf.fit(X_train, y_train)\n","pred = dt_clf.predict(X_test)\n","print('정확도: ', accuracy_score(y_test, pred).round(4))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"c5320809-ca83-4072-af1d-e47488cc9eea","outputId":"6a44a8b4-99f4-41b6-e6af-a8721363503a","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1673419497100,"user_tz":-540,"elapsed":6444,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["정확도:  0.701\n"]}],"source":["rf_clf.fit(X_train, y_train)\n","pred = rf_clf.predict(X_test)\n","print('정확도: ', accuracy_score(y_test, pred).round(4))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"602b4b22-7908-4ff7-b046-68642f15b09f","outputId":"9d45831d-1b06-4cd4-ff24-3b13b3bc4506","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1673419497533,"user_tz":-540,"elapsed":438,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["정확도:  0.6733\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.8/dist-packages/sklearn/linear_model/_logistic.py:814: ConvergenceWarning: lbfgs failed to converge (status=1):\n","STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n","\n","Increase the number of iterations (max_iter) or scale the data as shown in:\n","    https://scikit-learn.org/stable/modules/preprocessing.html\n","Please also refer to the documentation for alternative solver options:\n","    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n","  n_iter_i = _check_optimize_result(\n"]}],"source":["lr_clf.fit(X_train, y_train)\n","pred = lr_clf.predict(X_test)\n","print('정확도: ', accuracy_score(y_test, pred).round(4))"]},{"cell_type":"markdown","source":["### (2) gridsearch cv"],"metadata":{"id":"lp8Oyyd1_XwZ"}},{"cell_type":"markdown","source":["#### decision tree"],"metadata":{"id":"vsaLE3BALj84"}},{"cell_type":"code","source":["from sklearn.model_selection import GridSearchCV\n","parameters = {'max_depth': [2, 3, 4, 10], 'min_samples_split': [2, 3, 5],\n","             'min_samples_leaf': [1, 5, 8]}\n","\n","grid_dclf = GridSearchCV(dt_clf, param_grid = parameters, scoring = 'accuracy', cv = 5)\n","grid_dclf.fit(X_train, y_train)\n","\n","best_dclf = grid_dclf.best_estimator_\n","\n","pred_dt = best_dclf.predict(X_test)\n","acc_dt = accuracy_score(y_test, pred)\n","\n","print(best_dclf)\n","print('최고 정확도: ', grid_dclf.best_score_)\n","print('DecisionTreeClassifier 정확도: ', acc_dt)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8O-AvIEn_HcG","executionInfo":{"status":"ok","timestamp":1673419522372,"user_tz":-540,"elapsed":24843,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"cd199579-e3a9-45cd-e6d9-d0a680c386d2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["DecisionTreeClassifier(max_depth=4)\n","최고 정확도:  0.7562290061689823\n","DecisionTreeClassifier 정확도:  0.6733276794233012\n"]}]},{"cell_type":"code","source":["best_dt_clf = DecisionTreeClassifier(max_depth=4)\n","best_dt_clf.fit(X_train, y_train)\n","dt_pred = best_dt_clf.predict(X_test)\n","print('정확도: ', accuracy_score(y_test, dt_pred).round(4))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vVHVOuMQ_qfC","executionInfo":{"status":"ok","timestamp":1673419522373,"user_tz":-540,"elapsed":8,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"a3e932ca-ea39-4293-f37c-267c3777257d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도:  0.7163\n"]}]},{"cell_type":"markdown","source":["#### random forest"],"metadata":{"id":"-qWvaq79LnXu"}},{"cell_type":"code","source":["parameters = {'max_depth': [2, 3, 4, 10], 'min_samples_split': [2, 3, 5],\n","             'min_samples_leaf': [1, 5, 8]}\n","\n","grid_rfclf = GridSearchCV(rf_clf, param_grid = parameters, scoring = 'accuracy', cv = 5)\n","grid_rfclf.fit(X_train, y_train)\n","\n","best_rfclf = grid_rfclf.best_estimator_\n","\n","pred_rf = best_rfclf.predict(X_test)\n","acc_rf = accuracy_score(y_test, pred_rf)\n","\n","print(best_rfclf)\n","print('최고 정확도: ', grid_rfclf.best_score_)\n","print('RandomForestClassifier 정확도: ', acc_rf)"],"metadata":{"id":"zO433DV2_c9v"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["best_rf_clf = RandomForestClassifier(max_depth=10, min_samples_split=3)\n","best_rf_clf.fit(X_train, y_train)\n","pred = best_rf_clf.predict(X_test)\n","print('정확도: ', accuracy_score(y_test, pred).round(4))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1673408275165,"user_tz":-540,"elapsed":4218,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"2ca25f06-d562-4dc5-9a17-723ef77687dc","id":"9gr23Ec_AKvK"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도:  0.7017\n"]}]},{"cell_type":"markdown","source":["#### logistic regression"],"metadata":{"id":"rTwJcANrLxjW"}},{"cell_type":"code","source":["params = {'solver': ['liblinear', 'lbfgs'],\n","         'penalty': ['l2'],\n","         'C': [0.01, 0.1, 1, 1, 5, 10]}\n","\n","grid_lrclf = GridSearchCV(lr_clf, param_grid = params, scoring = 'accuracy', cv = 5)\n","grid_lrclf.fit(X_train, y_train)\n","\n","best_lrclf = grid_lrclf.best_estimator_\n","\n","pred_lr = grid_lrclf.predict(X_test)\n","acc_lr = accuracy_score(y_test, pred_lr)"],"metadata":{"id":"KKfwZgQO_o5O"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print('LogisticRegression 정확도: ', acc_lr)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rCYfWZwmw8ui","executionInfo":{"status":"ok","timestamp":1673338805158,"user_tz":-540,"elapsed":7,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"7516b46d-9a46-42cf-e412-d4ef7b7c2b14"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["LogisticRegression 정확도:  0.6768790416622495\n"]}]},{"cell_type":"code","source":["best_lr_clf = LogisticRegression(C=5)\n","best_lr_clf.fit(X_train, y_train)\n","pred = best_lr_clf.predict(X_test)"],"metadata":{"id":"rHpyX51HAdvs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print('정확도: ', accuracy_score(y_test, pred).round(4))"],"metadata":{"id":"FMlRpZFnm6B3","executionInfo":{"status":"ok","timestamp":1673420059519,"user_tz":-540,"elapsed":388,"user":{"displayName":"Ye Ji Kim","userId":"11027673293297094848"}},"outputId":"61fd24ba-41a9-45c0-d7c4-bb6840452d8e","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도:  0.6727\n"]}]},{"cell_type":"markdown","source":["# #7. 군집화\n","cluster_total 데이터 기반으로 군집화 후 특성 파악"],"metadata":{"id":"kHdBZKViQQK9"}},{"cell_type":"markdown","source":["## 1) 데이터 로드"],"metadata":{"id":"pqp7Y2zDNwbe"}},{"cell_type":"code","source":["clust_new = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/bc_total.csv')"],"metadata":{"id":"oIVgCEaE2gGc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["c3 = pd.read_csv('/content/drive/MyDrive/KDT/2차프로젝트/abc.csv')"],"metadata":{"id":"XZusXSXU7XLc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["clust_new"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"Yzogf-dU3Hqc","executionInfo":{"status":"ok","timestamp":1673424311544,"user_tz":-540,"elapsed":4660,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"2938f1d4-04ec-430a-dcb0-1e80ae29da95"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          Unnamed: 0   고객번호  대분류코드  중분류코드    소분류코드  중분류명  소분류명 대분류    영수증번호  \\\n","0                  0      1      3    308  C030808   나물류    파래  식품  5846089   \n","1                  1      1      1    106  A010603  가공식품  서양델리  식품  2580495   \n","2                  2      1      1    106  A010603  가공식품  서양델리  식품  2580494   \n","3                  3      1      1    106  A010603  가공식품  서양델리  식품  2541458   \n","4                  4      1      1    106  A010603  가공식품  서양델리  식품  2454072   \n","...              ...    ...    ...    ...      ...   ...   ...  ..      ...   \n","10924591    10924591  19333      1    106  A010607  가공식품  제과제빵  식품  2045112   \n","10924592    10924592  19333      1    106  A010607  가공식품  제과제빵  식품  1902248   \n","10924593    10924593  19333      1    106  A010607  가공식품  제과제빵  식품  1957198   \n","10924594    10924594  19333      1    106  A010603  가공식품  서양델리  식품  2014079   \n","10924595    10924595  19333      1    106  A010607  가공식품  제과제빵  식품  3457412   \n","\n","          점포코드  ...  구매시간   구매금액  성별  연령대  거주지역    년도  분류 분기  제휴사 유형  \n","0           96  ...    11   1000   0    6   1.0  2015  저가  5    C  1  \n","1           12  ...    17  13000   0    6   1.0  2014  중가  3    A  1  \n","2           12  ...    17  12000   0    6   1.0  2014  중가  3    A  1  \n","3           12  ...    13   6500   0    6   1.0  2014  중가  3    A  1  \n","4           12  ...    19  10000   0    6   1.0  2014  중가  3    A  1  \n","...        ...  ...   ...    ...  ..  ...   ...   ...  .. ..  ... ..  \n","10924591    26  ...    20   8000   1    2   NaN  2014  중가  2    A  0  \n","10924592     2  ...    18  10000   1    2   NaN  2014  중가  2    A  0  \n","10924593     1  ...    20   7000   1    2   NaN  2014  중가  2    A  0  \n","10924594     3  ...    14   5000   1    2   NaN  2014  저가  2    A  0  \n","10924595    26  ...    17  12000   1    2   NaN  2015  중가  5    A  0  \n","\n","[10924596 rows x 21 columns]"],"text/html":["\n","  <div id=\"df-b4fe1b37-af90-4b04-a676-2aaf30126809\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>고객번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>소분류코드</th>\n","      <th>중분류명</th>\n","      <th>소분류명</th>\n","      <th>대분류</th>\n","      <th>영수증번호</th>\n","      <th>점포코드</th>\n","      <th>...</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>년도</th>\n","      <th>분류</th>\n","      <th>분기</th>\n","      <th>제휴사</th>\n","      <th>유형</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>308</td>\n","      <td>C030808</td>\n","      <td>나물류</td>\n","      <td>파래</td>\n","      <td>식품</td>\n","      <td>5846089</td>\n","      <td>96</td>\n","      <td>...</td>\n","      <td>11</td>\n","      <td>1000</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>1.0</td>\n","      <td>2015</td>\n","      <td>저가</td>\n","      <td>5</td>\n","      <td>C</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010603</td>\n","      <td>가공식품</td>\n","      <td>서양델리</td>\n","      <td>식품</td>\n","      <td>2580495</td>\n","      <td>12</td>\n","      <td>...</td>\n","      <td>17</td>\n","      <td>13000</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>1.0</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>3</td>\n","      <td>A</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010603</td>\n","      <td>가공식품</td>\n","      <td>서양델리</td>\n","      <td>식품</td>\n","      <td>2580494</td>\n","      <td>12</td>\n","      <td>...</td>\n","      <td>17</td>\n","      <td>12000</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>1.0</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>3</td>\n","      <td>A</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010603</td>\n","      <td>가공식품</td>\n","      <td>서양델리</td>\n","      <td>식품</td>\n","      <td>2541458</td>\n","      <td>12</td>\n","      <td>...</td>\n","      <td>13</td>\n","      <td>6500</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>1.0</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>3</td>\n","      <td>A</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010603</td>\n","      <td>가공식품</td>\n","      <td>서양델리</td>\n","      <td>식품</td>\n","      <td>2454072</td>\n","      <td>12</td>\n","      <td>...</td>\n","      <td>19</td>\n","      <td>10000</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>1.0</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>3</td>\n","      <td>A</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>10924591</th>\n","      <td>10924591</td>\n","      <td>19333</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010607</td>\n","      <td>가공식품</td>\n","      <td>제과제빵</td>\n","      <td>식품</td>\n","      <td>2045112</td>\n","      <td>26</td>\n","      <td>...</td>\n","      <td>20</td>\n","      <td>8000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>2</td>\n","      <td>A</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10924592</th>\n","      <td>10924592</td>\n","      <td>19333</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010607</td>\n","      <td>가공식품</td>\n","      <td>제과제빵</td>\n","      <td>식품</td>\n","      <td>1902248</td>\n","      <td>2</td>\n","      <td>...</td>\n","      <td>18</td>\n","      <td>10000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>2</td>\n","      <td>A</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10924593</th>\n","      <td>10924593</td>\n","      <td>19333</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010607</td>\n","      <td>가공식품</td>\n","      <td>제과제빵</td>\n","      <td>식품</td>\n","      <td>1957198</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>20</td>\n","      <td>7000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>2014</td>\n","      <td>중가</td>\n","      <td>2</td>\n","      <td>A</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10924594</th>\n","      <td>10924594</td>\n","      <td>19333</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010603</td>\n","      <td>가공식품</td>\n","      <td>서양델리</td>\n","      <td>식품</td>\n","      <td>2014079</td>\n","      <td>3</td>\n","      <td>...</td>\n","      <td>14</td>\n","      <td>5000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>2014</td>\n","      <td>저가</td>\n","      <td>2</td>\n","      <td>A</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>10924595</th>\n","      <td>10924595</td>\n","      <td>19333</td>\n","      <td>1</td>\n","      <td>106</td>\n","      <td>A010607</td>\n","      <td>가공식품</td>\n","      <td>제과제빵</td>\n","      <td>식품</td>\n","      <td>3457412</td>\n","      <td>26</td>\n","      <td>...</td>\n","      <td>17</td>\n","      <td>12000</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>NaN</td>\n","      <td>2015</td>\n","      <td>중가</td>\n","      <td>5</td>\n","      <td>A</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>10924596 rows × 21 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b4fe1b37-af90-4b04-a676-2aaf30126809')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b4fe1b37-af90-4b04-a676-2aaf30126809 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b4fe1b37-af90-4b04-a676-2aaf30126809');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["clust_new.groupby('유형').mean()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":336},"id":"REwCeT2E3NdR","executionInfo":{"status":"ok","timestamp":1673426979055,"user_tz":-540,"elapsed":2017,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"0813e237-09b3-4bda-f77a-f342fbc8fecf"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      Unnamed: 0          고객번호      대분류코드        중분류코드         영수증번호  \\\n","유형                                                                     \n","0   4.574553e+06   7791.347615  14.272496  1431.098805  5.467649e+06   \n","1   6.228310e+06  10643.493479  24.970998  2500.740083  7.618136e+06   \n","2   5.713836e+06   9753.497164  14.618859  1465.322514  6.127697e+06   \n","3   5.614247e+06   9574.291553  14.884065  1492.085171  5.944008e+06   \n","4   4.544646e+06   7731.043966  12.486111  1252.474223  5.194155e+06   \n","\n","          점포코드          구매일자       구매시간          구매금액        성별       연령대  \\\n","유형                                                                          \n","0    54.360448  2.014482e+07  16.006496  53108.883423  0.810147  4.270312   \n","1    68.975959  2.014471e+07  16.945684   8800.735263  0.822514  4.013328   \n","2   125.694686  2.014477e+07  16.893160  13454.887905  0.815533  4.068322   \n","3    85.591587  2.014405e+07  16.491807  32642.267990  0.826254  4.019914   \n","4    51.355995  2.014515e+07  16.201345  66190.404220  0.844169  4.189381   \n","\n","        거주지역           년도        분기  \n","유형                                   \n","0   4.653064  2014.421793  3.973760  \n","1   4.877947  2014.411296  3.911891  \n","2   4.938010  2014.417349  3.947350  \n","3   5.265047  2014.346512  3.630558  \n","4   5.068563  2014.453462  4.133009  "],"text/html":["\n","  <div id=\"df-6d40aac6-a268-4fbb-b2e6-ea050a8c0231\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>고객번호</th>\n","      <th>대분류코드</th>\n","      <th>중분류코드</th>\n","      <th>영수증번호</th>\n","      <th>점포코드</th>\n","      <th>구매일자</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>거주지역</th>\n","      <th>년도</th>\n","      <th>분기</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>4.574553e+06</td>\n","      <td>7791.347615</td>\n","      <td>14.272496</td>\n","      <td>1431.098805</td>\n","      <td>5.467649e+06</td>\n","      <td>54.360448</td>\n","      <td>2.014482e+07</td>\n","      <td>16.006496</td>\n","      <td>53108.883423</td>\n","      <td>0.810147</td>\n","      <td>4.270312</td>\n","      <td>4.653064</td>\n","      <td>2014.421793</td>\n","      <td>3.973760</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>6.228310e+06</td>\n","      <td>10643.493479</td>\n","      <td>24.970998</td>\n","      <td>2500.740083</td>\n","      <td>7.618136e+06</td>\n","      <td>68.975959</td>\n","      <td>2.014471e+07</td>\n","      <td>16.945684</td>\n","      <td>8800.735263</td>\n","      <td>0.822514</td>\n","      <td>4.013328</td>\n","      <td>4.877947</td>\n","      <td>2014.411296</td>\n","      <td>3.911891</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>5.713836e+06</td>\n","      <td>9753.497164</td>\n","      <td>14.618859</td>\n","      <td>1465.322514</td>\n","      <td>6.127697e+06</td>\n","      <td>125.694686</td>\n","      <td>2.014477e+07</td>\n","      <td>16.893160</td>\n","      <td>13454.887905</td>\n","      <td>0.815533</td>\n","      <td>4.068322</td>\n","      <td>4.938010</td>\n","      <td>2014.417349</td>\n","      <td>3.947350</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>5.614247e+06</td>\n","      <td>9574.291553</td>\n","      <td>14.884065</td>\n","      <td>1492.085171</td>\n","      <td>5.944008e+06</td>\n","      <td>85.591587</td>\n","      <td>2.014405e+07</td>\n","      <td>16.491807</td>\n","      <td>32642.267990</td>\n","      <td>0.826254</td>\n","      <td>4.019914</td>\n","      <td>5.265047</td>\n","      <td>2014.346512</td>\n","      <td>3.630558</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4.544646e+06</td>\n","      <td>7731.043966</td>\n","      <td>12.486111</td>\n","      <td>1252.474223</td>\n","      <td>5.194155e+06</td>\n","      <td>51.355995</td>\n","      <td>2.014515e+07</td>\n","      <td>16.201345</td>\n","      <td>66190.404220</td>\n","      <td>0.844169</td>\n","      <td>4.189381</td>\n","      <td>5.068563</td>\n","      <td>2014.453462</td>\n","      <td>4.133009</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6d40aac6-a268-4fbb-b2e6-ea050a8c0231')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6d40aac6-a268-4fbb-b2e6-ea050a8c0231 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6d40aac6-a268-4fbb-b2e6-ea050a8c0231');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":78}]},{"cell_type":"code","source":["c3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"X1OoXypa8Ec8","executionInfo":{"status":"ok","timestamp":1673426988880,"user_tz":-540,"elapsed":689,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"5b7002f7-8b2d-448a-ffaf-66b1c4bced85"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      Unnamed: 0   고객번호  성별  연령대  Recency_R  구매횟수_F  구매금액_M  식품_구매지수  \\\n","0              0      1   0    6          1       5       5     -2.4   \n","1              1      2   0    6          2       4       5     -1.0   \n","2              2      7   1    6          2       2       5      0.2   \n","3              3      8   0    6          4       4       5      0.0   \n","4              4     10   1    6          3       5       3     -0.6   \n","...          ...    ...  ..  ...        ...     ...     ...      ...   \n","8651        8651  19307   1    4          2       3       2      0.2   \n","8652        8652  19314   1    4          1       3       5      5.8   \n","8653        8653  19325   1    4          2       3       3      0.0   \n","8654        8654  19327   0    5          1       5       1      0.8   \n","8655        8655  19333   1    2          2       4       1      1.4   \n","\n","        연평균성장률  A_구매지수  유형     실루엣계수  \n","0    -0.259681     0.4   3  0.206964  \n","1    -0.033423     1.6   0  0.201205  \n","2    -1.763857     0.8   0  0.229214  \n","3     0.329797     1.0   2  0.141752  \n","4    -0.259288     1.0   2  0.253469  \n","...        ...     ...  ..       ...  \n","8651 -0.194816     0.6   1  0.203918  \n","8652 -1.194635     0.0   4  0.462464  \n","8653 -0.906757     2.2   0  0.051092  \n","8654 -0.953285     0.0   2  0.052596  \n","8655 -1.377282    -0.2   1  0.062217  \n","\n","[8656 rows x 12 columns]"],"text/html":["\n","  <div id=\"df-77f33e46-2f08-47f1-971b-6ac076b728c0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>고객번호</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>Recency_R</th>\n","      <th>구매횟수_F</th>\n","      <th>구매금액_M</th>\n","      <th>식품_구매지수</th>\n","      <th>연평균성장률</th>\n","      <th>A_구매지수</th>\n","      <th>유형</th>\n","      <th>실루엣계수</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>-2.4</td>\n","      <td>-0.259681</td>\n","      <td>0.4</td>\n","      <td>3</td>\n","      <td>0.206964</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>-1.0</td>\n","      <td>-0.033423</td>\n","      <td>1.6</td>\n","      <td>0</td>\n","      <td>0.201205</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>7</td>\n","      <td>1</td>\n","      <td>6</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>0.2</td>\n","      <td>-1.763857</td>\n","      <td>0.8</td>\n","      <td>0</td>\n","      <td>0.229214</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>8</td>\n","      <td>0</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>0.0</td>\n","      <td>0.329797</td>\n","      <td>1.0</td>\n","      <td>2</td>\n","      <td>0.141752</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>10</td>\n","      <td>1</td>\n","      <td>6</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>-0.6</td>\n","      <td>-0.259288</td>\n","      <td>1.0</td>\n","      <td>2</td>\n","      <td>0.253469</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>8651</th>\n","      <td>8651</td>\n","      <td>19307</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>0.2</td>\n","      <td>-0.194816</td>\n","      <td>0.6</td>\n","      <td>1</td>\n","      <td>0.203918</td>\n","    </tr>\n","    <tr>\n","      <th>8652</th>\n","      <td>8652</td>\n","      <td>19314</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>5.8</td>\n","      <td>-1.194635</td>\n","      <td>0.0</td>\n","      <td>4</td>\n","      <td>0.462464</td>\n","    </tr>\n","    <tr>\n","      <th>8653</th>\n","      <td>8653</td>\n","      <td>19325</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>0.0</td>\n","      <td>-0.906757</td>\n","      <td>2.2</td>\n","      <td>0</td>\n","      <td>0.051092</td>\n","    </tr>\n","    <tr>\n","      <th>8654</th>\n","      <td>8654</td>\n","      <td>19327</td>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>1</td>\n","      <td>0.8</td>\n","      <td>-0.953285</td>\n","      <td>0.0</td>\n","      <td>2</td>\n","      <td>0.052596</td>\n","    </tr>\n","    <tr>\n","      <th>8655</th>\n","      <td>8655</td>\n","      <td>19333</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>1.4</td>\n","      <td>-1.377282</td>\n","      <td>-0.2</td>\n","      <td>1</td>\n","      <td>0.062217</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>8656 rows × 12 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-77f33e46-2f08-47f1-971b-6ac076b728c0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-77f33e46-2f08-47f1-971b-6ac076b728c0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-77f33e46-2f08-47f1-971b-6ac076b728c0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":79}]},{"cell_type":"code","source":["c3.groupby('유형').mean()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":282},"id":"nm3ZwlpQRZ1O","executionInfo":{"status":"ok","timestamp":1673431204195,"user_tz":-540,"elapsed":471,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"cee1e96c-f2f2-48e4-ca91-2832b02fc6d0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["     Unnamed: 0          고객번호        성별       연령대  Recency_R    구매횟수_F  \\\n","유형                                                                       \n","0   3670.671782   7592.289604  0.812871  4.276733   1.881683  3.367822   \n","1   5061.779678  10637.187626  0.826459  3.973843   2.628270  1.705734   \n","2   4581.425348   9580.081613  0.818051  4.083053   4.025444  4.228036   \n","3   4437.984375   9248.169531  0.825781  4.003125   2.074219  3.382031   \n","4   3702.362646   7651.612451  0.840467  4.199222   2.694163  3.162646   \n","\n","      구매금액_M   식품_구매지수    연평균성장률    A_구매지수     실루엣계수  \n","유형                                                    \n","0   4.389109  1.211980 -0.730716  0.547030  0.238177  \n","1   1.929074  0.213280 -0.695965  0.416298  0.202868  \n","2   2.845895  0.303217 -0.546942  0.626116  0.211821  \n","3   3.562500 -2.326719 -1.621312 -0.099219  0.178003  \n","4   4.323735  4.902101 -0.641989  0.594086  0.344207  "],"text/html":["\n","  <div id=\"df-1aee1612-e99e-477c-a72e-d1f5fe025828\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>고객번호</th>\n","      <th>성별</th>\n","      <th>연령대</th>\n","      <th>Recency_R</th>\n","      <th>구매횟수_F</th>\n","      <th>구매금액_M</th>\n","      <th>식품_구매지수</th>\n","      <th>연평균성장률</th>\n","      <th>A_구매지수</th>\n","      <th>실루엣계수</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>3670.671782</td>\n","      <td>7592.289604</td>\n","      <td>0.812871</td>\n","      <td>4.276733</td>\n","      <td>1.881683</td>\n","      <td>3.367822</td>\n","      <td>4.389109</td>\n","      <td>1.211980</td>\n","      <td>-0.730716</td>\n","      <td>0.547030</td>\n","      <td>0.238177</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>5061.779678</td>\n","      <td>10637.187626</td>\n","      <td>0.826459</td>\n","      <td>3.973843</td>\n","      <td>2.628270</td>\n","      <td>1.705734</td>\n","      <td>1.929074</td>\n","      <td>0.213280</td>\n","      <td>-0.695965</td>\n","      <td>0.416298</td>\n","      <td>0.202868</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>4581.425348</td>\n","      <td>9580.081613</td>\n","      <td>0.818051</td>\n","      <td>4.083053</td>\n","      <td>4.025444</td>\n","      <td>4.228036</td>\n","      <td>2.845895</td>\n","      <td>0.303217</td>\n","      <td>-0.546942</td>\n","      <td>0.626116</td>\n","      <td>0.211821</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4437.984375</td>\n","      <td>9248.169531</td>\n","      <td>0.825781</td>\n","      <td>4.003125</td>\n","      <td>2.074219</td>\n","      <td>3.382031</td>\n","      <td>3.562500</td>\n","      <td>-2.326719</td>\n","      <td>-1.621312</td>\n","      <td>-0.099219</td>\n","      <td>0.178003</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>3702.362646</td>\n","      <td>7651.612451</td>\n","      <td>0.840467</td>\n","      <td>4.199222</td>\n","      <td>2.694163</td>\n","      <td>3.162646</td>\n","      <td>4.323735</td>\n","      <td>4.902101</td>\n","      <td>-0.641989</td>\n","      <td>0.594086</td>\n","      <td>0.344207</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1aee1612-e99e-477c-a72e-d1f5fe025828')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-1aee1612-e99e-477c-a72e-d1f5fe025828 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-1aee1612-e99e-477c-a72e-d1f5fe025828');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":103}]},{"cell_type":"markdown","source":["## 2) 군집별 속성 파악"],"metadata":{"id":"DbS0TdPPqv9C"}},{"cell_type":"code","source":["# 군집별 인원수\n","df = clust_new.groupby('고객번호').agg({'유형':'mean', '고객번호':'mean'})\n","df = df.groupby('유형')[['고객번호']].count()\n","df = df.rename(columns={'고객번호':'사람수'})\n","df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":238},"id":"30xNd1Q13p9v","executionInfo":{"status":"ok","timestamp":1673427001809,"user_tz":-540,"elapsed":489,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"a81b7b07-e853-45f3-fe89-12c3a1d298f9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      사람수\n","유형       \n","0.0  2020\n","1.0  1988\n","2.0  2083\n","3.0  1280\n","4.0  1285"],"text/html":["\n","  <div id=\"df-0903b0ad-b763-4f70-aa70-95e37f5412bd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>사람수</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>2020</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>1988</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>2083</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>1280</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>1285</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0903b0ad-b763-4f70-aa70-95e37f5412bd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0903b0ad-b763-4f70-aa70-95e37f5412bd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0903b0ad-b763-4f70-aa70-95e37f5412bd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":80}]},{"cell_type":"code","source":["# 대분류별 구매금액 평균\n","df1 = clust_new.groupby(['고객번호', '대분류']).agg({'유형':'mean', '구매금액':'sum'})\n","df1 = df1.groupby(['유형','대분류'])[['구매금액']].mean().unstack(level=1)\n","df1"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"id":"YgRP7tsz3cfl","executionInfo":{"status":"ok","timestamp":1673427005629,"user_tz":-540,"elapsed":1288,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"20cb20e3-395d-41cd-eb9a-a7a8f5c4552c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             구매금액                                                           \\\n","대분류            기타            식품            음식점            의류      의약품/의료기기   \n","유형                                                                           \n","0.0  2.798011e+06  1.260983e+07  114557.289328  2.317482e+07  48811.088235   \n","1.0  4.918240e+05  5.580915e+06  115991.455260  1.464611e+06  51174.501372   \n","2.0  8.801999e+05  9.685000e+06  131571.104981  5.669767e+06  52713.050616   \n","3.0  1.429914e+06  1.160828e+07  121160.478166  1.312263e+07  51006.341991   \n","4.0  2.873742e+06  9.229302e+06   87624.759690  2.601309e+07  42544.591549   \n","\n","                                               \n","대분류          일상용품            주거            취미  \n","유형                                             \n","0.0  1.421606e+07  2.946577e+06  2.397625e+06  \n","1.0  2.337867e+06  3.631935e+05  4.539478e+05  \n","2.0  6.136154e+06  8.798663e+05  8.992837e+05  \n","3.0  9.361239e+06  1.828600e+06  1.948184e+06  \n","4.0  1.530200e+07  3.046564e+06  2.884701e+06  "],"text/html":["\n","  <div id=\"df-d648a582-b561-4aa8-928c-8ea7ad294776\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th></th>\n","      <th colspan=\"8\" halign=\"left\">구매금액</th>\n","    </tr>\n","    <tr>\n","      <th>대분류</th>\n","      <th>기타</th>\n","      <th>식품</th>\n","      <th>음식점</th>\n","      <th>의류</th>\n","      <th>의약품/의료기기</th>\n","      <th>일상용품</th>\n","      <th>주거</th>\n","      <th>취미</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>2.798011e+06</td>\n","      <td>1.260983e+07</td>\n","      <td>114557.289328</td>\n","      <td>2.317482e+07</td>\n","      <td>48811.088235</td>\n","      <td>1.421606e+07</td>\n","      <td>2.946577e+06</td>\n","      <td>2.397625e+06</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>4.918240e+05</td>\n","      <td>5.580915e+06</td>\n","      <td>115991.455260</td>\n","      <td>1.464611e+06</td>\n","      <td>51174.501372</td>\n","      <td>2.337867e+06</td>\n","      <td>3.631935e+05</td>\n","      <td>4.539478e+05</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>8.801999e+05</td>\n","      <td>9.685000e+06</td>\n","      <td>131571.104981</td>\n","      <td>5.669767e+06</td>\n","      <td>52713.050616</td>\n","      <td>6.136154e+06</td>\n","      <td>8.798663e+05</td>\n","      <td>8.992837e+05</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>1.429914e+06</td>\n","      <td>1.160828e+07</td>\n","      <td>121160.478166</td>\n","      <td>1.312263e+07</td>\n","      <td>51006.341991</td>\n","      <td>9.361239e+06</td>\n","      <td>1.828600e+06</td>\n","      <td>1.948184e+06</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>2.873742e+06</td>\n","      <td>9.229302e+06</td>\n","      <td>87624.759690</td>\n","      <td>2.601309e+07</td>\n","      <td>42544.591549</td>\n","      <td>1.530200e+07</td>\n","      <td>3.046564e+06</td>\n","      <td>2.884701e+06</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d648a582-b561-4aa8-928c-8ea7ad294776')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d648a582-b561-4aa8-928c-8ea7ad294776 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d648a582-b561-4aa8-928c-8ea7ad294776');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":81}]},{"cell_type":"code","source":["# 총 구매금액 평균\n","df2 = clust_new.groupby(['고객번호']).agg({'유형' :'mean', '구매금액':'sum'})\n","df2 = df2.groupby(['유형'])[['구매금액']].mean()\n","df2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":238},"executionInfo":{"status":"ok","timestamp":1673427008734,"user_tz":-540,"elapsed":490,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"5ffdadc5-1abe-4a92-ccb0-de69ce89c599","id":"QyOndATp4mkT"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             구매금액\n","유형               \n","0.0  5.766110e+07\n","1.0  1.066637e+07\n","2.0  2.362788e+07\n","3.0  3.876550e+07\n","4.0  5.892723e+07"],"text/html":["\n","  <div id=\"df-9e65d613-213b-42d8-b7ed-bd5c624234ea\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>구매금액</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>5.766110e+07</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>1.066637e+07</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>2.362788e+07</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>3.876550e+07</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>5.892723e+07</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9e65d613-213b-42d8-b7ed-bd5c624234ea')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9e65d613-213b-42d8-b7ed-bd5c624234ea button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9e65d613-213b-42d8-b7ed-bd5c624234ea');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":82}]},{"cell_type":"code","source":["# 연령, 성별 평균\n","df3 = clust_new.groupby(['고객번호'])[['연령대', '성별','유형']].mean()\n","df3 = df3.groupby(['유형'])[['연령대', '성별']].mean()\n","df3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":238},"executionInfo":{"status":"ok","timestamp":1673427011643,"user_tz":-540,"elapsed":477,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"45baa83d-1840-48da-dd8c-9f983faaa8c2","id":"fnMdJXlL4mkT"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          연령대        성별\n","유형                     \n","0.0  4.276733  0.812871\n","1.0  3.973843  0.826459\n","2.0  4.083053  0.818051\n","3.0  4.003125  0.825781\n","4.0  4.199222  0.840467"],"text/html":["\n","  <div id=\"df-63aa5e8d-a3e2-43f3-8ae6-8f70295eac30\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>연령대</th>\n","      <th>성별</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>4.276733</td>\n","      <td>0.812871</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>3.973843</td>\n","      <td>0.826459</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>4.083053</td>\n","      <td>0.818051</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>4.003125</td>\n","      <td>0.825781</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>4.199222</td>\n","      <td>0.840467</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-63aa5e8d-a3e2-43f3-8ae6-8f70295eac30')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-63aa5e8d-a3e2-43f3-8ae6-8f70295eac30 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-63aa5e8d-a3e2-43f3-8ae6-8f70295eac30');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":83}]},{"cell_type":"code","source":["# 금액 분류별 평균 구매금액, 평균 구매횟수\n","df4 = clust_new.groupby(['고객번호', '분류']).agg({'유형':'mean', '영수증번호':'count', '구매금액':'sum'})\n","df4 = df4.groupby(['유형','분류'])[['구매금액','영수증번호']].mean().unstack(level=1)\n","df4"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"executionInfo":{"status":"ok","timestamp":1673427015426,"user_tz":-540,"elapsed":1793,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"5c5640b8-3447-4110-968f-007d19452ce5","id":"CdEn8i094mkU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             구매금액                                   영수증번호               \\\n","분류             고가            저가            중가          고가           저가   \n","유형                                                                       \n","0.0  4.205929e+07  3.974860e+06  1.162696e+07  169.769307   503.445545   \n","1.0  3.385750e+06  3.205595e+06  4.094117e+06   57.148635   802.440141   \n","2.0  1.256751e+07  4.343676e+06  6.716698e+06  100.156505  1168.665386   \n","3.0  2.648903e+07  3.782372e+06  8.494093e+06  125.464062   666.160938   \n","4.0  4.397447e+07  3.651997e+06  1.130076e+07  150.611673   403.785992   \n","\n","                 \n","분류           중가  \n","유형               \n","0.0  412.500000  \n","1.0  352.862607  \n","2.0  487.259722  \n","3.0  395.960938  \n","4.0  335.870817  "],"text/html":["\n","  <div id=\"df-d08583e7-6e18-4e93-9e7a-7070a42887fa\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th></th>\n","      <th colspan=\"3\" halign=\"left\">구매금액</th>\n","      <th colspan=\"3\" halign=\"left\">영수증번호</th>\n","    </tr>\n","    <tr>\n","      <th>분류</th>\n","      <th>고가</th>\n","      <th>저가</th>\n","      <th>중가</th>\n","      <th>고가</th>\n","      <th>저가</th>\n","      <th>중가</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>4.205929e+07</td>\n","      <td>3.974860e+06</td>\n","      <td>1.162696e+07</td>\n","      <td>169.769307</td>\n","      <td>503.445545</td>\n","      <td>412.500000</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>3.385750e+06</td>\n","      <td>3.205595e+06</td>\n","      <td>4.094117e+06</td>\n","      <td>57.148635</td>\n","      <td>802.440141</td>\n","      <td>352.862607</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>1.256751e+07</td>\n","      <td>4.343676e+06</td>\n","      <td>6.716698e+06</td>\n","      <td>100.156505</td>\n","      <td>1168.665386</td>\n","      <td>487.259722</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>2.648903e+07</td>\n","      <td>3.782372e+06</td>\n","      <td>8.494093e+06</td>\n","      <td>125.464062</td>\n","      <td>666.160938</td>\n","      <td>395.960938</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>4.397447e+07</td>\n","      <td>3.651997e+06</td>\n","      <td>1.130076e+07</td>\n","      <td>150.611673</td>\n","      <td>403.785992</td>\n","      <td>335.870817</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d08583e7-6e18-4e93-9e7a-7070a42887fa')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d08583e7-6e18-4e93-9e7a-7070a42887fa button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d08583e7-6e18-4e93-9e7a-7070a42887fa');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":84}]},{"cell_type":"code","source":["# 데이터 합산\n","total2 = pd.merge(pd.merge(pd.merge(pd.merge(df, df2, on='유형'), df3, on='유형'), df1, on='유형'), df4, on='유형')\n","total2"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"executionInfo":{"status":"ok","timestamp":1673427015427,"user_tz":-540,"elapsed":6,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"930b0c26-6063-4496-aad5-03e29f500350","id":"sUzexOhM4mkU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      사람수          구매금액       연령대        성별    (구매금액, 기타)    (구매금액, 식품)  \\\n","유형                                                                        \n","0.0  2020  5.766110e+07  4.276733  0.812871  2.798011e+06  1.260983e+07   \n","1.0  1988  1.066637e+07  3.973843  0.826459  4.918240e+05  5.580915e+06   \n","2.0  2083  2.362788e+07  4.083053  0.818051  8.801999e+05  9.685000e+06   \n","3.0  1280  3.876550e+07  4.003125  0.825781  1.429914e+06  1.160828e+07   \n","4.0  1285  5.892723e+07  4.199222  0.840467  2.873742e+06  9.229302e+06   \n","\n","       (구매금액, 음식점)    (구매금액, 의류)  (구매금액, 의약품/의료기기)  (구매금액, 일상용품)  \\\n","유형                                                                 \n","0.0  114557.289328  2.317482e+07      48811.088235  1.421606e+07   \n","1.0  115991.455260  1.464611e+06      51174.501372  2.337867e+06   \n","2.0  131571.104981  5.669767e+06      52713.050616  6.136154e+06   \n","3.0  121160.478166  1.312263e+07      51006.341991  9.361239e+06   \n","4.0   87624.759690  2.601309e+07      42544.591549  1.530200e+07   \n","\n","       (구매금액, 주거)    (구매금액, 취미)    (구매금액, 고가)    (구매금액, 저가)    (구매금액, 중가)  \\\n","유형                                                                          \n","0.0  2.946577e+06  2.397625e+06  4.205929e+07  3.974860e+06  1.162696e+07   \n","1.0  3.631935e+05  4.539478e+05  3.385750e+06  3.205595e+06  4.094117e+06   \n","2.0  8.798663e+05  8.992837e+05  1.256751e+07  4.343676e+06  6.716698e+06   \n","3.0  1.828600e+06  1.948184e+06  2.648903e+07  3.782372e+06  8.494093e+06   \n","4.0  3.046564e+06  2.884701e+06  4.397447e+07  3.651997e+06  1.130076e+07   \n","\n","     (영수증번호, 고가)  (영수증번호, 저가)  (영수증번호, 중가)  \n","유형                                          \n","0.0   169.769307   503.445545   412.500000  \n","1.0    57.148635   802.440141   352.862607  \n","2.0   100.156505  1168.665386   487.259722  \n","3.0   125.464062   666.160938   395.960938  \n","4.0   150.611673   403.785992   335.870817  "],"text/html":["\n","  <div id=\"df-7aecc6f6-f265-42d6-8261-7c8112eea99e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>사람수</th>\n","      <th>구매금액</th>\n","      <th>연령대</th>\n","      <th>성별</th>\n","      <th>(구매금액, 기타)</th>\n","      <th>(구매금액, 식품)</th>\n","      <th>(구매금액, 음식점)</th>\n","      <th>(구매금액, 의류)</th>\n","      <th>(구매금액, 의약품/의료기기)</th>\n","      <th>(구매금액, 일상용품)</th>\n","      <th>(구매금액, 주거)</th>\n","      <th>(구매금액, 취미)</th>\n","      <th>(구매금액, 고가)</th>\n","      <th>(구매금액, 저가)</th>\n","      <th>(구매금액, 중가)</th>\n","      <th>(영수증번호, 고가)</th>\n","      <th>(영수증번호, 저가)</th>\n","      <th>(영수증번호, 중가)</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>2020</td>\n","      <td>5.766110e+07</td>\n","      <td>4.276733</td>\n","      <td>0.812871</td>\n","      <td>2.798011e+06</td>\n","      <td>1.260983e+07</td>\n","      <td>114557.289328</td>\n","      <td>2.317482e+07</td>\n","      <td>48811.088235</td>\n","      <td>1.421606e+07</td>\n","      <td>2.946577e+06</td>\n","      <td>2.397625e+06</td>\n","      <td>4.205929e+07</td>\n","      <td>3.974860e+06</td>\n","      <td>1.162696e+07</td>\n","      <td>169.769307</td>\n","      <td>503.445545</td>\n","      <td>412.500000</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>1988</td>\n","      <td>1.066637e+07</td>\n","      <td>3.973843</td>\n","      <td>0.826459</td>\n","      <td>4.918240e+05</td>\n","      <td>5.580915e+06</td>\n","      <td>115991.455260</td>\n","      <td>1.464611e+06</td>\n","      <td>51174.501372</td>\n","      <td>2.337867e+06</td>\n","      <td>3.631935e+05</td>\n","      <td>4.539478e+05</td>\n","      <td>3.385750e+06</td>\n","      <td>3.205595e+06</td>\n","      <td>4.094117e+06</td>\n","      <td>57.148635</td>\n","      <td>802.440141</td>\n","      <td>352.862607</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>2083</td>\n","      <td>2.362788e+07</td>\n","      <td>4.083053</td>\n","      <td>0.818051</td>\n","      <td>8.801999e+05</td>\n","      <td>9.685000e+06</td>\n","      <td>131571.104981</td>\n","      <td>5.669767e+06</td>\n","      <td>52713.050616</td>\n","      <td>6.136154e+06</td>\n","      <td>8.798663e+05</td>\n","      <td>8.992837e+05</td>\n","      <td>1.256751e+07</td>\n","      <td>4.343676e+06</td>\n","      <td>6.716698e+06</td>\n","      <td>100.156505</td>\n","      <td>1168.665386</td>\n","      <td>487.259722</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>1280</td>\n","      <td>3.876550e+07</td>\n","      <td>4.003125</td>\n","      <td>0.825781</td>\n","      <td>1.429914e+06</td>\n","      <td>1.160828e+07</td>\n","      <td>121160.478166</td>\n","      <td>1.312263e+07</td>\n","      <td>51006.341991</td>\n","      <td>9.361239e+06</td>\n","      <td>1.828600e+06</td>\n","      <td>1.948184e+06</td>\n","      <td>2.648903e+07</td>\n","      <td>3.782372e+06</td>\n","      <td>8.494093e+06</td>\n","      <td>125.464062</td>\n","      <td>666.160938</td>\n","      <td>395.960938</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>1285</td>\n","      <td>5.892723e+07</td>\n","      <td>4.199222</td>\n","      <td>0.840467</td>\n","      <td>2.873742e+06</td>\n","      <td>9.229302e+06</td>\n","      <td>87624.759690</td>\n","      <td>2.601309e+07</td>\n","      <td>42544.591549</td>\n","      <td>1.530200e+07</td>\n","      <td>3.046564e+06</td>\n","      <td>2.884701e+06</td>\n","      <td>4.397447e+07</td>\n","      <td>3.651997e+06</td>\n","      <td>1.130076e+07</td>\n","      <td>150.611673</td>\n","      <td>403.785992</td>\n","      <td>335.870817</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7aecc6f6-f265-42d6-8261-7c8112eea99e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7aecc6f6-f265-42d6-8261-7c8112eea99e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7aecc6f6-f265-42d6-8261-7c8112eea99e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":85}]},{"cell_type":"markdown","source":["* RFM"],"metadata":{"id":"_5OcRfB44mkU"}},{"cell_type":"code","source":["rfm = clust_new[['고객번호', '영수증번호','구매일자']].drop_duplicates(['영수증번호'])\n","rfm = rfm.groupby('고객번호').agg({'구매일자':'max', '영수증번호':'count'})\n","rfm"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":455},"executionInfo":{"status":"ok","timestamp":1673427023201,"user_tz":-540,"elapsed":2132,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"9afabcb6-a856-479e-bf8a-5e7e5828e6f2","id":"C_l0uCh34mkU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           구매일자  영수증번호\n","고객번호                  \n","1      20150922    631\n","2      20150929    602\n","7      20150928    454\n","8      20150930    600\n","10     20150929    696\n","...         ...    ...\n","19307  20150928    495\n","19314  20150922    464\n","19325  20150929    469\n","19327  20150921    747\n","19333  20150928    563\n","\n","[8656 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-ade6f5c1-2e67-4c99-992e-c26663543cd5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>구매일자</th>\n","      <th>영수증번호</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>20150922</td>\n","      <td>631</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>20150929</td>\n","      <td>602</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>20150928</td>\n","      <td>454</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>20150930</td>\n","      <td>600</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>20150929</td>\n","      <td>696</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19307</th>\n","      <td>20150928</td>\n","      <td>495</td>\n","    </tr>\n","    <tr>\n","      <th>19314</th>\n","      <td>20150922</td>\n","      <td>464</td>\n","    </tr>\n","    <tr>\n","      <th>19325</th>\n","      <td>20150929</td>\n","      <td>469</td>\n","    </tr>\n","    <tr>\n","      <th>19327</th>\n","      <td>20150921</td>\n","      <td>747</td>\n","    </tr>\n","    <tr>\n","      <th>19333</th>\n","      <td>20150928</td>\n","      <td>563</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>8656 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ade6f5c1-2e67-4c99-992e-c26663543cd5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ade6f5c1-2e67-4c99-992e-c26663543cd5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ade6f5c1-2e67-4c99-992e-c26663543cd5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":86}]},{"cell_type":"code","source":["from datetime import datetime\n","date = datetime.strptime('20151001', '%Y%m%d') \n","date"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1673425038876,"user_tz":-540,"elapsed":488,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"205e64fb-e70b-448c-9145-3958ef6446b2","id":"XTif3yO14mkU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["datetime.datetime(2015, 10, 1, 0, 0)"]},"metadata":{},"execution_count":50}]},{"cell_type":"code","source":["rfm['구매일자'] = rfm['구매일자'].map(lambda x : date - datetime.strptime(str(x), '%Y%m%d'))\n","rfm"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":455},"executionInfo":{"status":"ok","timestamp":1673427027753,"user_tz":-540,"elapsed":471,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"e668e30f-5ab0-4358-ecc8-582901a52e19","id":"ID__8yEC4mkU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["         구매일자  영수증번호\n","고객번호                \n","1      9 days    631\n","2      2 days    602\n","7      3 days    454\n","8      1 days    600\n","10     2 days    696\n","...       ...    ...\n","19307  3 days    495\n","19314  9 days    464\n","19325  2 days    469\n","19327 10 days    747\n","19333  3 days    563\n","\n","[8656 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-a98e7f8d-69ba-4586-930c-aa3aef6469da\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>구매일자</th>\n","      <th>영수증번호</th>\n","    </tr>\n","    <tr>\n","      <th>고객번호</th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>9 days</td>\n","      <td>631</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2 days</td>\n","      <td>602</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>3 days</td>\n","      <td>454</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>1 days</td>\n","      <td>600</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>2 days</td>\n","      <td>696</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>19307</th>\n","      <td>3 days</td>\n","      <td>495</td>\n","    </tr>\n","    <tr>\n","      <th>19314</th>\n","      <td>9 days</td>\n","      <td>464</td>\n","    </tr>\n","    <tr>\n","      <th>19325</th>\n","      <td>2 days</td>\n","      <td>469</td>\n","    </tr>\n","    <tr>\n","      <th>19327</th>\n","      <td>10 days</td>\n","      <td>747</td>\n","    </tr>\n","    <tr>\n","      <th>19333</th>\n","      <td>3 days</td>\n","      <td>563</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>8656 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a98e7f8d-69ba-4586-930c-aa3aef6469da')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a98e7f8d-69ba-4586-930c-aa3aef6469da button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a98e7f8d-69ba-4586-930c-aa3aef6469da');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":87}]},{"cell_type":"code","source":["rfm =  pd.merge(rfm, c3[['고객번호', '유형']], on='고객번호')\n","rfm"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"executionInfo":{"status":"ok","timestamp":1673427037645,"user_tz":-540,"elapsed":471,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"8964e134-ab09-4503-cd1a-936d67a9c296","id":"YV739wiM4mkU"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       고객번호    구매일자  영수증번호  유형\n","0         1  9 days    631   3\n","1         2  2 days    602   0\n","2         7  3 days    454   0\n","3         8  1 days    600   2\n","4        10  2 days    696   2\n","...     ...     ...    ...  ..\n","8651  19307  3 days    495   1\n","8652  19314  9 days    464   4\n","8653  19325  2 days    469   0\n","8654  19327 10 days    747   2\n","8655  19333  3 days    563   1\n","\n","[8656 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-0822aad3-1ea8-4a30-a98a-afe643ad9eab\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>구매일자</th>\n","      <th>영수증번호</th>\n","      <th>유형</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>9 days</td>\n","      <td>631</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2</td>\n","      <td>2 days</td>\n","      <td>602</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>7</td>\n","      <td>3 days</td>\n","      <td>454</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>8</td>\n","      <td>1 days</td>\n","      <td>600</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>10</td>\n","      <td>2 days</td>\n","      <td>696</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>8651</th>\n","      <td>19307</td>\n","      <td>3 days</td>\n","      <td>495</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8652</th>\n","      <td>19314</td>\n","      <td>9 days</td>\n","      <td>464</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>8653</th>\n","      <td>19325</td>\n","      <td>2 days</td>\n","      <td>469</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>8654</th>\n","      <td>19327</td>\n","      <td>10 days</td>\n","      <td>747</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>8655</th>\n","      <td>19333</td>\n","      <td>3 days</td>\n","      <td>563</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>8656 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0822aad3-1ea8-4a30-a98a-afe643ad9eab')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0822aad3-1ea8-4a30-a98a-afe643ad9eab button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0822aad3-1ea8-4a30-a98a-afe643ad9eab');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":88}]},{"cell_type":"code","source":["rfm['구매일자'] = rfm['구매일자'].map(lambda x: x.days)"],"metadata":{"id":"WnaPDJaF4mkU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# 최근 구매일자, 구매 횟수 평균\n","rfm = rfm.groupby('유형')[['구매일자','영수증번호']].mean()\n","rfm"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":238},"executionInfo":{"status":"ok","timestamp":1673427054244,"user_tz":-540,"elapsed":4,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"3dc19d6c-ee67-4a03-b575-596f3618ed7e","id":"uGP3nX4E4mkV"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        구매일자       영수증번호\n","유형                      \n","0   5.247525  533.045545\n","1   4.353119  390.392857\n","2   1.314450  619.664906\n","3   6.779687  537.127344\n","4   3.538521  514.793774"],"text/html":["\n","  <div id=\"df-7842acdd-d113-43f0-a49b-7bf66b005e04\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>구매일자</th>\n","      <th>영수증번호</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>5.247525</td>\n","      <td>533.045545</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>4.353119</td>\n","      <td>390.392857</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1.314450</td>\n","      <td>619.664906</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>6.779687</td>\n","      <td>537.127344</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>3.538521</td>\n","      <td>514.793774</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7842acdd-d113-43f0-a49b-7bf66b005e04')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7842acdd-d113-43f0-a49b-7bf66b005e04 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7842acdd-d113-43f0-a49b-7bf66b005e04');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":90}]},{"cell_type":"code","source":["total3 = pd.merge(total2, rfm, on='유형')\n","total3"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"executionInfo":{"status":"ok","timestamp":1673427061804,"user_tz":-540,"elapsed":481,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"9188da21-1bb1-4641-edd6-4f94d7929dba","id":"6tq6dNRR4mkV"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      사람수          구매금액       연령대        성별    (구매금액, 기타)    (구매금액, 식품)  \\\n","유형                                                                        \n","0.0  2020  5.766110e+07  4.276733  0.812871  2.798011e+06  1.260983e+07   \n","1.0  1988  1.066637e+07  3.973843  0.826459  4.918240e+05  5.580915e+06   \n","2.0  2083  2.362788e+07  4.083053  0.818051  8.801999e+05  9.685000e+06   \n","3.0  1280  3.876550e+07  4.003125  0.825781  1.429914e+06  1.160828e+07   \n","4.0  1285  5.892723e+07  4.199222  0.840467  2.873742e+06  9.229302e+06   \n","\n","       (구매금액, 음식점)    (구매금액, 의류)  (구매금액, 의약품/의료기기)  (구매금액, 일상용품)  \\\n","유형                                                                 \n","0.0  114557.289328  2.317482e+07      48811.088235  1.421606e+07   \n","1.0  115991.455260  1.464611e+06      51174.501372  2.337867e+06   \n","2.0  131571.104981  5.669767e+06      52713.050616  6.136154e+06   \n","3.0  121160.478166  1.312263e+07      51006.341991  9.361239e+06   \n","4.0   87624.759690  2.601309e+07      42544.591549  1.530200e+07   \n","\n","       (구매금액, 주거)    (구매금액, 취미)    (구매금액, 고가)    (구매금액, 저가)    (구매금액, 중가)  \\\n","유형                                                                          \n","0.0  2.946577e+06  2.397625e+06  4.205929e+07  3.974860e+06  1.162696e+07   \n","1.0  3.631935e+05  4.539478e+05  3.385750e+06  3.205595e+06  4.094117e+06   \n","2.0  8.798663e+05  8.992837e+05  1.256751e+07  4.343676e+06  6.716698e+06   \n","3.0  1.828600e+06  1.948184e+06  2.648903e+07  3.782372e+06  8.494093e+06   \n","4.0  3.046564e+06  2.884701e+06  4.397447e+07  3.651997e+06  1.130076e+07   \n","\n","     (영수증번호, 고가)  (영수증번호, 저가)  (영수증번호, 중가)      구매일자       영수증번호  \n","유형                                                                \n","0.0   169.769307   503.445545   412.500000  5.247525  533.045545  \n","1.0    57.148635   802.440141   352.862607  4.353119  390.392857  \n","2.0   100.156505  1168.665386   487.259722  1.314450  619.664906  \n","3.0   125.464062   666.160938   395.960938  6.779687  537.127344  \n","4.0   150.611673   403.785992   335.870817  3.538521  514.793774  "],"text/html":["\n","  <div id=\"df-cd6780b9-ffd5-4c4c-930a-2e2617e5f65e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>사람수</th>\n","      <th>구매금액</th>\n","      <th>연령대</th>\n","      <th>성별</th>\n","      <th>(구매금액, 기타)</th>\n","      <th>(구매금액, 식품)</th>\n","      <th>(구매금액, 음식점)</th>\n","      <th>(구매금액, 의류)</th>\n","      <th>(구매금액, 의약품/의료기기)</th>\n","      <th>(구매금액, 일상용품)</th>\n","      <th>(구매금액, 주거)</th>\n","      <th>(구매금액, 취미)</th>\n","      <th>(구매금액, 고가)</th>\n","      <th>(구매금액, 저가)</th>\n","      <th>(구매금액, 중가)</th>\n","      <th>(영수증번호, 고가)</th>\n","      <th>(영수증번호, 저가)</th>\n","      <th>(영수증번호, 중가)</th>\n","      <th>구매일자</th>\n","      <th>영수증번호</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>2020</td>\n","      <td>5.766110e+07</td>\n","      <td>4.276733</td>\n","      <td>0.812871</td>\n","      <td>2.798011e+06</td>\n","      <td>1.260983e+07</td>\n","      <td>114557.289328</td>\n","      <td>2.317482e+07</td>\n","      <td>48811.088235</td>\n","      <td>1.421606e+07</td>\n","      <td>2.946577e+06</td>\n","      <td>2.397625e+06</td>\n","      <td>4.205929e+07</td>\n","      <td>3.974860e+06</td>\n","      <td>1.162696e+07</td>\n","      <td>169.769307</td>\n","      <td>503.445545</td>\n","      <td>412.500000</td>\n","      <td>5.247525</td>\n","      <td>533.045545</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>1988</td>\n","      <td>1.066637e+07</td>\n","      <td>3.973843</td>\n","      <td>0.826459</td>\n","      <td>4.918240e+05</td>\n","      <td>5.580915e+06</td>\n","      <td>115991.455260</td>\n","      <td>1.464611e+06</td>\n","      <td>51174.501372</td>\n","      <td>2.337867e+06</td>\n","      <td>3.631935e+05</td>\n","      <td>4.539478e+05</td>\n","      <td>3.385750e+06</td>\n","      <td>3.205595e+06</td>\n","      <td>4.094117e+06</td>\n","      <td>57.148635</td>\n","      <td>802.440141</td>\n","      <td>352.862607</td>\n","      <td>4.353119</td>\n","      <td>390.392857</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>2083</td>\n","      <td>2.362788e+07</td>\n","      <td>4.083053</td>\n","      <td>0.818051</td>\n","      <td>8.801999e+05</td>\n","      <td>9.685000e+06</td>\n","      <td>131571.104981</td>\n","      <td>5.669767e+06</td>\n","      <td>52713.050616</td>\n","      <td>6.136154e+06</td>\n","      <td>8.798663e+05</td>\n","      <td>8.992837e+05</td>\n","      <td>1.256751e+07</td>\n","      <td>4.343676e+06</td>\n","      <td>6.716698e+06</td>\n","      <td>100.156505</td>\n","      <td>1168.665386</td>\n","      <td>487.259722</td>\n","      <td>1.314450</td>\n","      <td>619.664906</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>1280</td>\n","      <td>3.876550e+07</td>\n","      <td>4.003125</td>\n","      <td>0.825781</td>\n","      <td>1.429914e+06</td>\n","      <td>1.160828e+07</td>\n","      <td>121160.478166</td>\n","      <td>1.312263e+07</td>\n","      <td>51006.341991</td>\n","      <td>9.361239e+06</td>\n","      <td>1.828600e+06</td>\n","      <td>1.948184e+06</td>\n","      <td>2.648903e+07</td>\n","      <td>3.782372e+06</td>\n","      <td>8.494093e+06</td>\n","      <td>125.464062</td>\n","      <td>666.160938</td>\n","      <td>395.960938</td>\n","      <td>6.779687</td>\n","      <td>537.127344</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>1285</td>\n","      <td>5.892723e+07</td>\n","      <td>4.199222</td>\n","      <td>0.840467</td>\n","      <td>2.873742e+06</td>\n","      <td>9.229302e+06</td>\n","      <td>87624.759690</td>\n","      <td>2.601309e+07</td>\n","      <td>42544.591549</td>\n","      <td>1.530200e+07</td>\n","      <td>3.046564e+06</td>\n","      <td>2.884701e+06</td>\n","      <td>4.397447e+07</td>\n","      <td>3.651997e+06</td>\n","      <td>1.130076e+07</td>\n","      <td>150.611673</td>\n","      <td>403.785992</td>\n","      <td>335.870817</td>\n","      <td>3.538521</td>\n","      <td>514.793774</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-cd6780b9-ffd5-4c4c-930a-2e2617e5f65e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-cd6780b9-ffd5-4c4c-930a-2e2617e5f65e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-cd6780b9-ffd5-4c4c-930a-2e2617e5f65e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":91}]},{"cell_type":"markdown","source":["* 제휴사별"],"metadata":{"id":"bPyFk8044mkV"}},{"cell_type":"code","source":["# 제휴사별 구매금액 평균\n","df6 = clust_new.groupby(['고객번호', '제휴사']).agg({'유형':'mean', '구매금액':'sum'})\n","df6 = df6.groupby(['유형','제휴사'])[['구매금액']].mean().unstack(level=1)\n","df6"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"executionInfo":{"status":"ok","timestamp":1673427068842,"user_tz":-540,"elapsed":1344,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"b4fd6b7c-c6e3-4540-9198-d47ca7631ebb","id":"OlGyN0mq4mkV"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["             구매금액                                           \n","제휴사             A             B             C              D\n","유형                                                          \n","0.0  5.153498e+07  4.965620e+06  2.077876e+06   72475.844156\n","1.0  3.599653e+06  6.673003e+06  8.615043e+05  440021.627907\n","2.0  1.508877e+07  4.385901e+06  5.183620e+06   87401.352542\n","3.0  3.101500e+07  6.477414e+06  2.475120e+06  108601.737089\n","4.0  5.551665e+07  3.146613e+06  8.521553e+05   81592.813765"],"text/html":["\n","  <div id=\"df-4a858201-ebaf-4adf-828e-513b7edeb200\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th></th>\n","      <th colspan=\"4\" halign=\"left\">구매금액</th>\n","    </tr>\n","    <tr>\n","      <th>제휴사</th>\n","      <th>A</th>\n","      <th>B</th>\n","      <th>C</th>\n","      <th>D</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>5.153498e+07</td>\n","      <td>4.965620e+06</td>\n","      <td>2.077876e+06</td>\n","      <td>72475.844156</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>3.599653e+06</td>\n","      <td>6.673003e+06</td>\n","      <td>8.615043e+05</td>\n","      <td>440021.627907</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>1.508877e+07</td>\n","      <td>4.385901e+06</td>\n","      <td>5.183620e+06</td>\n","      <td>87401.352542</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>3.101500e+07</td>\n","      <td>6.477414e+06</td>\n","      <td>2.475120e+06</td>\n","      <td>108601.737089</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>5.551665e+07</td>\n","      <td>3.146613e+06</td>\n","      <td>8.521553e+05</td>\n","      <td>81592.813765</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4a858201-ebaf-4adf-828e-513b7edeb200')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4a858201-ebaf-4adf-828e-513b7edeb200 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4a858201-ebaf-4adf-828e-513b7edeb200');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":92}]},{"cell_type":"code","source":["total4 = pd.merge(total3, df6, on='유형')\n","total4"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":383},"executionInfo":{"status":"ok","timestamp":1673427070962,"user_tz":-540,"elapsed":4,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"cb706834-bb8f-4ccd-9389-14cf617f8abd","id":"9oZ_WVEV4mkV"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      사람수          구매금액       연령대        성별    (구매금액, 기타)    (구매금액, 식품)  \\\n","유형                                                                        \n","0.0  2020  5.766110e+07  4.276733  0.812871  2.798011e+06  1.260983e+07   \n","1.0  1988  1.066637e+07  3.973843  0.826459  4.918240e+05  5.580915e+06   \n","2.0  2083  2.362788e+07  4.083053  0.818051  8.801999e+05  9.685000e+06   \n","3.0  1280  3.876550e+07  4.003125  0.825781  1.429914e+06  1.160828e+07   \n","4.0  1285  5.892723e+07  4.199222  0.840467  2.873742e+06  9.229302e+06   \n","\n","       (구매금액, 음식점)    (구매금액, 의류)  (구매금액, 의약품/의료기기)  (구매금액, 일상용품)  ...  \\\n","유형                                                                ...   \n","0.0  114557.289328  2.317482e+07      48811.088235  1.421606e+07  ...   \n","1.0  115991.455260  1.464611e+06      51174.501372  2.337867e+06  ...   \n","2.0  131571.104981  5.669767e+06      52713.050616  6.136154e+06  ...   \n","3.0  121160.478166  1.312263e+07      51006.341991  9.361239e+06  ...   \n","4.0   87624.759690  2.601309e+07      42544.591549  1.530200e+07  ...   \n","\n","       (구매금액, 중가)  (영수증번호, 고가)  (영수증번호, 저가)  (영수증번호, 중가)      구매일자  \\\n","유형                                                                   \n","0.0  1.162696e+07   169.769307   503.445545   412.500000  5.247525   \n","1.0  4.094117e+06    57.148635   802.440141   352.862607  4.353119   \n","2.0  6.716698e+06   100.156505  1168.665386   487.259722  1.314450   \n","3.0  8.494093e+06   125.464062   666.160938   395.960938  6.779687   \n","4.0  1.130076e+07   150.611673   403.785992   335.870817  3.538521   \n","\n","          영수증번호     (구매금액, A)     (구매금액, B)     (구매금액, C)      (구매금액, D)  \n","유형                                                                        \n","0.0  533.045545  5.153498e+07  4.965620e+06  2.077876e+06   72475.844156  \n","1.0  390.392857  3.599653e+06  6.673003e+06  8.615043e+05  440021.627907  \n","2.0  619.664906  1.508877e+07  4.385901e+06  5.183620e+06   87401.352542  \n","3.0  537.127344  3.101500e+07  6.477414e+06  2.475120e+06  108601.737089  \n","4.0  514.793774  5.551665e+07  3.146613e+06  8.521553e+05   81592.813765  \n","\n","[5 rows x 24 columns]"],"text/html":["\n","  <div id=\"df-d2da5793-83fd-4314-b108-0339ba673b4d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>사람수</th>\n","      <th>구매금액</th>\n","      <th>연령대</th>\n","      <th>성별</th>\n","      <th>(구매금액, 기타)</th>\n","      <th>(구매금액, 식품)</th>\n","      <th>(구매금액, 음식점)</th>\n","      <th>(구매금액, 의류)</th>\n","      <th>(구매금액, 의약품/의료기기)</th>\n","      <th>(구매금액, 일상용품)</th>\n","      <th>...</th>\n","      <th>(구매금액, 중가)</th>\n","      <th>(영수증번호, 고가)</th>\n","      <th>(영수증번호, 저가)</th>\n","      <th>(영수증번호, 중가)</th>\n","      <th>구매일자</th>\n","      <th>영수증번호</th>\n","      <th>(구매금액, A)</th>\n","      <th>(구매금액, B)</th>\n","      <th>(구매금액, C)</th>\n","      <th>(구매금액, D)</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0.0</th>\n","      <td>2020</td>\n","      <td>5.766110e+07</td>\n","      <td>4.276733</td>\n","      <td>0.812871</td>\n","      <td>2.798011e+06</td>\n","      <td>1.260983e+07</td>\n","      <td>114557.289328</td>\n","      <td>2.317482e+07</td>\n","      <td>48811.088235</td>\n","      <td>1.421606e+07</td>\n","      <td>...</td>\n","      <td>1.162696e+07</td>\n","      <td>169.769307</td>\n","      <td>503.445545</td>\n","      <td>412.500000</td>\n","      <td>5.247525</td>\n","      <td>533.045545</td>\n","      <td>5.153498e+07</td>\n","      <td>4.965620e+06</td>\n","      <td>2.077876e+06</td>\n","      <td>72475.844156</td>\n","    </tr>\n","    <tr>\n","      <th>1.0</th>\n","      <td>1988</td>\n","      <td>1.066637e+07</td>\n","      <td>3.973843</td>\n","      <td>0.826459</td>\n","      <td>4.918240e+05</td>\n","      <td>5.580915e+06</td>\n","      <td>115991.455260</td>\n","      <td>1.464611e+06</td>\n","      <td>51174.501372</td>\n","      <td>2.337867e+06</td>\n","      <td>...</td>\n","      <td>4.094117e+06</td>\n","      <td>57.148635</td>\n","      <td>802.440141</td>\n","      <td>352.862607</td>\n","      <td>4.353119</td>\n","      <td>390.392857</td>\n","      <td>3.599653e+06</td>\n","      <td>6.673003e+06</td>\n","      <td>8.615043e+05</td>\n","      <td>440021.627907</td>\n","    </tr>\n","    <tr>\n","      <th>2.0</th>\n","      <td>2083</td>\n","      <td>2.362788e+07</td>\n","      <td>4.083053</td>\n","      <td>0.818051</td>\n","      <td>8.801999e+05</td>\n","      <td>9.685000e+06</td>\n","      <td>131571.104981</td>\n","      <td>5.669767e+06</td>\n","      <td>52713.050616</td>\n","      <td>6.136154e+06</td>\n","      <td>...</td>\n","      <td>6.716698e+06</td>\n","      <td>100.156505</td>\n","      <td>1168.665386</td>\n","      <td>487.259722</td>\n","      <td>1.314450</td>\n","      <td>619.664906</td>\n","      <td>1.508877e+07</td>\n","      <td>4.385901e+06</td>\n","      <td>5.183620e+06</td>\n","      <td>87401.352542</td>\n","    </tr>\n","    <tr>\n","      <th>3.0</th>\n","      <td>1280</td>\n","      <td>3.876550e+07</td>\n","      <td>4.003125</td>\n","      <td>0.825781</td>\n","      <td>1.429914e+06</td>\n","      <td>1.160828e+07</td>\n","      <td>121160.478166</td>\n","      <td>1.312263e+07</td>\n","      <td>51006.341991</td>\n","      <td>9.361239e+06</td>\n","      <td>...</td>\n","      <td>8.494093e+06</td>\n","      <td>125.464062</td>\n","      <td>666.160938</td>\n","      <td>395.960938</td>\n","      <td>6.779687</td>\n","      <td>537.127344</td>\n","      <td>3.101500e+07</td>\n","      <td>6.477414e+06</td>\n","      <td>2.475120e+06</td>\n","      <td>108601.737089</td>\n","    </tr>\n","    <tr>\n","      <th>4.0</th>\n","      <td>1285</td>\n","      <td>5.892723e+07</td>\n","      <td>4.199222</td>\n","      <td>0.840467</td>\n","      <td>2.873742e+06</td>\n","      <td>9.229302e+06</td>\n","      <td>87624.759690</td>\n","      <td>2.601309e+07</td>\n","      <td>42544.591549</td>\n","      <td>1.530200e+07</td>\n","      <td>...</td>\n","      <td>1.130076e+07</td>\n","      <td>150.611673</td>\n","      <td>403.785992</td>\n","      <td>335.870817</td>\n","      <td>3.538521</td>\n","      <td>514.793774</td>\n","      <td>5.551665e+07</td>\n","      <td>3.146613e+06</td>\n","      <td>8.521553e+05</td>\n","      <td>81592.813765</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 24 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d2da5793-83fd-4314-b108-0339ba673b4d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d2da5793-83fd-4314-b108-0339ba673b4d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d2da5793-83fd-4314-b108-0339ba673b4d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":93}]},{"cell_type":"code","source":["total4.to_excel('/content/drive/MyDrive/KDT/2차프로젝트/new.xlsx')"],"metadata":{"id":"HTbww-Pl4mkV"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["![image.png](data:image/png;base64,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)"],"metadata":{"id":"YQDzoQDsrDDW"}},{"cell_type":"markdown","source":["## 3) 군집 세부 내용"],"metadata":{"id":"7YQ0uFmrKIiL"}},{"cell_type":"code","source":["# 군집 4의 상위 20 구매목록\n","clust_new[clust_new['유형']==4].sort_values(by='구매금액', ascending=False)[['고객번호','중분류명','대분류','구매시간','구매금액']][:20]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":677},"id":"gbOn5VzO8l9E","executionInfo":{"status":"ok","timestamp":1673429186606,"user_tz":-540,"elapsed":1357,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"9bf75e97-62b8-4ff6-a460-32657f24f00f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           고객번호 중분류명 대분류  구매시간       구매금액\n","8355711   14323   명품  의류    14  101330000\n","8355704   14323   명품  의류    14  101110000\n","8355722   14323   명품  의류    16   99960000\n","8355703   14323   명품  의류    15   72915000\n","2701969    4525   명품  의류    12   51352000\n","2701968    4525   명품  의류    12   50000000\n","8355706   14323   명품  의류    14   48540000\n","10015789  17348   명품  의류    15   47500000\n","9290872   15999  캐주얼  의류    16   40000500\n","9290957   15999  캐주얼  의류    15   40000000\n","9290866   15999  캐주얼  의류    14   40000000\n","9290761   15999  캐주얼  의류    13   40000000\n","18822        46   명품  의류    15   34000000\n","4831895    7988   보석  기타    13   33252000\n","9290386   15999  캐주얼  의류    13   30000600\n","9290455   15999  캐주얼  의류    13   30000600\n","9290907   15999  캐주얼  의류    19   30000000\n","9290892   15999  캐주얼  의류    14   30000000\n","547113     1011   명품  의류    17   27500000\n","9290871   15999  캐주얼  의류    17   25000200"],"text/html":["\n","  <div id=\"df-3ff8c6a4-df50-4c1b-838d-0d72a5e0228d\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>중분류명</th>\n","      <th>대분류</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>8355711</th>\n","      <td>14323</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>101330000</td>\n","    </tr>\n","    <tr>\n","      <th>8355704</th>\n","      <td>14323</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>101110000</td>\n","    </tr>\n","    <tr>\n","      <th>8355722</th>\n","      <td>14323</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>16</td>\n","      <td>99960000</td>\n","    </tr>\n","    <tr>\n","      <th>8355703</th>\n","      <td>14323</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>72915000</td>\n","    </tr>\n","    <tr>\n","      <th>2701969</th>\n","      <td>4525</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>12</td>\n","      <td>51352000</td>\n","    </tr>\n","    <tr>\n","      <th>2701968</th>\n","      <td>4525</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>12</td>\n","      <td>50000000</td>\n","    </tr>\n","    <tr>\n","      <th>8355706</th>\n","      <td>14323</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>48540000</td>\n","    </tr>\n","    <tr>\n","      <th>10015789</th>\n","      <td>17348</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>47500000</td>\n","    </tr>\n","    <tr>\n","      <th>9290872</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>16</td>\n","      <td>40000500</td>\n","    </tr>\n","    <tr>\n","      <th>9290957</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>40000000</td>\n","    </tr>\n","    <tr>\n","      <th>9290866</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>40000000</td>\n","    </tr>\n","    <tr>\n","      <th>9290761</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>13</td>\n","      <td>40000000</td>\n","    </tr>\n","    <tr>\n","      <th>18822</th>\n","      <td>46</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>34000000</td>\n","    </tr>\n","    <tr>\n","      <th>4831895</th>\n","      <td>7988</td>\n","      <td>보석</td>\n","      <td>기타</td>\n","      <td>13</td>\n","      <td>33252000</td>\n","    </tr>\n","    <tr>\n","      <th>9290386</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>13</td>\n","      <td>30000600</td>\n","    </tr>\n","    <tr>\n","      <th>9290455</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>13</td>\n","      <td>30000600</td>\n","    </tr>\n","    <tr>\n","      <th>9290907</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>19</td>\n","      <td>30000000</td>\n","    </tr>\n","    <tr>\n","      <th>9290892</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>30000000</td>\n","    </tr>\n","    <tr>\n","      <th>547113</th>\n","      <td>1011</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>17</td>\n","      <td>27500000</td>\n","    </tr>\n","    <tr>\n","      <th>9290871</th>\n","      <td>15999</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>17</td>\n","      <td>25000200</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3ff8c6a4-df50-4c1b-838d-0d72a5e0228d')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3ff8c6a4-df50-4c1b-838d-0d72a5e0228d button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3ff8c6a4-df50-4c1b-838d-0d72a5e0228d');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":99}]},{"cell_type":"code","source":["# 군집 0의 상위 20 구매목록\n","clust_new[clust_new['유형']==0].sort_values(by='구매금액', ascending=False)[['고객번호','중분류명','대분류','구매시간','구매금액']][:20]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":677},"id":"yy6Ox8aIJKQ2","executionInfo":{"status":"ok","timestamp":1673429416328,"user_tz":-540,"elapsed":2569,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"cf244d70-38d1-4e4e-831c-e770161e2830"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["           고객번호    중분류명   대분류  구매시간      구매금액\n","734610     1334      명품    의류    14  61640000\n","3894848    6454  준보석/시계    취미    20  55000000\n","1168937    2064      명품    의류    16  52000000\n","2299544    3890      주류    식품    16  51098000\n","1125355    2002      명품    의류    16  50210000\n","10880705  19180      명품    의류    14  50000000\n","10880713  19180      명품    의류    14  50000000\n","461446      863      명품    의류    11  47500000\n","5382048    8994   모피/피혁    의류    18  46796400\n","461437      863      명품    의류    14  46000000\n","5381851    8994     캐주얼    의류    15  41529630\n","7579674   12932      명품    의류    15  40850000\n","7579673   12932      명품    의류    15  40850000\n","1548047    2716      명품    의류    11  40000000\n","5382158    8994    디자이너    의류    19  38442200\n","461439      863      명품    의류    12  37000000\n","5382139    8994    시티웨어    주거    19  36151700\n","4788264    7926   전자/전기  일상용품    21  34500000\n","4744867    7842     수산품    식품    14  34116000\n","5382049    8994    디자이너    의류    18  33625990"],"text/html":["\n","  <div id=\"df-b79142f5-51d6-41c1-a86c-88a2d09024d9\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>고객번호</th>\n","      <th>중분류명</th>\n","      <th>대분류</th>\n","      <th>구매시간</th>\n","      <th>구매금액</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>734610</th>\n","      <td>1334</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>61640000</td>\n","    </tr>\n","    <tr>\n","      <th>3894848</th>\n","      <td>6454</td>\n","      <td>준보석/시계</td>\n","      <td>취미</td>\n","      <td>20</td>\n","      <td>55000000</td>\n","    </tr>\n","    <tr>\n","      <th>1168937</th>\n","      <td>2064</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>16</td>\n","      <td>52000000</td>\n","    </tr>\n","    <tr>\n","      <th>2299544</th>\n","      <td>3890</td>\n","      <td>주류</td>\n","      <td>식품</td>\n","      <td>16</td>\n","      <td>51098000</td>\n","    </tr>\n","    <tr>\n","      <th>1125355</th>\n","      <td>2002</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>16</td>\n","      <td>50210000</td>\n","    </tr>\n","    <tr>\n","      <th>10880705</th>\n","      <td>19180</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>50000000</td>\n","    </tr>\n","    <tr>\n","      <th>10880713</th>\n","      <td>19180</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>50000000</td>\n","    </tr>\n","    <tr>\n","      <th>461446</th>\n","      <td>863</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>11</td>\n","      <td>47500000</td>\n","    </tr>\n","    <tr>\n","      <th>5382048</th>\n","      <td>8994</td>\n","      <td>모피/피혁</td>\n","      <td>의류</td>\n","      <td>18</td>\n","      <td>46796400</td>\n","    </tr>\n","    <tr>\n","      <th>461437</th>\n","      <td>863</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>14</td>\n","      <td>46000000</td>\n","    </tr>\n","    <tr>\n","      <th>5381851</th>\n","      <td>8994</td>\n","      <td>캐주얼</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>41529630</td>\n","    </tr>\n","    <tr>\n","      <th>7579674</th>\n","      <td>12932</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>40850000</td>\n","    </tr>\n","    <tr>\n","      <th>7579673</th>\n","      <td>12932</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>15</td>\n","      <td>40850000</td>\n","    </tr>\n","    <tr>\n","      <th>1548047</th>\n","      <td>2716</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>11</td>\n","      <td>40000000</td>\n","    </tr>\n","    <tr>\n","      <th>5382158</th>\n","      <td>8994</td>\n","      <td>디자이너</td>\n","      <td>의류</td>\n","      <td>19</td>\n","      <td>38442200</td>\n","    </tr>\n","    <tr>\n","      <th>461439</th>\n","      <td>863</td>\n","      <td>명품</td>\n","      <td>의류</td>\n","      <td>12</td>\n","      <td>37000000</td>\n","    </tr>\n","    <tr>\n","      <th>5382139</th>\n","      <td>8994</td>\n","      <td>시티웨어</td>\n","      <td>주거</td>\n","      <td>19</td>\n","      <td>36151700</td>\n","    </tr>\n","    <tr>\n","      <th>4788264</th>\n","      <td>7926</td>\n","      <td>전자/전기</td>\n","      <td>일상용품</td>\n","      <td>21</td>\n","      <td>34500000</td>\n","    </tr>\n","    <tr>\n","      <th>4744867</th>\n","      <td>7842</td>\n","      <td>수산품</td>\n","      <td>식품</td>\n","      <td>14</td>\n","      <td>34116000</td>\n","    </tr>\n","    <tr>\n","      <th>5382049</th>\n","      <td>8994</td>\n","      <td>디자이너</td>\n","      <td>의류</td>\n","      <td>18</td>\n","      <td>33625990</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b79142f5-51d6-41c1-a86c-88a2d09024d9')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b79142f5-51d6-41c1-a86c-88a2d09024d9 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b79142f5-51d6-41c1-a86c-88a2d09024d9');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":102}]},{"cell_type":"code","source":["# 군집별, 분기별 방문횟수\n","q_count = clust_new.groupby(['고객번호','유형','분기'])[['영수증번호']].nunique()\n","q_count = q_count.groupby(['유형','분기'])[['영수증번호']].sum().unstack(level=1)\n","q_count"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"id":"zb1WYBNZURQU","executionInfo":{"status":"ok","timestamp":1673432840421,"user_tz":-540,"elapsed":3135,"user":{"displayName":"lily","userId":"08025258415486728638"}},"outputId":"14401ba3-e7ad-4254-8d19-9a24b311244e"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["     영수증번호                                                \n","분기       1       2       3       4       5       6       7\n","유형                                                        \n","0   151480  165928  154111  161031  146478  159091  138633\n","1   115840  117236  115507  113710  105867  107974   99967\n","2   185304  192813  188118  185459  175907  184563  178598\n","3   115984  119013  108363  106360   91358   83674   62771\n","4    84096   97824   91787   97249   89979  103253   97322"],"text/html":["\n","  <div id=\"df-3eb7cc42-faed-417b-b374-662fe77ba501\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead tr th {\n","        text-align: left;\n","    }\n","\n","    .dataframe thead tr:last-of-type th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr>\n","      <th></th>\n","      <th colspan=\"7\" halign=\"left\">영수증번호</th>\n","    </tr>\n","    <tr>\n","      <th>분기</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","    </tr>\n","    <tr>\n","      <th>유형</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>151480</td>\n","      <td>165928</td>\n","      <td>154111</td>\n","      <td>161031</td>\n","      <td>146478</td>\n","      <td>159091</td>\n","      <td>138633</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>115840</td>\n","      <td>117236</td>\n","      <td>115507</td>\n","      <td>113710</td>\n","      <td>105867</td>\n","      <td>107974</td>\n","      <td>99967</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>185304</td>\n","      <td>192813</td>\n","      <td>188118</td>\n","      <td>185459</td>\n","      <td>175907</td>\n","      <td>184563</td>\n","      <td>178598</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>115984</td>\n","      <td>119013</td>\n","      <td>108363</td>\n","      <td>106360</td>\n","      <td>91358</td>\n","      <td>83674</td>\n","      <td>62771</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>84096</td>\n","      <td>97824</td>\n","      <td>91787</td>\n","      <td>97249</td>\n","      <td>89979</td>\n","      <td>103253</td>\n","      <td>97322</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3eb7cc42-faed-417b-b374-662fe77ba501')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3eb7cc42-faed-417b-b374-662fe77ba501 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3eb7cc42-faed-417b-b374-662fe77ba501');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":122}]},{"cell_type":"code","source":[],"metadata":{"id":"WX_-iZVDXs6y"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"machine_shape":"hm","provenance":[{"file_id":"1ShTmLEpQ9UXNYzwlqOoMk0sJjqema_7A","timestamp":1672204271187}],"toc_visible":true},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}